
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Google Analytics Customer Revenue Prediction}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{} LOADING MODULES}
        
        \PY{k+kn}{import} \PY{n+nn}{os}
        \PY{k+kn}{import} \PY{n+nn}{json}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{from} \PY{n+nn}{pandas}\PY{n+nn}{.}\PY{n+nn}{io}\PY{n+nn}{.}\PY{n+nn}{json} \PY{k}{import} \PY{n}{json\PYZus{}normalize}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{n}{color} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{color\PYZus{}palette}\PY{p}{(}\PY{p}{)}
        
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        
        \PY{k+kn}{from} \PY{n+nn}{plotly} \PY{k}{import} \PY{n}{tools}
        \PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{offline} \PY{k}{as} \PY{n+nn}{py}
        \PY{n}{py}\PY{o}{.}\PY{n}{init\PYZus{}notebook\PYZus{}mode}\PY{p}{(}\PY{n}{connected}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{graph\PYZus{}objs} \PY{k}{as} \PY{n+nn}{go}
        
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{model\PYZus{}selection}\PY{p}{,} \PY{n}{preprocessing}\PY{p}{,} \PY{n}{metrics}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{,} \PY{n}{r2\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{datasets}\PY{p}{,} \PY{n}{linear\PYZus{}model}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{svm}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k}{import} \PY{n}{DecisionTreeRegressor}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors} \PY{k}{import} \PY{n}{KNeighborsRegressor}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestRegressor}
        \PY{k+kn}{import} \PY{n+nn}{lightgbm} \PY{k}{as} \PY{n+nn}{lgb}
        \PY{k+kn}{import} \PY{n+nn}{xgboost} \PY{k}{as} \PY{n+nn}{xgb}
        
        \PY{c+c1}{\PYZsh{}pd.options.mode.chained\PYZus{}assignment = None}
        \PY{c+c1}{\PYZsh{}pd.options.display.max\PYZus{}columns = 999}
        
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{formula}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{smf}
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        
        \PY{k+kn}{from} \PY{n+nn}{pydoc} \PY{k}{import} \PY{n}{help}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{pearsonr}
        
        \PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{datetime}
        \PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{timedelta}
        \PY{k+kn}{import} \PY{n+nn}{datetime} \PY{k}{as} \PY{n+nn}{dt}
        \PY{k+kn}{import} \PY{n+nn}{calendar}
        
        \PY{k+kn}{import} \PY{n+nn}{math}
\end{Verbatim}


    
    
    \begin{Verbatim}[commandchars=\\\{\}]
/anaconda3/lib/python3.6/site-packages/lightgbm/\_\_init\_\_.py:46: UserWarning:

Starting from version 2.2.1, the library file in distribution wheels for macOS is built by the Apple Clang (Xcode\_9.4.1) compiler.
This means that in case of installing LightGBM from PyPI via the ``pip install lightgbm`` command, you don't need to install the gcc compiler anymore.
Instead of that, you need to install the OpenMP library, which is required for running LightGBM on the system with the Apple Clang compiler.
You can install the OpenMP library by the following command: ``brew install libomp``.


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}DELETE}
        \PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./processed\PYZus{}train.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./processed\PYZus{}test.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}DELETE}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{dtypes}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} EXTRACTING FEATURES FROM THE WEATHER DATASET}
        
        \PY{n}{external}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./external\PYZus{}data2.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{print} \PY{p}{(}\PY{n}{external}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
        \PY{n}{external}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Index}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geoNetwork\PYZus{}country}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{InternetUsers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Population}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NonUsers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{external}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} MERGING EXISTING DATA WITH WEATHER DATA TO GENERATE NEW FEATURES}
        
        \PY{n}{train\PYZus{}new} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{,} \PY{n}{external}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geoNetwork\PYZus{}country}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}new}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}new}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}new}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}new}\PY{o}{.}\PY{n}{dtypes}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}new}\PY{o}{.}\PY{n}{geoNetwork\PYZus{}country}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}print (train\PYZus{}new.geoNetwork\PYZus{}country.size)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{geoNetwork\PYZus{}country}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}74}]:} \PY{c+c1}{\PYZsh{} LOAD DATA}
         
         \PY{n}{initial\PYZus{}train} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./train.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{initial\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./test.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/anaconda3/lib/python3.6/site-packages/IPython/core/interactiveshell.py:2785: DtypeWarning:

Columns (3) have mixed types. Specify dtype option on import or set low\_memory=False.


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{print} \PY{p}{(}\PY{n}{initial\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{initial\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{initial\PYZus{}train}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{initial\PYZus{}test}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
        
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{initial\PYZus{}train}\PY{o}{.}\PY{n}{dtypes}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{} FUNCTION TO EXTRACT JSON VALUES}
        
        \PY{k}{def} \PY{n+nf}{load\PYZus{}df}\PY{p}{(}\PY{n}{filename}\PY{p}{)}\PY{p}{:}
            \PY{n}{csv\PYZus{}path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n}{filename}
            \PY{n}{JSON\PYZus{}COLUMNS} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{device}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geoNetwork}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trafficSource}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
            
            \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{csv\PYZus{}path}\PY{p}{,} 
                             \PY{n}{converters}\PY{o}{=}\PY{p}{\PYZob{}}\PY{n}{column}\PY{p}{:} \PY{n}{json}\PY{o}{.}\PY{n}{loads} \PY{k}{for} \PY{n}{column} \PY{o+ow}{in} \PY{n}{JSON\PYZus{}COLUMNS}\PY{p}{\PYZcb{}}\PY{p}{,} 
                             \PY{n}{dtype}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{str}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}
                            \PY{p}{)}
            
            \PY{k}{for} \PY{n}{column} \PY{o+ow}{in} \PY{n}{JSON\PYZus{}COLUMNS}\PY{p}{:}
                \PY{n}{column\PYZus{}as\PYZus{}df} \PY{o}{=} \PY{n}{json\PYZus{}normalize}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{column}\PY{p}{]}\PY{p}{)}
                \PY{n}{column\PYZus{}as\PYZus{}df}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}column\PYZcb{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZob{}subcolumn\PYZcb{}}\PY{l+s+s2}{\PYZdq{}} \PY{k}{for} \PY{n}{subcolumn} \PY{o+ow}{in} \PY{n}{column\PYZus{}as\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{]}
                \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{column}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{column\PYZus{}as\PYZus{}df}\PY{p}{,} \PY{n}{right\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{left\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
            \PY{k}{return} \PY{n}{df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{load\PYZus{}df}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{train.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{load\PYZus{}df}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{test.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}full\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}df}
        \PY{n}{test\PYZus{}ful\PYZus{}df} \PY{o}{=} \PY{n}{test\PYZus{}df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{TRAIN}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{dtypes}\PY{p}{)}
        
        \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{TEST}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{dtypes}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}browser}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}browserSize}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}browserVersion}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}deviceCategory}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}flashVersion}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}isMobile}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}language}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}mobileDeviceBranding}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}mobileDeviceInfo}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}mobileDeviceMarketingName}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}mobileDeviceModel}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}mobileInputSelector}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}operatingSystem}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}operatingSystemVersion}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}screenColors}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{device\PYZus{}screenResolution}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{geoNetwork\PYZus{}city}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{geoNetwork\PYZus{}cityId}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{geoNetwork\PYZus{}continent}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{geoNetwork\PYZus{}country}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{geoNetwork\PYZus{}latitude}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{geoNetwork\PYZus{}longitude}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{geoNetwork\PYZus{}metro}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{geoNetwork\PYZus{}networkDomain}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{geoNetwork\PYZus{}networkLocation}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{geoNetwork\PYZus{}region}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{geoNetwork\PYZus{}subContinent}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{totals\PYZus{}bounces}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{totals\PYZus{}hits}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{totals\PYZus{}newVisits}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{totals\PYZus{}pageviews}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{totals\PYZus{}visits}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{trafficSource\PYZus{}adContent}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{trafficSource\PYZus{}adwordsClickInfo}\PY{o}{.}\PY{n}{adNetworkType}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{trafficSource\PYZus{}adwordsClickInfo\PYZus{}criteriaParameters}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{trafficSource\PYZus{}adwordsClickInfo\PYZus{}gclId}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{trafficSource\PYZus{}adwordsClickInfo\PYZus{}isVideoAd}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{trafficSource\PYZus{}adwordsClickInfo\PYZus{}page}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{trafficSource\PYZus{}adwordsClickInfo\PYZus{}slot}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{trafficSource\PYZus{}campaign}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{trafficSource\PYZus{}isTrueDirect}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{trafficSource\PYZus{}keyword}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{trafficSource\PYZus{}medium}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{trafficSource\PYZus{}referralPath}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{trafficSource\PYZus{}source}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{c+c1}{\PYZsh{} CONVERTING TRANSACTION REVENUE TO FLOAT}
        
        \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{nzi} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{notnull}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
        \PY{n}{nzr} \PY{o}{=} \PY{p}{(}\PY{n}{gdf}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of instances in train set with non\PYZhy{}zero revenue : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{nzi}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ and ratio is : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{nzi} \PY{o}{/} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of unique customers with non\PYZhy{}zero revenue : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{nzr}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{and the ratio is : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{nzr} \PY{o}{/} \PY{n}{gdf}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of unique visitors in train set : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{fullVisitorId}\PY{o}{.}\PY{n}{nunique}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ out of rows : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of unique visitors in test set : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{fullVisitorId}\PY{o}{.}\PY{n}{nunique}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ out of rows : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of common visitors in train and test set : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{fullVisitorId}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{intersection}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{fullVisitorId}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)} \PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}VERIFY}
        \PY{n}{gdf} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{gdf}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n}{gdf}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{gdf}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TransactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}VERIFY}
        \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
        \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{non\PYZus{}zero}\PY{p}{)}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Log Distribution of Non Zero Total Transactions}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{;}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Log \PYZhy{} Total Transactions}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} DEVICE ATTRIBUTES}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{fig1} \PY{o}{=} \PY{n}{tools}\PY{o}{.}\PY{n}{make\PYZus{}subplots}\PY{p}{(}\PY{n}{rows}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cols}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{subplot\PYZus{}titles}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count: Device Category}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count: Device Category}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{print\PYZus{}grid}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         
         \PY{n}{trs1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{n}{tmp1} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{device\PYZus{}deviceCategory}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{tmp1} \PY{o}{=} \PY{n}{tmp1}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{tr1} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{y} \PY{o}{=} \PY{n}{tmp1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{o}{=} \PY{n}{tmp1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{device\PYZus{}deviceCategory}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{trs1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tr1}\PY{p}{)}
         
         \PY{n}{tmp1} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{device\PYZus{}deviceCategory}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{tmp1} \PY{o}{=} \PY{n}{tmp1}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{tr1} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{y} \PY{o}{=} \PY{n}{tmp1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{o}{=} \PY{n}{tmp1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{device\PYZus{}deviceCategory}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{trs1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tr1}\PY{p}{)}
         
         \PY{n}{fig1}\PY{o}{.}\PY{n}{append\PYZus{}trace}\PY{p}{(}\PY{n}{trs1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{fig1}\PY{o}{.}\PY{n}{append\PYZus{}trace}\PY{p}{(}\PY{n}{trs1}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{fig1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{layout}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n}{height}\PY{o}{=}\PY{l+m+mi}{450}\PY{p}{,} \PY{n}{margin}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{b}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}\PY{p}{,} \PY{n}{showlegend}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{py}\PY{o}{.}\PY{n}{iplot}\PY{p}{(}\PY{n}{fig1}\PY{p}{)}
         
         \PY{n}{fig2} \PY{o}{=} \PY{n}{tools}\PY{o}{.}\PY{n}{make\PYZus{}subplots}\PY{p}{(}\PY{n}{rows}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cols}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{subplot\PYZus{}titles}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count: Device OperatingSystem}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count: Device OperatingSystem}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{print\PYZus{}grid}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         
         \PY{n}{trs2} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{n}{tmp2} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{device\PYZus{}operatingSystem}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{tmp2} \PY{o}{=} \PY{n}{tmp2}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{tr2} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{y} \PY{o}{=} \PY{n}{tmp2}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{orange}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{o}{=} \PY{n}{tmp2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{device\PYZus{}operatingSystem}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{trs2}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tr2}\PY{p}{)}
         
         \PY{n}{tmp2} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{device\PYZus{}operatingSystem}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{tmp2} \PY{o}{=} \PY{n}{tmp2}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{tr2} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{y} \PY{o}{=} \PY{n}{tmp2}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{orange}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{o}{=} \PY{n}{tmp2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{device\PYZus{}operatingSystem}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{trs2}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tr2}\PY{p}{)}
         
         \PY{n}{fig2}\PY{o}{.}\PY{n}{append\PYZus{}trace}\PY{p}{(}\PY{n}{trs2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{fig2}\PY{o}{.}\PY{n}{append\PYZus{}trace}\PY{p}{(}\PY{n}{trs2}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{fig2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{layout}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n}{height}\PY{o}{=}\PY{l+m+mi}{450}\PY{p}{,} \PY{n}{margin}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{b}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}\PY{p}{,} \PY{n}{showlegend}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{py}\PY{o}{.}\PY{n}{iplot}\PY{p}{(}\PY{n}{fig2}\PY{p}{)}
\end{Verbatim}


    
    
    
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{c+c1}{\PYZsh{}GEOGRAPHY ATTRIBUTES}
         
         \PY{n}{fig1} \PY{o}{=} \PY{n}{tools}\PY{o}{.}\PY{n}{make\PYZus{}subplots}\PY{p}{(}\PY{n}{rows}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cols}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{subplot\PYZus{}titles}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count: Continent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count: Continent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{print\PYZus{}grid}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         
         \PY{n}{trs1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{n}{tmp1} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geoNetwork\PYZus{}continent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{tmp1} \PY{o}{=} \PY{n}{tmp1}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{tr1} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{y} \PY{o}{=} \PY{n}{tmp1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{o}{=} \PY{n}{tmp1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geoNetwork\PYZus{}continent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{trs1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tr1}\PY{p}{)}
         
         \PY{n}{tmp1} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geoNetwork\PYZus{}continent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{tmp1} \PY{o}{=} \PY{n}{tmp1}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{tr1} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{y} \PY{o}{=} \PY{n}{tmp1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{o}{=} \PY{n}{tmp1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geoNetwork\PYZus{}continent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{trs1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tr1}\PY{p}{)}
         
         \PY{n}{fig1}\PY{o}{.}\PY{n}{append\PYZus{}trace}\PY{p}{(}\PY{n}{trs1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{fig1}\PY{o}{.}\PY{n}{append\PYZus{}trace}\PY{p}{(}\PY{n}{trs1}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{fig1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{layout}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n}{height}\PY{o}{=}\PY{l+m+mi}{450}\PY{p}{,} \PY{n}{margin}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{b}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}\PY{p}{,} \PY{n}{showlegend}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{py}\PY{o}{.}\PY{n}{iplot}\PY{p}{(}\PY{n}{fig1}\PY{p}{)}
         
         \PY{n}{fig2} \PY{o}{=} \PY{n}{tools}\PY{o}{.}\PY{n}{make\PYZus{}subplots}\PY{p}{(}\PY{n}{rows}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cols}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{subplot\PYZus{}titles}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count: SubContinent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count: SubContinent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{print\PYZus{}grid}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         
         \PY{n}{trs2} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{n}{tmp2} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geoNetwork\PYZus{}subContinent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{tmp2} \PY{o}{=} \PY{n}{tmp2}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{tr2} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{y} \PY{o}{=} \PY{n}{tmp2}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{orange}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{o}{=} \PY{n}{tmp2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geoNetwork\PYZus{}subContinent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{trs2}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tr2}\PY{p}{)}
         
         \PY{n}{tmp2} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geoNetwork\PYZus{}subContinent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{tmp2} \PY{o}{=} \PY{n}{tmp2}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{tr2} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{y} \PY{o}{=} \PY{n}{tmp2}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{orange}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{o}{=} \PY{n}{tmp2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geoNetwork\PYZus{}subContinent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{trs2}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tr2}\PY{p}{)}
         
         \PY{n}{fig2}\PY{o}{.}\PY{n}{append\PYZus{}trace}\PY{p}{(}\PY{n}{trs2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{fig2}\PY{o}{.}\PY{n}{append\PYZus{}trace}\PY{p}{(}\PY{n}{trs2}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{fig2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{layout}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n}{height}\PY{o}{=}\PY{l+m+mi}{450}\PY{p}{,} \PY{n}{margin}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{b}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}\PY{p}{,} \PY{n}{showlegend}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{py}\PY{o}{.}\PY{n}{iplot}\PY{p}{(}\PY{n}{fig2}\PY{p}{)}
\end{Verbatim}


    
    
    
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{k}{def} \PY{n+nf}{date\PYZus{}parser}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{:}
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)}\PY{p}{)}
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{unit} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{k}{return} \PY{n}{df}
         
         \PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{date\PYZus{}parser}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{)}
         \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{date\PYZus{}parser}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{)}
         
         \PY{k}{def} \PY{n+nf}{add\PYZus{}time\PYZus{}features}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{:}
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dayofweek}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{dayofweek}
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{hour}
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{month}
             \PY{n}{df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dayofweek}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dayofweek}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x} \PY{p}{:} \PY{n}{x}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{p}{)}
             \PY{k}{return} \PY{n}{df}
         
         \PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{add\PYZus{}time\PYZus{}features}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{)}
         \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{add\PYZus{}time\PYZus{}features}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{c+c1}{\PYZsh{}DATE ATTRIBUTES}
         
         \PY{n}{fig1} \PY{o}{=} \PY{n}{tools}\PY{o}{.}\PY{n}{make\PYZus{}subplots}\PY{p}{(}\PY{n}{rows}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cols}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{subplot\PYZus{}titles}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count: Hour}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count: Hour}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{print\PYZus{}grid}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         
         \PY{n}{trs1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{n}{tmp1} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{tmp1} \PY{o}{=} \PY{n}{tmp1}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{tr1} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{y} \PY{o}{=} \PY{n}{tmp1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{o}{=} \PY{n}{tmp1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{trs1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tr1}\PY{p}{)}
         
         \PY{n}{tmp1} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{tmp1} \PY{o}{=} \PY{n}{tmp1}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{tr1} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{y} \PY{o}{=} \PY{n}{tmp1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{o}{=} \PY{n}{tmp1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{trs1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tr1}\PY{p}{)}
         
         \PY{n}{fig1}\PY{o}{.}\PY{n}{append\PYZus{}trace}\PY{p}{(}\PY{n}{trs1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{fig1}\PY{o}{.}\PY{n}{append\PYZus{}trace}\PY{p}{(}\PY{n}{trs1}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{fig1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{layout}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n}{height}\PY{o}{=}\PY{l+m+mi}{450}\PY{p}{,} \PY{n}{margin}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{b}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}\PY{p}{,} \PY{n}{showlegend}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{py}\PY{o}{.}\PY{n}{iplot}\PY{p}{(}\PY{n}{fig1}\PY{p}{)}
         
         \PY{n}{fig2} \PY{o}{=} \PY{n}{tools}\PY{o}{.}\PY{n}{make\PYZus{}subplots}\PY{p}{(}\PY{n}{rows}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cols}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{subplot\PYZus{}titles}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count: Day of Week}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count: Day of Week}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{print\PYZus{}grid}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         
         \PY{n}{trs2} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{n}{tmp2} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dayofweek}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{tmp2} \PY{o}{=} \PY{n}{tmp2}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{tr2} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{y} \PY{o}{=} \PY{n}{tmp2}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{orange}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{o}{=} \PY{n}{tmp2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dayofweek}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{trs2}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tr2}\PY{p}{)}
         
         \PY{n}{tmp2} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dayofweek}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{tmp2} \PY{o}{=} \PY{n}{tmp2}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{tr2} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{y} \PY{o}{=} \PY{n}{tmp2}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{orange}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{o}{=} \PY{n}{tmp2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dayofweek}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{trs2}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tr2}\PY{p}{)}
         
         \PY{n}{fig2}\PY{o}{.}\PY{n}{append\PYZus{}trace}\PY{p}{(}\PY{n}{trs2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{fig2}\PY{o}{.}\PY{n}{append\PYZus{}trace}\PY{p}{(}\PY{n}{trs2}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{fig2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{layout}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n}{height}\PY{o}{=}\PY{l+m+mi}{450}\PY{p}{,} \PY{n}{margin}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{b}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}\PY{p}{,} \PY{n}{showlegend}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{py}\PY{o}{.}\PY{n}{iplot}\PY{p}{(}\PY{n}{fig2}\PY{p}{)}
         
         \PY{n}{fig3} \PY{o}{=} \PY{n}{tools}\PY{o}{.}\PY{n}{make\PYZus{}subplots}\PY{p}{(}\PY{n}{rows}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cols}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{subplot\PYZus{}titles}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count: Month}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count: Month}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{print\PYZus{}grid}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         
         \PY{n}{trs3} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{n}{tmp3} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{size}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{tmp3} \PY{o}{=} \PY{n}{tmp3}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{tr3} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{y} \PY{o}{=} \PY{n}{tmp3}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cyan}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{o}{=} \PY{n}{tmp3}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{trs3}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tr3}\PY{p}{)}
         
         \PY{n}{tmp3} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{tmp3} \PY{o}{=} \PY{n}{tmp3}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{tr3} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Bar}\PY{p}{(}\PY{n}{y} \PY{o}{=} \PY{n}{tmp3}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Non\PYZhy{}zero Revenue Count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{v}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{opacity}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cyan}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{o}{=} \PY{n}{tmp3}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{trs3}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tr3}\PY{p}{)}
         
         \PY{n}{fig3}\PY{o}{.}\PY{n}{append\PYZus{}trace}\PY{p}{(}\PY{n}{trs3}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{fig3}\PY{o}{.}\PY{n}{append\PYZus{}trace}\PY{p}{(}\PY{n}{trs3}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{fig3}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{layout}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n}{height}\PY{o}{=}\PY{l+m+mi}{450}\PY{p}{,} \PY{n}{margin}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{b}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}\PY{p}{,} \PY{n}{showlegend}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{py}\PY{o}{.}\PY{n}{iplot}\PY{p}{(}\PY{n}{fig3}\PY{p}{)}
\end{Verbatim}


    
    
    
    
    
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{n}{tmp} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{channelGrouping}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
         \PY{n}{colors} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}8d44fc}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}ed95d5}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}caadf7}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}6161b7}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}7e7eba}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}babad1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{trace} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Pie}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{n}{tmp}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{values}\PY{o}{=}\PY{n}{tmp}\PY{o}{.}\PY{n}{values}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{colors}\PY{o}{=}\PY{n}{colors}\PY{p}{)}\PY{p}{)}
         \PY{n}{layout} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Layout}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Channel Grouping}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{height}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}
         \PY{n}{fig} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Figure}\PY{p}{(}\PY{n}{data} \PY{o}{=} \PY{p}{[}\PY{n}{trace}\PY{p}{]}\PY{p}{,} \PY{n}{layout} \PY{o}{=} \PY{n}{layout}\PY{p}{)}
         \PY{n}{py}\PY{o}{.}\PY{n}{iplot}\PY{p}{(}\PY{n}{fig}\PY{p}{,} \PY{n}{filename}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{basic\PYZus{}pie\PYZus{}chart}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c+c1}{\PYZsh{} Probability}
         
         \PY{n}{cnt\PYZus{}srs1} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{cnt\PYZus{}srs1}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count of non\PYZhy{}zero revenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mean}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{cnt\PYZus{}srs1} \PY{o}{=} \PY{n}{cnt\PYZus{}srs1}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n+nb}{print} \PY{p}{(}\PY{n}{cnt\PYZus{}srs1}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{cnt\PYZus{}srs1}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{cnt\PYZus{}srs1}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(714167, 3)
count                            1.0
count of non-zero revenue        0.0
mean                         10000.0
dtype: float64
count                        2.780000e+02
count of non-zero revenue    3.300000e+01
mean                         1.602375e+10
dtype: float64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{prob1} \PY{o}{=} \PY{n}{cnt\PYZus{}srs1}
         \PY{n}{prob1}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}26}]:} (714167, 3)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{prob1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{probability}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{cnt\PYZus{}srs1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count of non\PYZhy{}zero revenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{cnt\PYZus{}srs1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}prob[\PYZdq{}count\PYZdq{}] = cnt\PYZus{}srs[\PYZsq{}count\PYZsq{}]}
         \PY{c+c1}{\PYZsh{}prob[\PYZdq{}count of non\PYZhy{}zero revenue\PYZdq{}] = cnt\PYZus{}srs[\PYZsq{}count of non\PYZhy{}zero revenue\PYZsq{}]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n+nb}{print} \PY{p}{(}\PY{n}{prob1}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{prob1}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{prob1}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(714167, 4)
Index(['count', 'count of non-zero revenue', 'mean', 'probability'], dtype='object')
                     count  count of non-zero revenue          mean  \textbackslash{}
fullVisitorId                                                         
1957458976293878100    278                         16  4.819589e+09   
0824839726118485274    255                          0           NaN   
3608475193341679870    201                          1  2.348000e+07   
1856749147915772585    199                          0           NaN   
3269834865385146569    155                          1  1.799000e+08   
0720311197761340948    153                          0           NaN   
7634897085866546110    148                          1  2.500000e+07   
4038076683036146727    138                          0           NaN   
0232377434237234751    135                          1  1.798000e+07   
3694234028523165868    129                          1  1.519000e+07   

                     probability  
fullVisitorId                     
1957458976293878100     0.057554  
0824839726118485274     0.000000  
3608475193341679870     0.004975  
1856749147915772585     0.000000  
3269834865385146569     0.006452  
0720311197761340948     0.000000  
7634897085866546110     0.006757  
4038076683036146727     0.000000  
0232377434237234751     0.007407  
3694234028523165868     0.007752  

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{prob1} \PY{o}{=} \PY{n}{prob1}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{probability}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{n}{prob\PYZus{}high} \PY{o}{=} \PY{n}{prob1}\PY{p}{[}\PY{n}{prob1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{6}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}73}]:} \PY{n+nb}{print} \PY{p}{(}\PY{n}{prob\PYZus{}high}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{prob\PYZus{}high}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{prob\PYZus{}high}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(4524, 4)
Index(['count', 'count of non-zero revenue', 'mean', 'probability'], dtype='object')
                     count  count of non-zero revenue          mean  \textbackslash{}
fullVisitorId                                                         
0608915197735218105     17                         13  2.335615e+08   
803888563485194008       7                          5  4.990000e+07   
3818637526754889697      7                          5  1.044740e+08   
4984366501121503466     24                         16  5.946188e+08   
3857043812510146001      9                          6  8.878500e+07   
2411322974724385937     11                          7  2.970000e+07   
0777922178356486144     10                          6  5.311667e+07   
8657427332734176422     10                          6  1.259100e+08   
5263059809967138936      7                          4  1.460800e+08   
3033366073043100694      7                          4  1.655350e+08   

                     probability  
fullVisitorId                     
0608915197735218105     0.764706  
803888563485194008      0.714286  
3818637526754889697     0.714286  
4984366501121503466     0.666667  
3857043812510146001     0.666667  
2411322974724385937     0.636364  
0777922178356486144     0.600000  
8657427332734176422     0.600000  
5263059809967138936     0.571429  
3033366073043100694     0.571429  

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n+nb}{print} \PY{p}{(}\PY{n}{prob1}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{prob1}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{prob1}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(714167, 4)
Index(['count', 'count of non-zero revenue', 'mean', 'probability'], dtype='object')
                     count  count of non-zero revenue         mean  \textbackslash{}
fullVisitorId                                                        
0037806222406366969      1                          1   16990000.0   
9507736163898888702      1                          1   40770000.0   
647109355709882719       1                          1   12990000.0   
3193356620853190867      1                          1   12990000.0   
6298030765010140996      1                          1   27980000.0   
0415608676546432559      1                          1  118980000.0   
1706545499690432606      1                          1   44480000.0   
7647399051164881931      1                          1   86380000.0   
582674888457699636       2                          2   56185000.0   
6997840417339284915      1                          1   24990000.0   

                     probability  
fullVisitorId                     
0037806222406366969          1.0  
9507736163898888702          1.0  
647109355709882719           1.0  
3193356620853190867          1.0  
6298030765010140996          1.0  
0415608676546432559          1.0  
1706545499690432606          1.0  
7647399051164881931          1.0  
582674888457699636           1.0  
6997840417339284915          1.0  

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{actual\PYZus{}prob} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{print} \PY{p}{(}\PY{n}{actual\PYZus{}prob}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{actual\PYZus{}prob}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{actual\PYZus{}prob}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{pref\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{\PYZcb{}}\PY{p}{)}
        \PY{n}{pred\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
        \PY{n}{pred\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{actual\PYZus{}prob}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{print} \PY{p}{(}\PY{n}{pref\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{pref\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{pref\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}prob}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{probability}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{cnt\PYZus{}srs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count of non\PYZhy{}zero revenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{cnt\PYZus{}srs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{train\PYZus{}prob}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{cnt\PYZus{}srs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{train\PYZus{}prob}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count of non\PYZhy{}zero revenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{cnt\PYZus{}srs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count of non\PYZhy{}zero revenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}prob}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}prob}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{probability}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count of non\PYZhy{}zero revenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mean}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Variables not in test but in train : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{set}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{o}{.}\PY{n}{difference}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Variables not in test but in train :  \{'trafficSource\_campaignCode', 'totals\_transactionRevenue'\}

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{const\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{n}{c} \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{columns} \PY{k}{if} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{nunique}\PY{p}{(}\PY{n}{dropna}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{1} \PY{p}{]}
         \PY{n}{const\PYZus{}cols}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}35}]:} ['socialEngagementType',
          'device\_browserSize',
          'device\_browserVersion',
          'device\_flashVersion',
          'device\_language',
          'device\_mobileDeviceBranding',
          'device\_mobileDeviceInfo',
          'device\_mobileDeviceMarketingName',
          'device\_mobileDeviceModel',
          'device\_mobileInputSelector',
          'device\_operatingSystemVersion',
          'device\_screenColors',
          'device\_screenResolution',
          'geoNetwork\_cityId',
          'geoNetwork\_latitude',
          'geoNetwork\_longitude',
          'geoNetwork\_networkLocation',
          'totals\_visits',
          'trafficSource\_adwordsClickInfo.criteriaParameters']
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{cols\PYZus{}to\PYZus{}drop} \PY{o}{=} \PY{n}{const\PYZus{}cols} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sessionId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{cols\PYZus{}to\PYZus{}drop} \PY{o}{+} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}campaignCode}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{cols\PYZus{}to\PYZus{}drop}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{TRAIN}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{dtypes}\PY{p}{)}
         
         \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{TEST}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{dtypes}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
TRAIN
(903653, 37)
Index(['channelGrouping', 'date', 'fullVisitorId', 'visitId', 'visitNumber',
       'visitStartTime', 'device\_browser', 'device\_deviceCategory',
       'device\_isMobile', 'device\_operatingSystem', 'geoNetwork\_city',
       'geoNetwork\_continent', 'geoNetwork\_country', 'geoNetwork\_metro',
       'geoNetwork\_networkDomain', 'geoNetwork\_region',
       'geoNetwork\_subContinent', 'totals\_bounces', 'totals\_hits',
       'totals\_newVisits', 'totals\_pageviews', 'totals\_transactionRevenue',
       'trafficSource\_adContent',
       'trafficSource\_adwordsClickInfo.adNetworkType',
       'trafficSource\_adwordsClickInfo.gclId',
       'trafficSource\_adwordsClickInfo.isVideoAd',
       'trafficSource\_adwordsClickInfo.page',
       'trafficSource\_adwordsClickInfo.slot', 'trafficSource\_campaign',
       'trafficSource\_isTrueDirect', 'trafficSource\_keyword',
       'trafficSource\_medium', 'trafficSource\_referralPath',
       'trafficSource\_source', 'dayofweek', 'hour', 'month'],
      dtype='object')
channelGrouping                                         object
date                                            datetime64[ns]
fullVisitorId                                           object
visitId                                                  int64
visitNumber                                              int64
visitStartTime                                  datetime64[ns]
device\_browser                                          object
device\_deviceCategory                                   object
device\_isMobile                                           bool
device\_operatingSystem                                  object
geoNetwork\_city                                         object
geoNetwork\_continent                                    object
geoNetwork\_country                                      object
geoNetwork\_metro                                        object
geoNetwork\_networkDomain                                object
geoNetwork\_region                                       object
geoNetwork\_subContinent                                 object
totals\_bounces                                          object
totals\_hits                                             object
totals\_newVisits                                        object
totals\_pageviews                                        object
totals\_transactionRevenue                              float64
trafficSource\_adContent                                 object
trafficSource\_adwordsClickInfo.adNetworkType            object
trafficSource\_adwordsClickInfo.gclId                    object
trafficSource\_adwordsClickInfo.isVideoAd                object
trafficSource\_adwordsClickInfo.page                     object
trafficSource\_adwordsClickInfo.slot                     object
trafficSource\_campaign                                  object
trafficSource\_isTrueDirect                              object
trafficSource\_keyword                                   object
trafficSource\_medium                                    object
trafficSource\_referralPath                              object
trafficSource\_source                                    object
dayofweek                                              float64
hour                                                   float64
month                                                  float64
dtype: object
TEST
(804684, 36)
Index(['channelGrouping', 'date', 'fullVisitorId', 'visitId', 'visitNumber',
       'visitStartTime', 'device\_browser', 'device\_deviceCategory',
       'device\_isMobile', 'device\_operatingSystem', 'geoNetwork\_city',
       'geoNetwork\_continent', 'geoNetwork\_country', 'geoNetwork\_metro',
       'geoNetwork\_networkDomain', 'geoNetwork\_region',
       'geoNetwork\_subContinent', 'totals\_bounces', 'totals\_hits',
       'totals\_newVisits', 'totals\_pageviews', 'trafficSource\_adContent',
       'trafficSource\_adwordsClickInfo.adNetworkType',
       'trafficSource\_adwordsClickInfo.gclId',
       'trafficSource\_adwordsClickInfo.isVideoAd',
       'trafficSource\_adwordsClickInfo.page',
       'trafficSource\_adwordsClickInfo.slot', 'trafficSource\_campaign',
       'trafficSource\_isTrueDirect', 'trafficSource\_keyword',
       'trafficSource\_medium', 'trafficSource\_referralPath',
       'trafficSource\_source', 'dayofweek', 'hour', 'month'],
      dtype='object')
channelGrouping                                         object
date                                            datetime64[ns]
fullVisitorId                                           object
visitId                                                  int64
visitNumber                                              int64
visitStartTime                                  datetime64[ns]
device\_browser                                          object
device\_deviceCategory                                   object
device\_isMobile                                           bool
device\_operatingSystem                                  object
geoNetwork\_city                                         object
geoNetwork\_continent                                    object
geoNetwork\_country                                      object
geoNetwork\_metro                                        object
geoNetwork\_networkDomain                                object
geoNetwork\_region                                       object
geoNetwork\_subContinent                                 object
totals\_bounces                                          object
totals\_hits                                             object
totals\_newVisits                                        object
totals\_pageviews                                        object
trafficSource\_adContent                                 object
trafficSource\_adwordsClickInfo.adNetworkType            object
trafficSource\_adwordsClickInfo.gclId                    object
trafficSource\_adwordsClickInfo.isVideoAd                object
trafficSource\_adwordsClickInfo.page                     object
trafficSource\_adwordsClickInfo.slot                     object
trafficSource\_campaign                                  object
trafficSource\_isTrueDirect                              object
trafficSource\_keyword                                   object
trafficSource\_medium                                    object
trafficSource\_referralPath                              object
trafficSource\_source                                    object
dayofweek                                              float64
hour                                                   float64
month                                                  float64
dtype: object

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{c+c1}{\PYZsh{}MAPPING STRING VALUES TO INTEGERS}
         \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{model\PYZus{}selection}\PY{p}{,} \PY{n}{preprocessing}\PY{p}{,} \PY{n}{metrics}
         
         \PY{c+c1}{\PYZsh{} Impute 0 for missing target values}
         \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{train\PYZus{}y} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
         \PY{n}{train\PYZus{}id} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
         \PY{n}{test\PYZus{}id} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
         
         
         \PY{c+c1}{\PYZsh{} label encode the categorical variables and convert the numerical variables to float}
         \PY{n}{cat\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{channelGrouping}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{device\PYZus{}browser}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{device\PYZus{}deviceCategory}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{device\PYZus{}operatingSystem}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}city}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}continent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}country}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}metro}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}networkDomain}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}region}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}subContinent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}adContent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}adwordsClickInfo.adNetworkType}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}adwordsClickInfo.gclId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}adwordsClickInfo.page}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}adwordsClickInfo.slot}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}campaign}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}keyword}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}medium}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}referralPath}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}source}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trafficSource\PYZus{}adwordsClickInfo.isVideoAd}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trafficSource\PYZus{}isTrueDirect}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{cat\PYZus{}cols}\PY{p}{:}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{col}\PY{p}{)}
             \PY{n}{lbl} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{LabelEncoder}\PY{p}{(}\PY{p}{)}
             \PY{n}{lbl}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{str}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{str}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{lbl}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{str}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{lbl}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{str}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
channelGrouping
device\_browser
device\_deviceCategory
device\_operatingSystem
geoNetwork\_city
geoNetwork\_continent
geoNetwork\_country
geoNetwork\_metro
geoNetwork\_networkDomain
geoNetwork\_region
geoNetwork\_subContinent
trafficSource\_adContent
trafficSource\_adwordsClickInfo.adNetworkType
trafficSource\_adwordsClickInfo.gclId
trafficSource\_adwordsClickInfo.page
trafficSource\_adwordsClickInfo.slot
trafficSource\_campaign
trafficSource\_keyword
trafficSource\_medium
trafficSource\_referralPath
trafficSource\_source
trafficSource\_adwordsClickInfo.isVideoAd
trafficSource\_isTrueDirect

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}EXTERNAL DATA FROM STRINGS TO INTEGERS}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{model\PYZus{}selection}\PY{p}{,} \PY{n}{preprocessing}\PY{p}{,} \PY{n}{metrics}
        
        \PY{c+c1}{\PYZsh{} Impute 0 for missing target values}
        \PY{n}{train\PYZus{}new}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{n}{train\PYZus{}y} \PY{o}{=} \PY{n}{train\PYZus{}new}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
        \PY{n}{train\PYZus{}id} \PY{o}{=} \PY{n}{train\PYZus{}new}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
        \PY{n}{test\PYZus{}id} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
        
        
        \PY{c+c1}{\PYZsh{} label encode the categorical variables and convert the numerical variables to float}
        \PY{n}{cat\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{channelGrouping}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{device\PYZus{}browser}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{device\PYZus{}deviceCategory}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{device\PYZus{}operatingSystem}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}city}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}continent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}country}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}metro}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}networkDomain}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}region}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}subContinent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}adContent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}adwordsClickInfo.adNetworkType}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}adwordsClickInfo.gclId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}adwordsClickInfo.page}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}adwordsClickInfo.slot}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}campaign}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}keyword}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}medium}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}referralPath}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}source}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trafficSource\PYZus{}adwordsClickInfo.isVideoAd}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trafficSource\PYZus{}isTrueDirect}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
        \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{cat\PYZus{}cols}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{col}\PY{p}{)}
            \PY{n}{lbl} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{LabelEncoder}\PY{p}{(}\PY{p}{)}
            \PY{n}{lbl}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{train\PYZus{}new}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{str}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{str}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
            \PY{n}{train\PYZus{}new}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{lbl}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{train\PYZus{}new}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{str}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
            \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{lbl}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{str}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{c+c1}{\PYZsh{}CONVERTING OBJECT TO FLOAT}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         \PY{n}{num\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}hits}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}pageviews}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{visitNumber}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}bounces}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}  \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}newVisits}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dayofweek}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{hour}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{month}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}    
         
         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{num\PYZus{}cols}\PY{p}{:}
             \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{float}\PY{p}{)}
             \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{float}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Index(['channelGrouping', 'date', 'fullVisitorId', 'visitId', 'visitNumber',
       'visitStartTime', 'device\_browser', 'device\_deviceCategory',
       'device\_isMobile', 'device\_operatingSystem', 'geoNetwork\_city',
       'geoNetwork\_continent', 'geoNetwork\_country', 'geoNetwork\_metro',
       'geoNetwork\_networkDomain', 'geoNetwork\_region',
       'geoNetwork\_subContinent', 'totals\_bounces', 'totals\_hits',
       'totals\_newVisits', 'totals\_pageviews', 'totals\_transactionRevenue',
       'trafficSource\_adContent',
       'trafficSource\_adwordsClickInfo.adNetworkType',
       'trafficSource\_adwordsClickInfo.gclId',
       'trafficSource\_adwordsClickInfo.isVideoAd',
       'trafficSource\_adwordsClickInfo.page',
       'trafficSource\_adwordsClickInfo.slot', 'trafficSource\_campaign',
       'trafficSource\_isTrueDirect', 'trafficSource\_keyword',
       'trafficSource\_medium', 'trafficSource\_referralPath',
       'trafficSource\_source', 'dayofweek', 'hour', 'month'],
      dtype='object')

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}SPLITTING DATA BASED ON DATE}
        \PY{k+kn}{import} \PY{n+nn}{datetime}
        
        \PY{c+c1}{\PYZsh{} Split the train dataset into development and valid based on time }
        \PY{n}{dev\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{\PYZlt{}}\PY{o}{=}\PY{n}{datetime}\PY{o}{.}\PY{n}{date}\PY{p}{(}\PY{l+m+mi}{2017}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{31}\PY{p}{)}\PY{p}{]}
        \PY{n}{val\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{n}{datetime}\PY{o}{.}\PY{n}{date}\PY{p}{(}\PY{l+m+mi}{2017}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{31}\PY{p}{)}\PY{p}{]}
        \PY{n}{dev\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{dev\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
        \PY{n}{val\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
        
        \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}df}\PY{p}{[}\PY{n}{cat\PYZus{}cols} \PY{o}{+} \PY{n}{num\PYZus{}cols}\PY{p}{]} 
        \PY{n}{val\PYZus{}X} \PY{o}{=} \PY{n}{val\PYZus{}df}\PY{p}{[}\PY{n}{cat\PYZus{}cols} \PY{o}{+} \PY{n}{num\PYZus{}cols}\PY{p}{]} 
        \PY{n}{test\PYZus{}X} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{cat\PYZus{}cols} \PY{o}{+} \PY{n}{num\PYZus{}cols}\PY{p}{]} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{print} \PY{p}{(}\PY{n}{dev\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{dev\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
        
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{val\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{val\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
        
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{dev\PYZus{}y}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{val\PYZus{}y}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
        
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{val\PYZus{}X}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{val\PYZus{}X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
        
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{test\PYZus{}X}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{test\PYZus{}X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{c+c1}{\PYZsh{}SPLITTING DATA AS 75\PYZpc{} FOR TRAIN AND 25\PYZpc{} FOR VALIDATION }
         
         \PY{n}{x}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}
         \PY{n}{x1} \PY{o}{=} \PY{l+m+mi}{3} \PY{o}{*} \PY{n+nb}{int}\PY{p}{(}\PY{n}{x} \PY{o}{/} \PY{l+m+mi}{4}\PY{p}{)}
         
         \PY{n}{dev\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{x1}\PY{p}{]}
         \PY{n}{val\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{x1}\PY{p}{:}\PY{n}{x}\PY{p}{]}
         
         \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}df}
         \PY{n}{val\PYZus{}X} \PY{o}{=} \PY{n}{val\PYZus{}df}
         
         \PY{n}{dev\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{val\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}X}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{val\PYZus{}X} \PY{o}{=} \PY{n}{val\PYZus{}X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{test\PYZus{}X} \PY{o}{=} \PY{n}{test\PYZus{}df}
         \PY{n}{test\PYZus{}X} \PY{o}{=} \PY{n}{test\PYZus{}X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{dev\PYZus{}y}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{val\PYZus{}y}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{val\PYZus{}X}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{val\PYZus{}X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{test\PYZus{}X}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{test\PYZus{}X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(677739,)
(225914,)
(677739, 33)
Index(['channelGrouping', 'visitId', 'visitNumber', 'device\_browser',
       'device\_deviceCategory', 'device\_isMobile', 'device\_operatingSystem',
       'geoNetwork\_city', 'geoNetwork\_continent', 'geoNetwork\_country',
       'geoNetwork\_metro', 'geoNetwork\_networkDomain', 'geoNetwork\_region',
       'geoNetwork\_subContinent', 'totals\_bounces', 'totals\_hits',
       'totals\_newVisits', 'totals\_pageviews', 'trafficSource\_adContent',
       'trafficSource\_adwordsClickInfo.adNetworkType',
       'trafficSource\_adwordsClickInfo.gclId',
       'trafficSource\_adwordsClickInfo.isVideoAd',
       'trafficSource\_adwordsClickInfo.page',
       'trafficSource\_adwordsClickInfo.slot', 'trafficSource\_campaign',
       'trafficSource\_isTrueDirect', 'trafficSource\_keyword',
       'trafficSource\_medium', 'trafficSource\_referralPath',
       'trafficSource\_source', 'dayofweek', 'hour', 'month'],
      dtype='object')
(225914, 33)
Index(['channelGrouping', 'visitId', 'visitNumber', 'device\_browser',
       'device\_deviceCategory', 'device\_isMobile', 'device\_operatingSystem',
       'geoNetwork\_city', 'geoNetwork\_continent', 'geoNetwork\_country',
       'geoNetwork\_metro', 'geoNetwork\_networkDomain', 'geoNetwork\_region',
       'geoNetwork\_subContinent', 'totals\_bounces', 'totals\_hits',
       'totals\_newVisits', 'totals\_pageviews', 'trafficSource\_adContent',
       'trafficSource\_adwordsClickInfo.adNetworkType',
       'trafficSource\_adwordsClickInfo.gclId',
       'trafficSource\_adwordsClickInfo.isVideoAd',
       'trafficSource\_adwordsClickInfo.page',
       'trafficSource\_adwordsClickInfo.slot', 'trafficSource\_campaign',
       'trafficSource\_isTrueDirect', 'trafficSource\_keyword',
       'trafficSource\_medium', 'trafficSource\_referralPath',
       'trafficSource\_source', 'dayofweek', 'hour', 'month'],
      dtype='object')
(804684, 33)
Index(['channelGrouping', 'visitId', 'visitNumber', 'device\_browser',
       'device\_deviceCategory', 'device\_isMobile', 'device\_operatingSystem',
       'geoNetwork\_city', 'geoNetwork\_continent', 'geoNetwork\_country',
       'geoNetwork\_metro', 'geoNetwork\_networkDomain', 'geoNetwork\_region',
       'geoNetwork\_subContinent', 'totals\_bounces', 'totals\_hits',
       'totals\_newVisits', 'totals\_pageviews', 'trafficSource\_adContent',
       'trafficSource\_adwordsClickInfo.adNetworkType',
       'trafficSource\_adwordsClickInfo.gclId',
       'trafficSource\_adwordsClickInfo.isVideoAd',
       'trafficSource\_adwordsClickInfo.page',
       'trafficSource\_adwordsClickInfo.slot', 'trafficSource\_campaign',
       'trafficSource\_isTrueDirect', 'trafficSource\_keyword',
       'trafficSource\_medium', 'trafficSource\_referralPath',
       'trafficSource\_source', 'dayofweek', 'hour', 'month'],
      dtype='object')

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} import sys}
        \PY{c+c1}{\PYZsh{} !conda install \PYZhy{}\PYZhy{}yes \PYZhy{}\PYZhy{}prefix \PYZob{}sys.prefix\PYZcb{} lightgbm}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} !conda install \PYZhy{}\PYZhy{}yes lightgbm}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} !conda install \PYZhy{}\PYZhy{}yes \PYZhy{}c conda\PYZhy{}forge lightgbm}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{TRAIN}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         
         \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{TEST}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
TRAIN
(903653, 37)
Index(['channelGrouping', 'date', 'fullVisitorId', 'visitId', 'visitNumber',
       'visitStartTime', 'device\_browser', 'device\_deviceCategory',
       'device\_isMobile', 'device\_operatingSystem', 'geoNetwork\_city',
       'geoNetwork\_continent', 'geoNetwork\_country', 'geoNetwork\_metro',
       'geoNetwork\_networkDomain', 'geoNetwork\_region',
       'geoNetwork\_subContinent', 'totals\_bounces', 'totals\_hits',
       'totals\_newVisits', 'totals\_pageviews', 'totals\_transactionRevenue',
       'trafficSource\_adContent',
       'trafficSource\_adwordsClickInfo.adNetworkType',
       'trafficSource\_adwordsClickInfo.gclId',
       'trafficSource\_adwordsClickInfo.isVideoAd',
       'trafficSource\_adwordsClickInfo.page',
       'trafficSource\_adwordsClickInfo.slot', 'trafficSource\_campaign',
       'trafficSource\_isTrueDirect', 'trafficSource\_keyword',
       'trafficSource\_medium', 'trafficSource\_referralPath',
       'trafficSource\_source', 'dayofweek', 'hour', 'month'],
      dtype='object')
TEST
(804684, 36)
Index(['channelGrouping', 'date', 'fullVisitorId', 'visitId', 'visitNumber',
       'visitStartTime', 'device\_browser', 'device\_deviceCategory',
       'device\_isMobile', 'device\_operatingSystem', 'geoNetwork\_city',
       'geoNetwork\_continent', 'geoNetwork\_country', 'geoNetwork\_metro',
       'geoNetwork\_networkDomain', 'geoNetwork\_region',
       'geoNetwork\_subContinent', 'totals\_bounces', 'totals\_hits',
       'totals\_newVisits', 'totals\_pageviews', 'trafficSource\_adContent',
       'trafficSource\_adwordsClickInfo.adNetworkType',
       'trafficSource\_adwordsClickInfo.gclId',
       'trafficSource\_adwordsClickInfo.isVideoAd',
       'trafficSource\_adwordsClickInfo.page',
       'trafficSource\_adwordsClickInfo.slot', 'trafficSource\_campaign',
       'trafficSource\_isTrueDirect', 'trafficSource\_keyword',
       'trafficSource\_medium', 'trafficSource\_referralPath',
       'trafficSource\_source', 'dayofweek', 'hour', 'month'],
      dtype='object')

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{imp\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{channelGrouping}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{device\PYZus{}operatingSystem}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}city}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}region}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}country}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}metro}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}networkDomain}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}adwordsClickInfo.gclId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}referralPath}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}source}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}hits}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}pageviews}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{visitNumber}\PY{l+s+s2}{\PYZdq{}}
                    \PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{visitId}\PY{l+s+s2}{\PYZdq{}}
                   \PY{p}{]}
        
        \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}X}\PY{p}{[}\PY{n}{imp\PYZus{}cols}\PY{p}{]} 
        \PY{n}{val\PYZus{}X} \PY{o}{=} \PY{n}{val\PYZus{}X}\PY{p}{[}\PY{n}{imp\PYZus{}cols}\PY{p}{]} 
        \PY{n}{test\PYZus{}X} \PY{o}{=} \PY{n}{test\PYZus{}X}\PY{p}{[}\PY{n}{imp\PYZus{}cols}\PY{p}{]} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kn}{import} \PY{n+nn}{lightgbm} \PY{k}{as} \PY{n+nn}{lgb}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{dtypes}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}49}]:} channelGrouping                                          int64
         date                                            datetime64[ns]
         fullVisitorId                                           object
         visitId                                                  int64
         visitNumber                                            float64
         visitStartTime                                  datetime64[ns]
         device\_browser                                           int64
         device\_deviceCategory                                    int64
         device\_isMobile                                           bool
         device\_operatingSystem                                   int64
         geoNetwork\_city                                          int64
         geoNetwork\_continent                                     int64
         geoNetwork\_country                                       int64
         geoNetwork\_metro                                         int64
         geoNetwork\_networkDomain                                 int64
         geoNetwork\_region                                        int64
         geoNetwork\_subContinent                                  int64
         totals\_bounces                                         float64
         totals\_hits                                            float64
         totals\_newVisits                                       float64
         totals\_pageviews                                       float64
         totals\_transactionRevenue                              float64
         trafficSource\_adContent                                  int64
         trafficSource\_adwordsClickInfo.adNetworkType             int64
         trafficSource\_adwordsClickInfo.gclId                     int64
         trafficSource\_adwordsClickInfo.isVideoAd                 int64
         trafficSource\_adwordsClickInfo.page                      int64
         trafficSource\_adwordsClickInfo.slot                      int64
         trafficSource\_campaign                                   int64
         trafficSource\_isTrueDirect                               int64
         trafficSource\_keyword                                    int64
         trafficSource\_medium                                     int64
         trafficSource\_referralPath                               int64
         trafficSource\_source                                     int64
         dayofweek                                              float64
         hour                                                   float64
         month                                                  float64
         dtype: object
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{c+c1}{\PYZsh{} LGB}
         \PY{k}{def} \PY{n+nf}{run\PYZus{}lgb}\PY{p}{(}\PY{n}{train\PYZus{}X}\PY{p}{,} \PY{n}{train\PYZus{}y}\PY{p}{,} \PY{n}{val\PYZus{}X}\PY{p}{,} \PY{n}{val\PYZus{}y}\PY{p}{,} \PY{n}{test\PYZus{}X}\PY{p}{)}\PY{p}{:}
             \PY{n}{params} \PY{o}{=} \PY{p}{\PYZob{}}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{objective}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{regression}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{metric}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}leaves}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{30}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{min\PYZus{}child\PYZus{}samples}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{100}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{learning\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mf}{0.1}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{bagging\PYZus{}fraction}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mf}{0.7}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{feature\PYZus{}fraction}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mf}{0.5}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{bagging\PYZus{}frequency}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{5}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{bagging\PYZus{}seed}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{2018}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{verbosity}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
             \PY{p}{\PYZcb{}}
             
             \PY{n}{lgtrain} \PY{o}{=} \PY{n}{lgb}\PY{o}{.}\PY{n}{Dataset}\PY{p}{(}\PY{n}{train\PYZus{}X}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{train\PYZus{}y}\PY{p}{)}
             \PY{n}{lgval} \PY{o}{=} \PY{n}{lgb}\PY{o}{.}\PY{n}{Dataset}\PY{p}{(}\PY{n}{val\PYZus{}X}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{val\PYZus{}y}\PY{p}{)}
             \PY{n}{model} \PY{o}{=} \PY{n}{lgb}\PY{o}{.}\PY{n}{train}\PY{p}{(}\PY{n}{params}\PY{p}{,} \PY{n}{lgtrain}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{valid\PYZus{}sets}\PY{o}{=}\PY{p}{[}\PY{n}{lgval}\PY{p}{]}\PY{p}{,} \PY{n}{early\PYZus{}stopping\PYZus{}rounds}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{verbose\PYZus{}eval}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{)}
             
             \PY{n}{pred\PYZus{}test\PYZus{}y} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{test\PYZus{}X}\PY{p}{,} \PY{n}{num\PYZus{}iteration}\PY{o}{=}\PY{n}{model}\PY{o}{.}\PY{n}{best\PYZus{}iteration}\PY{p}{)}
             \PY{n}{pred\PYZus{}val\PYZus{}y} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{val\PYZus{}X}\PY{p}{,} \PY{n}{num\PYZus{}iteration}\PY{o}{=}\PY{n}{model}\PY{o}{.}\PY{n}{best\PYZus{}iteration}\PY{p}{)}
             \PY{k}{return} \PY{n}{pred\PYZus{}test\PYZus{}y}\PY{p}{,} \PY{n}{model}\PY{p}{,} \PY{n}{pred\PYZus{}val\PYZus{}y}
         
         \PY{c+c1}{\PYZsh{} Training the model \PYZsh{}}
         \PY{n}{pred\PYZus{}test}\PY{p}{,} \PY{n}{model}\PY{p}{,} \PY{n}{pred\PYZus{}val} \PY{o}{=} \PY{n}{run\PYZus{}lgb}\PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{p}{,} \PY{n}{dev\PYZus{}y}\PY{p}{,} \PY{n}{val\PYZus{}X}\PY{p}{,} \PY{n}{val\PYZus{}y}\PY{p}{,} \PY{n}{test\PYZus{}X}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60807
[300]	valid\_0's rmse: 1.60715
Early stopping, best iteration is:
[257]	valid\_0's rmse: 1.60683

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
         \PY{n}{pred\PYZus{}val}\PY{p}{[}\PY{n}{pred\PYZus{}val}\PY{o}{\PYZlt{}}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{val\PYZus{}pred\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
         \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{expm1}\PY{p}{(}\PY{n}{pred\PYZus{}val}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print(np.sqrt(metrics.mean\PYZus{}squared\PYZus{}error(np.log1p(val\PYZus{}pred\PYZus{}df[\PYZdq{}transactionRevenue\PYZdq{}].values), np.log1p(val\PYZus{}pred\PYZus{}df[\PYZdq{}PredictedRevenue\PYZdq{}].values))))}
         \PY{n}{val\PYZus{}pred\PYZus{}df} \PY{o}{=} \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
1.6288250113593938

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{n}{sub\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{test\PYZus{}id}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{pred\PYZus{}test}\PY{p}{[}\PY{n}{pred\PYZus{}test}\PY{o}{\PYZlt{}}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{sub\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedLogRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{expm1}\PY{p}{(}\PY{n}{pred\PYZus{}test}\PY{p}{)}
         \PY{n}{sub\PYZus{}df} \PY{o}{=} \PY{n}{sub\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedLogRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
         \PY{n}{sub\PYZus{}df}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedLogRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{sub\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedLogRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{sub\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedLogRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{sub\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{prediction\PYZus{}1.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{18}\PY{p}{)}\PY{p}{)}
         \PY{n}{lgb}\PY{o}{.}\PY{n}{plot\PYZus{}importance}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{max\PYZus{}num\PYZus{}features}\PY{o}{=}\PY{l+m+mi}{50}\PY{p}{,} \PY{n}{height}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{LightGBM \PYZhy{} Feature Importance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_107_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{c+c1}{\PYZsh{} LGB FOR PERMUTATION TEST}
         \PY{k}{def} \PY{n+nf}{run\PYZus{}lgb\PYZus{}perm}\PY{p}{(}\PY{n}{train\PYZus{}X}\PY{p}{,} \PY{n}{train\PYZus{}y}\PY{p}{,} \PY{n}{val\PYZus{}X}\PY{p}{,} \PY{n}{val\PYZus{}y}\PY{p}{)}\PY{p}{:}
             \PY{n}{params} \PY{o}{=} \PY{p}{\PYZob{}}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{objective}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{regression}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{metric}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}leaves}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{30}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{min\PYZus{}child\PYZus{}samples}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{100}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{learning\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mf}{0.1}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{bagging\PYZus{}fraction}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mf}{0.7}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{feature\PYZus{}fraction}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mf}{0.5}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{bagging\PYZus{}frequency}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{5}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{bagging\PYZus{}seed}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{2018}\PY{p}{,}
                 \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{verbosity}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
             \PY{p}{\PYZcb{}}
             
             \PY{n}{lgtrain} \PY{o}{=} \PY{n}{lgb}\PY{o}{.}\PY{n}{Dataset}\PY{p}{(}\PY{n}{train\PYZus{}X}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{train\PYZus{}y}\PY{p}{)}
             \PY{n}{lgval} \PY{o}{=} \PY{n}{lgb}\PY{o}{.}\PY{n}{Dataset}\PY{p}{(}\PY{n}{val\PYZus{}X}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{val\PYZus{}y}\PY{p}{)}
             \PY{n}{model} \PY{o}{=} \PY{n}{lgb}\PY{o}{.}\PY{n}{train}\PY{p}{(}\PY{n}{params}\PY{p}{,} \PY{n}{lgtrain}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{valid\PYZus{}sets}\PY{o}{=}\PY{p}{[}\PY{n}{lgval}\PY{p}{]}\PY{p}{,} \PY{n}{early\PYZus{}stopping\PYZus{}rounds}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{verbose\PYZus{}eval}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{)}
             
             \PY{n}{pred\PYZus{}val\PYZus{}y} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{val\PYZus{}X}\PY{p}{,} \PY{n}{num\PYZus{}iteration}\PY{o}{=}\PY{n}{model}\PY{o}{.}\PY{n}{best\PYZus{}iteration}\PY{p}{)}
             \PY{k}{return} \PY{n}{model}\PY{p}{,} \PY{n}{pred\PYZus{}val\PYZus{}y}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{n}{base\PYZus{}rmse} \PY{o}{=} \PY{l+m+mf}{1.60683}
         \PY{n+nb}{iter} \PY{o}{=} \PY{l+m+mi}{100}
         \PY{n}{p\PYZus{}val} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{}for column\PYZus{}perm in [\PYZdq{}totals\PYZus{}pageviews\PYZdq{}, \PYZdq{}totals\PYZus{}hits\PYZdq{}, \PYZdq{}visitID\PYZdq{}, \PYZdq{}totals\PYZus{}newVisits\PYZdq{}, \PYZdq{}geoNetwork\PYZus{}continent\PYZdq{}, \PYZdq{}trafficSource\PYZus{}campaign\PYZdq{}]:}
         \PY{k}{for} \PY{n}{column\PYZus{}perm} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}pageviews}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}hits}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}campaign}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
             \PY{n}{ans} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{iter}\PY{p}{)}\PY{p}{:}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{column\PYZus{}perm}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{i}\PY{p}{)}
                 \PY{n}{train\PYZus{}permute} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
                 \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{column\PYZus{}perm}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{permutation}\PY{p}{(}\PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{column\PYZus{}perm}\PY{p}{]}\PY{p}{)}
                 \PY{n}{x}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}
                 \PY{n}{x1} \PY{o}{=} \PY{l+m+mi}{3} \PY{o}{*} \PY{n+nb}{int}\PY{p}{(}\PY{n}{x} \PY{o}{/} \PY{l+m+mi}{4}\PY{p}{)}
         
                 \PY{n}{dev\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{x1}\PY{p}{]}
                 \PY{n}{val\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{x1}\PY{p}{:}\PY{n}{x}\PY{p}{]}
         
                 \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}df}
                 \PY{n}{val\PYZus{}X} \PY{o}{=} \PY{n}{val\PYZus{}df}
         
                 \PY{n}{dev\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
                 \PY{n}{val\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}X}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
                 \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{val\PYZus{}X} \PY{o}{=} \PY{n}{val\PYZus{}X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         
                 \PY{n}{model}\PY{p}{,} \PY{n}{pred\PYZus{}val} \PY{o}{=} \PY{n}{run\PYZus{}lgb\PYZus{}perm}\PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{p}{,} \PY{n}{dev\PYZus{}y}\PY{p}{,} \PY{n}{val\PYZus{}X}\PY{p}{,} \PY{n}{val\PYZus{}y}\PY{p}{)}
                 
                 \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
                 \PY{n}{pred\PYZus{}val}\PY{p}{[}\PY{n}{pred\PYZus{}val}\PY{o}{\PYZlt{}}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{val\PYZus{}pred\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{\PYZcb{}}\PY{p}{)}
                 \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
                 \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{expm1}\PY{p}{(}\PY{n}{pred\PYZus{}val}\PY{p}{)}
                 \PY{n}{val\PYZus{}pred\PYZus{}df} \PY{o}{=} \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                 \PY{n}{ans}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{less\PYZus{}sum} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{i} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{base\PYZus{}rmse} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ans}\PY{p}{)}
             \PY{n}{p\PYZus{}val}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{less\PYZus{}sum}\PY{o}{/}\PY{n+nb}{iter}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
totals\_pageviews   0
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67808
[200]	valid\_0's rmse: 1.6777
Early stopping, best iteration is:
[151]	valid\_0's rmse: 1.67647
1.6989862887281182
totals\_pageviews   1
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67818
[200]	valid\_0's rmse: 1.67617
[300]	valid\_0's rmse: 1.67705
Early stopping, best iteration is:
[238]	valid\_0's rmse: 1.67599
1.6974820694022061
totals\_pageviews   2
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67927
[200]	valid\_0's rmse: 1.6778
Early stopping, best iteration is:
[170]	valid\_0's rmse: 1.67775
1.7007559549528832
totals\_pageviews   3
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67913
[200]	valid\_0's rmse: 1.67794
Early stopping, best iteration is:
[152]	valid\_0's rmse: 1.67738
1.7004178736941358
totals\_pageviews   4
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6792
[200]	valid\_0's rmse: 1.67786
Early stopping, best iteration is:
[196]	valid\_0's rmse: 1.67774
1.699650990753695
totals\_pageviews   5
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67783
[200]	valid\_0's rmse: 1.67559
[300]	valid\_0's rmse: 1.67534
Early stopping, best iteration is:
[275]	valid\_0's rmse: 1.67491
1.6957901933110862
totals\_pageviews   6
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67925
[200]	valid\_0's rmse: 1.67761
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67752
1.6995395606551928
totals\_pageviews   7
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67973
[200]	valid\_0's rmse: 1.67826
Early stopping, best iteration is:
[174]	valid\_0's rmse: 1.67791
1.7001860192051486
totals\_pageviews   8
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67829
[200]	valid\_0's rmse: 1.67628
[300]	valid\_0's rmse: 1.6768
Early stopping, best iteration is:
[219]	valid\_0's rmse: 1.67588
1.697322747153912
totals\_pageviews   9
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67852
[200]	valid\_0's rmse: 1.67673
[300]	valid\_0's rmse: 1.67712
Early stopping, best iteration is:
[218]	valid\_0's rmse: 1.67639
1.69807651351799
totals\_pageviews   10
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67944
[200]	valid\_0's rmse: 1.67776
Early stopping, best iteration is:
[148]	valid\_0's rmse: 1.67706
1.6997502911286602
totals\_pageviews   11
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67801
[200]	valid\_0's rmse: 1.67562
[300]	valid\_0's rmse: 1.67584
Early stopping, best iteration is:
[202]	valid\_0's rmse: 1.67548
1.6976226070885345
totals\_pageviews   12
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67814
[200]	valid\_0's rmse: 1.67657
[300]	valid\_0's rmse: 1.67576
Early stopping, best iteration is:
[284]	valid\_0's rmse: 1.67552
1.6965417131003528
totals\_pageviews   13
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67897
[200]	valid\_0's rmse: 1.6775
Early stopping, best iteration is:
[140]	valid\_0's rmse: 1.67716
1.6997925261165145
totals\_pageviews   14
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67897
[200]	valid\_0's rmse: 1.67664
[300]	valid\_0's rmse: 1.67691
Early stopping, best iteration is:
[239]	valid\_0's rmse: 1.67632
1.6980924087471005
totals\_pageviews   15
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67992
[200]	valid\_0's rmse: 1.67788
[300]	valid\_0's rmse: 1.67857
Early stopping, best iteration is:
[240]	valid\_0's rmse: 1.67781
1.699294751768431
totals\_pageviews   16
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67752
[200]	valid\_0's rmse: 1.67596
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67589
1.696998394172894
totals\_pageviews   17
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67739
[200]	valid\_0's rmse: 1.6763
Early stopping, best iteration is:
[149]	valid\_0's rmse: 1.67584
1.6985238410899655
totals\_pageviews   18
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67795
[200]	valid\_0's rmse: 1.67674
[300]	valid\_0's rmse: 1.67637
Early stopping, best iteration is:
[267]	valid\_0's rmse: 1.67599
1.6975197127784498
totals\_pageviews   19
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67751
[200]	valid\_0's rmse: 1.67569
[300]	valid\_0's rmse: 1.6758
Early stopping, best iteration is:
[209]	valid\_0's rmse: 1.6755
1.6981531500768925
totals\_pageviews   20
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67811
[200]	valid\_0's rmse: 1.67638
Early stopping, best iteration is:
[157]	valid\_0's rmse: 1.67616
1.698990143909973
totals\_pageviews   21
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67836
[200]	valid\_0's rmse: 1.67695
Early stopping, best iteration is:
[142]	valid\_0's rmse: 1.67659
1.6996569633035132
totals\_pageviews   22
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67777
[200]	valid\_0's rmse: 1.67615
Early stopping, best iteration is:
[156]	valid\_0's rmse: 1.67569
1.6984519462538525
totals\_pageviews   23
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6788
[200]	valid\_0's rmse: 1.67664
[300]	valid\_0's rmse: 1.67743
Early stopping, best iteration is:
[229]	valid\_0's rmse: 1.67648
1.6980450891402206
totals\_pageviews   24
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67851
[200]	valid\_0's rmse: 1.67699
Early stopping, best iteration is:
[190]	valid\_0's rmse: 1.67679
1.699479414594047
totals\_pageviews   25
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67877
[200]	valid\_0's rmse: 1.67657
[300]	valid\_0's rmse: 1.67727
Early stopping, best iteration is:
[239]	valid\_0's rmse: 1.67623
1.6979973832478723
totals\_pageviews   26
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67924
[200]	valid\_0's rmse: 1.6776
[300]	valid\_0's rmse: 1.67796
Early stopping, best iteration is:
[200]	valid\_0's rmse: 1.6776
1.6994789669043784
totals\_pageviews   27
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67845
[200]	valid\_0's rmse: 1.67665
[300]	valid\_0's rmse: 1.67732
Early stopping, best iteration is:
[205]	valid\_0's rmse: 1.67645
1.6987203805990068
totals\_pageviews   28
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67806
[200]	valid\_0's rmse: 1.67641
[300]	valid\_0's rmse: 1.67577
[400]	valid\_0's rmse: 1.67749
Early stopping, best iteration is:
[302]	valid\_0's rmse: 1.6757
1.6963683170453845
totals\_pageviews   29
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67818
[200]	valid\_0's rmse: 1.67618
Early stopping, best iteration is:
[183]	valid\_0's rmse: 1.67605
1.6980883112442309
totals\_pageviews   30
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67828
[200]	valid\_0's rmse: 1.67685
Early stopping, best iteration is:
[196]	valid\_0's rmse: 1.67667
1.6988228392531395
totals\_pageviews   31
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6789
[200]	valid\_0's rmse: 1.6769
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67685
1.6983133774986419
totals\_pageviews   32
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67828
[200]	valid\_0's rmse: 1.67543
[300]	valid\_0's rmse: 1.67636
Early stopping, best iteration is:
[200]	valid\_0's rmse: 1.67543
1.6974633509878132
totals\_pageviews   33
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6797
[200]	valid\_0's rmse: 1.67784
Early stopping, best iteration is:
[153]	valid\_0's rmse: 1.67748
1.6998201173170622
totals\_pageviews   34
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.679
[200]	valid\_0's rmse: 1.67737
Early stopping, best iteration is:
[171]	valid\_0's rmse: 1.67708
1.6996221100484386
totals\_pageviews   35
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67667
[200]	valid\_0's rmse: 1.67454
[300]	valid\_0's rmse: 1.67531
Early stopping, best iteration is:
[224]	valid\_0's rmse: 1.67432
1.6975258704711442
totals\_pageviews   36
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67694
[200]	valid\_0's rmse: 1.67498
[300]	valid\_0's rmse: 1.67695
Early stopping, best iteration is:
[200]	valid\_0's rmse: 1.67498
1.696957319452543
totals\_pageviews   37
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67843
[200]	valid\_0's rmse: 1.67658
[300]	valid\_0's rmse: 1.67625
Early stopping, best iteration is:
[292]	valid\_0's rmse: 1.67622
1.6975305445967992
totals\_pageviews   38
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67719
[200]	valid\_0's rmse: 1.67637
Early stopping, best iteration is:
[157]	valid\_0's rmse: 1.67582
1.698747910419099
totals\_pageviews   39
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67931
[200]	valid\_0's rmse: 1.6786
[300]	valid\_0's rmse: 1.67827
Early stopping, best iteration is:
[241]	valid\_0's rmse: 1.67792
1.698433094663458
totals\_pageviews   40
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67835
[200]	valid\_0's rmse: 1.67709
Early stopping, best iteration is:
[198]	valid\_0's rmse: 1.67708
1.6993159195021037
totals\_pageviews   41
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67862
[200]	valid\_0's rmse: 1.67761
Early stopping, best iteration is:
[157]	valid\_0's rmse: 1.67747
1.6996856444056014
totals\_pageviews   42
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67938
[200]	valid\_0's rmse: 1.67746
[300]	valid\_0's rmse: 1.67757
Early stopping, best iteration is:
[229]	valid\_0's rmse: 1.67712
1.6983793893842716
totals\_pageviews   43
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67754
[200]	valid\_0's rmse: 1.67528
[300]	valid\_0's rmse: 1.67514
Early stopping, best iteration is:
[208]	valid\_0's rmse: 1.67494
1.6970511823263956
totals\_pageviews   44
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67669
[200]	valid\_0's rmse: 1.67604
Early stopping, best iteration is:
[153]	valid\_0's rmse: 1.67549
1.6983811338712649
totals\_pageviews   45
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67743
[200]	valid\_0's rmse: 1.67575
Early stopping, best iteration is:
[148]	valid\_0's rmse: 1.67566
1.698483202090256
totals\_pageviews   46
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67777
[200]	valid\_0's rmse: 1.67508
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.67493
1.696951525007566
totals\_pageviews   47
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6774
[200]	valid\_0's rmse: 1.67609
Early stopping, best iteration is:
[149]	valid\_0's rmse: 1.67588
1.6983768476215895
totals\_pageviews   48
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67813
[200]	valid\_0's rmse: 1.67774
Early stopping, best iteration is:
[153]	valid\_0's rmse: 1.67721
1.7000911010860764
totals\_pageviews   49
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67785
[200]	valid\_0's rmse: 1.67628
Early stopping, best iteration is:
[168]	valid\_0's rmse: 1.67597
1.6989458175720649
totals\_pageviews   50
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67756
[200]	valid\_0's rmse: 1.67591
[300]	valid\_0's rmse: 1.67603
Early stopping, best iteration is:
[277]	valid\_0's rmse: 1.67582
1.696956057376883
totals\_pageviews   51
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67863
[200]	valid\_0's rmse: 1.6757
[300]	valid\_0's rmse: 1.67692
Early stopping, best iteration is:
[236]	valid\_0's rmse: 1.67547
1.6963592153885951
totals\_pageviews   52
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67816
[200]	valid\_0's rmse: 1.67667
Early stopping, best iteration is:
[196]	valid\_0's rmse: 1.67646
1.6979466186809165
totals\_pageviews   53
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67975
[200]	valid\_0's rmse: 1.67836
[300]	valid\_0's rmse: 1.67832
Early stopping, best iteration is:
[239]	valid\_0's rmse: 1.6778
1.6999028654190913
totals\_pageviews   54
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67844
[200]	valid\_0's rmse: 1.67791
Early stopping, best iteration is:
[156]	valid\_0's rmse: 1.67759
1.6997313705698247
totals\_pageviews   55
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67784
[200]	valid\_0's rmse: 1.67609
[300]	valid\_0's rmse: 1.67661
Early stopping, best iteration is:
[248]	valid\_0's rmse: 1.67577
1.6975229957004205
totals\_pageviews   56
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67659
[200]	valid\_0's rmse: 1.67532
Early stopping, best iteration is:
[150]	valid\_0's rmse: 1.6749
1.6972061086743941
totals\_pageviews   57
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6784
[200]	valid\_0's rmse: 1.67708
Early stopping, best iteration is:
[168]	valid\_0's rmse: 1.677
1.699225859512489
totals\_pageviews   58
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67773
[200]	valid\_0's rmse: 1.67536
[300]	valid\_0's rmse: 1.67553
Early stopping, best iteration is:
[216]	valid\_0's rmse: 1.67525
1.697452845265178
totals\_pageviews   59
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67856
[200]	valid\_0's rmse: 1.67634
[300]	valid\_0's rmse: 1.67691
Early stopping, best iteration is:
[225]	valid\_0's rmse: 1.67589
1.6975229688777966
totals\_pageviews   60
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67911
[200]	valid\_0's rmse: 1.67804
Early stopping, best iteration is:
[196]	valid\_0's rmse: 1.67772
1.7003600223792303
totals\_pageviews   61
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67933
[200]	valid\_0's rmse: 1.67752
[300]	valid\_0's rmse: 1.6779
Early stopping, best iteration is:
[244]	valid\_0's rmse: 1.67731
1.6984497852328762
totals\_pageviews   62
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67848
[200]	valid\_0's rmse: 1.67802
Early stopping, best iteration is:
[171]	valid\_0's rmse: 1.6774
1.7002213937862738
totals\_pageviews   63
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67789
[200]	valid\_0's rmse: 1.67613
[300]	valid\_0's rmse: 1.6754
[400]	valid\_0's rmse: 1.67617
Early stopping, best iteration is:
[306]	valid\_0's rmse: 1.67532
1.6959692926680503
totals\_pageviews   64
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67744
[200]	valid\_0's rmse: 1.67581
Early stopping, best iteration is:
[175]	valid\_0's rmse: 1.67572
1.6978867231415813
totals\_pageviews   65
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67793
[200]	valid\_0's rmse: 1.6759
[300]	valid\_0's rmse: 1.67633
Early stopping, best iteration is:
[229]	valid\_0's rmse: 1.6759
1.6971218320580008
totals\_pageviews   66
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6791
[200]	valid\_0's rmse: 1.67728
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.67723
1.69963242543326
totals\_pageviews   67
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67769
[200]	valid\_0's rmse: 1.67691
Early stopping, best iteration is:
[139]	valid\_0's rmse: 1.67675
1.6998628321270401
totals\_pageviews   68
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67732
[200]	valid\_0's rmse: 1.67698
Early stopping, best iteration is:
[158]	valid\_0's rmse: 1.67632
1.6992110700824234
totals\_pageviews   69
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67782
[200]	valid\_0's rmse: 1.67554
[300]	valid\_0's rmse: 1.6751
Early stopping, best iteration is:
[236]	valid\_0's rmse: 1.67508
1.6970726368587985
totals\_pageviews   70
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67871
[200]	valid\_0's rmse: 1.67677
Early stopping, best iteration is:
[199]	valid\_0's rmse: 1.67676
1.698447762799126
totals\_pageviews   71
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67796
[200]	valid\_0's rmse: 1.67666
Early stopping, best iteration is:
[151]	valid\_0's rmse: 1.67615
1.698343580187142
totals\_pageviews   72
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67689
[200]	valid\_0's rmse: 1.6755
Early stopping, best iteration is:
[158]	valid\_0's rmse: 1.67518
1.6976307656779712
totals\_pageviews   73
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67833
[200]	valid\_0's rmse: 1.67783
Early stopping, best iteration is:
[158]	valid\_0's rmse: 1.67714
1.698783648466736
totals\_pageviews   74
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67812
[200]	valid\_0's rmse: 1.6769
Early stopping, best iteration is:
[147]	valid\_0's rmse: 1.67655
1.6994981297775338
totals\_pageviews   75
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67924
[200]	valid\_0's rmse: 1.67721
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67692
1.6990558459248004
totals\_pageviews   76
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67899
[200]	valid\_0's rmse: 1.67798
Early stopping, best iteration is:
[148]	valid\_0's rmse: 1.67743
1.7001885590560288
totals\_pageviews   77
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67769
[200]	valid\_0's rmse: 1.67647
Early stopping, best iteration is:
[129]	valid\_0's rmse: 1.67629
1.699704108037471
totals\_pageviews   78
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67955
[200]	valid\_0's rmse: 1.67827
Early stopping, best iteration is:
[149]	valid\_0's rmse: 1.67784
1.7003169848313027
totals\_pageviews   79
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.678
[200]	valid\_0's rmse: 1.67561
Early stopping, best iteration is:
[151]	valid\_0's rmse: 1.67559
1.69823000983128
totals\_pageviews   80
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67781
[200]	valid\_0's rmse: 1.67629
[300]	valid\_0's rmse: 1.67791
Early stopping, best iteration is:
[224]	valid\_0's rmse: 1.67619
1.6981787049574375
totals\_pageviews   81
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6788
[200]	valid\_0's rmse: 1.6773
[300]	valid\_0's rmse: 1.67873
Early stopping, best iteration is:
[204]	valid\_0's rmse: 1.67725
1.699539288233864
totals\_pageviews   82
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67845
[200]	valid\_0's rmse: 1.67619
Early stopping, best iteration is:
[169]	valid\_0's rmse: 1.67594
1.6985081873665229
totals\_pageviews   83
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6776
[200]	valid\_0's rmse: 1.67632
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.67608
1.6975825431259215
totals\_pageviews   84
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67869
[200]	valid\_0's rmse: 1.67683
[300]	valid\_0's rmse: 1.67677
Early stopping, best iteration is:
[236]	valid\_0's rmse: 1.6764
1.6983342901773917
totals\_pageviews   85
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6785
[200]	valid\_0's rmse: 1.67616
[300]	valid\_0's rmse: 1.67616
Early stopping, best iteration is:
[208]	valid\_0's rmse: 1.67599
1.6978076389102592
totals\_pageviews   86
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67903
[200]	valid\_0's rmse: 1.67757
[300]	valid\_0's rmse: 1.67738
[400]	valid\_0's rmse: 1.67806
Early stopping, best iteration is:
[321]	valid\_0's rmse: 1.6771
1.69818905189591
totals\_pageviews   87
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6779
[200]	valid\_0's rmse: 1.67664
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67655
1.6977705172348216
totals\_pageviews   88
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67833
[200]	valid\_0's rmse: 1.67682
[300]	valid\_0's rmse: 1.67603
[400]	valid\_0's rmse: 1.67704
Early stopping, best iteration is:
[346]	valid\_0's rmse: 1.67579
1.6966424667945863
totals\_pageviews   89
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67845
[200]	valid\_0's rmse: 1.67657
Early stopping, best iteration is:
[172]	valid\_0's rmse: 1.67626
1.6991414758326047
totals\_pageviews   90
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67688
[200]	valid\_0's rmse: 1.67502
[300]	valid\_0's rmse: 1.67546
Early stopping, best iteration is:
[224]	valid\_0's rmse: 1.6747
1.696992738864252
totals\_pageviews   91
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67796
[200]	valid\_0's rmse: 1.67623
[300]	valid\_0's rmse: 1.67747
Early stopping, best iteration is:
[219]	valid\_0's rmse: 1.67594
1.6980899056848198
totals\_pageviews   92
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67885
[200]	valid\_0's rmse: 1.67721
[300]	valid\_0's rmse: 1.67782
Early stopping, best iteration is:
[237]	valid\_0's rmse: 1.67707
1.6991478406224572
totals\_pageviews   93
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67825
[200]	valid\_0's rmse: 1.67648
Early stopping, best iteration is:
[171]	valid\_0's rmse: 1.67606
1.698833559609511
totals\_pageviews   94
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67811
[200]	valid\_0's rmse: 1.67713
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67711
1.6989955681925042
totals\_pageviews   95
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67817
[200]	valid\_0's rmse: 1.67671
[300]	valid\_0's rmse: 1.67799
Early stopping, best iteration is:
[236]	valid\_0's rmse: 1.67656
1.6977293551534614
totals\_pageviews   96
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67813
[200]	valid\_0's rmse: 1.6771
Early stopping, best iteration is:
[176]	valid\_0's rmse: 1.67675
1.6996978939149423
totals\_pageviews   97
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67825
[200]	valid\_0's rmse: 1.67611
[300]	valid\_0's rmse: 1.67614
Early stopping, best iteration is:
[243]	valid\_0's rmse: 1.67581
1.6977392330160581
totals\_pageviews   98
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67813
[200]	valid\_0's rmse: 1.67428
[300]	valid\_0's rmse: 1.67424
Early stopping, best iteration is:
[253]	valid\_0's rmse: 1.67362
1.6952351630053704
totals\_pageviews   99
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67847
[200]	valid\_0's rmse: 1.67627
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.67603
1.6988394506919486
totals\_hits   0
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63986
[200]	valid\_0's rmse: 1.63785
[300]	valid\_0's rmse: 1.63774
Early stopping, best iteration is:
[225]	valid\_0's rmse: 1.63733
1.6582353222962012
totals\_hits   1
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63948
[200]	valid\_0's rmse: 1.63842
[300]	valid\_0's rmse: 1.63932
Early stopping, best iteration is:
[229]	valid\_0's rmse: 1.63824
1.6583894076283499
totals\_hits   2
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64181
[200]	valid\_0's rmse: 1.642
Early stopping, best iteration is:
[120]	valid\_0's rmse: 1.64081
1.6619544998694948
totals\_hits   3
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64021
[200]	valid\_0's rmse: 1.63921
Early stopping, best iteration is:
[194]	valid\_0's rmse: 1.63915
1.66034614145215
totals\_hits   4
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64043
[200]	valid\_0's rmse: 1.63886
[300]	valid\_0's rmse: 1.63889
Early stopping, best iteration is:
[283]	valid\_0's rmse: 1.63839
1.6587602718406786
totals\_hits   5
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64097
[200]	valid\_0's rmse: 1.63938
[300]	valid\_0's rmse: 1.63932
Early stopping, best iteration is:
[248]	valid\_0's rmse: 1.639
1.6595930532964833
totals\_hits   6
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64129
[200]	valid\_0's rmse: 1.64057
[300]	valid\_0's rmse: 1.64173
Early stopping, best iteration is:
[219]	valid\_0's rmse: 1.64007
1.660388838261372
totals\_hits   7
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63979
[200]	valid\_0's rmse: 1.6382
[300]	valid\_0's rmse: 1.63806
[400]	valid\_0's rmse: 1.63957
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.63783
1.6585153921649551
totals\_hits   8
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63999
[200]	valid\_0's rmse: 1.63825
Early stopping, best iteration is:
[171]	valid\_0's rmse: 1.6379
1.6590377499838573
totals\_hits   9
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6407
[200]	valid\_0's rmse: 1.63887
Early stopping, best iteration is:
[184]	valid\_0's rmse: 1.63865
1.6599318707494881
totals\_hits   10
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64084
[200]	valid\_0's rmse: 1.63895
Early stopping, best iteration is:
[185]	valid\_0's rmse: 1.63894
1.6595181781486041
totals\_hits   11
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64099
[200]	valid\_0's rmse: 1.63988
Early stopping, best iteration is:
[189]	valid\_0's rmse: 1.63946
1.660870242925919
totals\_hits   12
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64096
[200]	valid\_0's rmse: 1.63887
[300]	valid\_0's rmse: 1.64003
Early stopping, best iteration is:
[220]	valid\_0's rmse: 1.63869
1.658984656391649
totals\_hits   13
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6405
[200]	valid\_0's rmse: 1.63965
[300]	valid\_0's rmse: 1.64045
Early stopping, best iteration is:
[215]	valid\_0's rmse: 1.6394
1.6592105498967114
totals\_hits   14
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63926
[200]	valid\_0's rmse: 1.63866
[300]	valid\_0's rmse: 1.63892
Early stopping, best iteration is:
[207]	valid\_0's rmse: 1.63856
1.6597397066026585
totals\_hits   15
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64192
[200]	valid\_0's rmse: 1.6399
Early stopping, best iteration is:
[185]	valid\_0's rmse: 1.63965
1.661812352964959
totals\_hits   16
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6403
[200]	valid\_0's rmse: 1.6387
[300]	valid\_0's rmse: 1.63894
Early stopping, best iteration is:
[253]	valid\_0's rmse: 1.63852
1.6590060026678668
totals\_hits   17
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64023
[200]	valid\_0's rmse: 1.63935
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.63924
1.659904927340771
totals\_hits   18
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64171
[200]	valid\_0's rmse: 1.64134
Early stopping, best iteration is:
[162]	valid\_0's rmse: 1.64074
1.6611659755603134
totals\_hits   19
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64005
[200]	valid\_0's rmse: 1.63837
[300]	valid\_0's rmse: 1.63796
Early stopping, best iteration is:
[244]	valid\_0's rmse: 1.63784
1.6582029163282652
totals\_hits   20
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64062
[200]	valid\_0's rmse: 1.63824
[300]	valid\_0's rmse: 1.63923
Early stopping, best iteration is:
[241]	valid\_0's rmse: 1.63782
1.65934300165291
totals\_hits   21
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64064
[200]	valid\_0's rmse: 1.63859
Early stopping, best iteration is:
[182]	valid\_0's rmse: 1.63844
1.659906906217879
totals\_hits   22
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64043
[200]	valid\_0's rmse: 1.63937
[300]	valid\_0's rmse: 1.64002
Early stopping, best iteration is:
[245]	valid\_0's rmse: 1.63925
1.659698884509927
totals\_hits   23
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63977
[200]	valid\_0's rmse: 1.63898
Early stopping, best iteration is:
[160]	valid\_0's rmse: 1.6384
1.659868535723483
totals\_hits   24
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64072
[200]	valid\_0's rmse: 1.63893
[300]	valid\_0's rmse: 1.6396
Early stopping, best iteration is:
[230]	valid\_0's rmse: 1.63838
1.6585598512518462
totals\_hits   25
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64016
[200]	valid\_0's rmse: 1.63848
Early stopping, best iteration is:
[160]	valid\_0's rmse: 1.63816
1.6599689936105069
totals\_hits   26
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6406
[200]	valid\_0's rmse: 1.63879
[300]	valid\_0's rmse: 1.63909
Early stopping, best iteration is:
[248]	valid\_0's rmse: 1.63846
1.659130611121912
totals\_hits   27
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64116
[200]	valid\_0's rmse: 1.64053
Early stopping, best iteration is:
[125]	valid\_0's rmse: 1.63947
1.6615889253915692
totals\_hits   28
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6396
[200]	valid\_0's rmse: 1.63915
Early stopping, best iteration is:
[160]	valid\_0's rmse: 1.63892
1.6596942019419731
totals\_hits   29
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64012
[200]	valid\_0's rmse: 1.63813
[300]	valid\_0's rmse: 1.63876
Early stopping, best iteration is:
[236]	valid\_0's rmse: 1.63732
1.6575108990993972
totals\_hits   30
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63956
[200]	valid\_0's rmse: 1.63853
Early stopping, best iteration is:
[161]	valid\_0's rmse: 1.63767
1.6592367591666004
totals\_hits   31
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63942
[200]	valid\_0's rmse: 1.63739
Early stopping, best iteration is:
[188]	valid\_0's rmse: 1.637
1.657290968490113
totals\_hits   32
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64039
[200]	valid\_0's rmse: 1.63752
[300]	valid\_0's rmse: 1.6383
Early stopping, best iteration is:
[248]	valid\_0's rmse: 1.63733
1.6576921039335935
totals\_hits   33
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64035
[200]	valid\_0's rmse: 1.63779
Early stopping, best iteration is:
[188]	valid\_0's rmse: 1.63741
1.6585591731204494
totals\_hits   34
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63978
[200]	valid\_0's rmse: 1.6392
[300]	valid\_0's rmse: 1.64033
Early stopping, best iteration is:
[216]	valid\_0's rmse: 1.63861
1.6598853883374085
totals\_hits   35
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64048
[200]	valid\_0's rmse: 1.63857
[300]	valid\_0's rmse: 1.6395
Early stopping, best iteration is:
[207]	valid\_0's rmse: 1.63834
1.658699414427171
totals\_hits   36
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64023
[200]	valid\_0's rmse: 1.63872
Early stopping, best iteration is:
[173]	valid\_0's rmse: 1.6384
1.6594895913454202
totals\_hits   37
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6404
[200]	valid\_0's rmse: 1.6399
Early stopping, best iteration is:
[181]	valid\_0's rmse: 1.63928
1.659802987855421
totals\_hits   38
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64049
[200]	valid\_0's rmse: 1.63846
Early stopping, best iteration is:
[168]	valid\_0's rmse: 1.63828
1.6594732849109828
totals\_hits   39
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64013
[200]	valid\_0's rmse: 1.63841
Early stopping, best iteration is:
[171]	valid\_0's rmse: 1.63826
1.6599870296766979
totals\_hits   40
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63966
[200]	valid\_0's rmse: 1.63834
Early stopping, best iteration is:
[199]	valid\_0's rmse: 1.63827
1.6595573148447225
totals\_hits   41
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63978
[200]	valid\_0's rmse: 1.63923
[300]	valid\_0's rmse: 1.64004
Early stopping, best iteration is:
[232]	valid\_0's rmse: 1.63862
1.6589730832518532
totals\_hits   42
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64064
[200]	valid\_0's rmse: 1.63904
Early stopping, best iteration is:
[175]	valid\_0's rmse: 1.63895
1.660012934936168
totals\_hits   43
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64063
[200]	valid\_0's rmse: 1.63913
[300]	valid\_0's rmse: 1.63974
Early stopping, best iteration is:
[239]	valid\_0's rmse: 1.63896
1.6595468272157938
totals\_hits   44
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64046
[200]	valid\_0's rmse: 1.63837
[300]	valid\_0's rmse: 1.6384
Early stopping, best iteration is:
[208]	valid\_0's rmse: 1.63802
1.658478732294756
totals\_hits   45
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64025
[200]	valid\_0's rmse: 1.63967
Early stopping, best iteration is:
[182]	valid\_0's rmse: 1.6393
1.6608230729706455
totals\_hits   46
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64073
[200]	valid\_0's rmse: 1.6389
[300]	valid\_0's rmse: 1.64018
Early stopping, best iteration is:
[200]	valid\_0's rmse: 1.6389
1.65929909146957
totals\_hits   47
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64122
[200]	valid\_0's rmse: 1.63988
Early stopping, best iteration is:
[171]	valid\_0's rmse: 1.63929
1.6600451008292207
totals\_hits   48
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64032
[200]	valid\_0's rmse: 1.63899
Early stopping, best iteration is:
[161]	valid\_0's rmse: 1.63865
1.6606809898533421
totals\_hits   49
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64107
[200]	valid\_0's rmse: 1.63937
[300]	valid\_0's rmse: 1.64092
Early stopping, best iteration is:
[202]	valid\_0's rmse: 1.63916
1.6595973882856245
totals\_hits   50
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64073
[200]	valid\_0's rmse: 1.63843
[300]	valid\_0's rmse: 1.6392
Early stopping, best iteration is:
[236]	valid\_0's rmse: 1.63801
1.6581643485393738
totals\_hits   51
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63985
[200]	valid\_0's rmse: 1.63797
[300]	valid\_0's rmse: 1.63828
Early stopping, best iteration is:
[212]	valid\_0's rmse: 1.63769
1.6586716875255805
totals\_hits   52
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63978
[200]	valid\_0's rmse: 1.63835
[300]	valid\_0's rmse: 1.63926
Early stopping, best iteration is:
[201]	valid\_0's rmse: 1.63831
1.6588817299432317
totals\_hits   53
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63941
[200]	valid\_0's rmse: 1.63799
Early stopping, best iteration is:
[188]	valid\_0's rmse: 1.63765
1.6580359650758252
totals\_hits   54
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64016
[200]	valid\_0's rmse: 1.63875
[300]	valid\_0's rmse: 1.64046
Early stopping, best iteration is:
[225]	valid\_0's rmse: 1.63849
1.65846016209701
totals\_hits   55
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64099
[200]	valid\_0's rmse: 1.63878
[300]	valid\_0's rmse: 1.63887
Early stopping, best iteration is:
[207]	valid\_0's rmse: 1.63851
1.6595624065282795
totals\_hits   56
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63947
[200]	valid\_0's rmse: 1.63754
[300]	valid\_0's rmse: 1.63921
Early stopping, best iteration is:
[207]	valid\_0's rmse: 1.63751
1.6588198128730933
totals\_hits   57
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64065
[200]	valid\_0's rmse: 1.63991
Early stopping, best iteration is:
[188]	valid\_0's rmse: 1.63966
1.6605851208308642
totals\_hits   58
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64049
[200]	valid\_0's rmse: 1.63916
[300]	valid\_0's rmse: 1.6395
Early stopping, best iteration is:
[226]	valid\_0's rmse: 1.63888
1.6589991697140851
totals\_hits   59
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64012
[200]	valid\_0's rmse: 1.63877
[300]	valid\_0's rmse: 1.63858
[400]	valid\_0's rmse: 1.64015
Early stopping, best iteration is:
[322]	valid\_0's rmse: 1.63843
1.6583776280502802
totals\_hits   60
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64058
[200]	valid\_0's rmse: 1.63938
Early stopping, best iteration is:
[178]	valid\_0's rmse: 1.63898
1.6605375245387726
totals\_hits   61
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63998
[200]	valid\_0's rmse: 1.63903
Early stopping, best iteration is:
[166]	valid\_0's rmse: 1.63862
1.6597776128047281
totals\_hits   62
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64023
[200]	valid\_0's rmse: 1.63856
[300]	valid\_0's rmse: 1.63931
Early stopping, best iteration is:
[229]	valid\_0's rmse: 1.63844
1.6600346052491821
totals\_hits   63
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6402
[200]	valid\_0's rmse: 1.63781
[300]	valid\_0's rmse: 1.63764
Early stopping, best iteration is:
[255]	valid\_0's rmse: 1.63716
1.6585508508890907
totals\_hits   64
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64025
[200]	valid\_0's rmse: 1.63774
[300]	valid\_0's rmse: 1.63868
Early stopping, best iteration is:
[203]	valid\_0's rmse: 1.63756
1.6584878201548257
totals\_hits   65
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64087
[200]	valid\_0's rmse: 1.63913
[300]	valid\_0's rmse: 1.63999
Early stopping, best iteration is:
[235]	valid\_0's rmse: 1.63888
1.65912509660924
totals\_hits   66
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6399
[200]	valid\_0's rmse: 1.63768
Early stopping, best iteration is:
[190]	valid\_0's rmse: 1.6374
1.6582439176495647
totals\_hits   67
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63995
[200]	valid\_0's rmse: 1.63813
Early stopping, best iteration is:
[188]	valid\_0's rmse: 1.63776
1.6587983075753423
totals\_hits   68
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63971
[200]	valid\_0's rmse: 1.63849
Early stopping, best iteration is:
[168]	valid\_0's rmse: 1.63804
1.6597491170464316
totals\_hits   69
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64079
[200]	valid\_0's rmse: 1.63904
[300]	valid\_0's rmse: 1.63978
Early stopping, best iteration is:
[245]	valid\_0's rmse: 1.6386
1.6593769978140915
totals\_hits   70
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64124
[200]	valid\_0's rmse: 1.64004
Early stopping, best iteration is:
[160]	valid\_0's rmse: 1.6397
1.6615424091117235
totals\_hits   71
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64037
[200]	valid\_0's rmse: 1.63853
[300]	valid\_0's rmse: 1.63957
Early stopping, best iteration is:
[226]	valid\_0's rmse: 1.63843
1.6587229801975962
totals\_hits   72
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63957
[200]	valid\_0's rmse: 1.6384
[300]	valid\_0's rmse: 1.64003
Early stopping, best iteration is:
[244]	valid\_0's rmse: 1.63817
1.658847750576032
totals\_hits   73
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64101
[200]	valid\_0's rmse: 1.63983
Early stopping, best iteration is:
[169]	valid\_0's rmse: 1.63932
1.6606231918339396
totals\_hits   74
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64169
[200]	valid\_0's rmse: 1.64027
[300]	valid\_0's rmse: 1.64085
Early stopping, best iteration is:
[235]	valid\_0's rmse: 1.64006
1.6605065519235371
totals\_hits   75
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63997
[200]	valid\_0's rmse: 1.63841
[300]	valid\_0's rmse: 1.63871
Early stopping, best iteration is:
[223]	valid\_0's rmse: 1.63832
1.6584834415106686
totals\_hits   76
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63988
[200]	valid\_0's rmse: 1.6379
[300]	valid\_0's rmse: 1.63867
Early stopping, best iteration is:
[224]	valid\_0's rmse: 1.63749
1.6583288927900486
totals\_hits   77
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64018
[200]	valid\_0's rmse: 1.63834
[300]	valid\_0's rmse: 1.63829
Early stopping, best iteration is:
[271]	valid\_0's rmse: 1.63818
1.658831060245553
totals\_hits   78
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64007
[200]	valid\_0's rmse: 1.63902
[300]	valid\_0's rmse: 1.64006
Early stopping, best iteration is:
[210]	valid\_0's rmse: 1.63865
1.658983712589785
totals\_hits   79
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63989
[200]	valid\_0's rmse: 1.63833
Early stopping, best iteration is:
[193]	valid\_0's rmse: 1.63822
1.6585080969442176
totals\_hits   80
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63974
[200]	valid\_0's rmse: 1.63844
[300]	valid\_0's rmse: 1.63984
Early stopping, best iteration is:
[204]	valid\_0's rmse: 1.63822
1.6589606063641442
totals\_hits   81
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64062
[200]	valid\_0's rmse: 1.6385
Early stopping, best iteration is:
[170]	valid\_0's rmse: 1.63843
1.6591198634916284
totals\_hits   82
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64072
[200]	valid\_0's rmse: 1.63982
Early stopping, best iteration is:
[160]	valid\_0's rmse: 1.63927
1.6612351104949696
totals\_hits   83
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63992
[200]	valid\_0's rmse: 1.63873
Early stopping, best iteration is:
[192]	valid\_0's rmse: 1.63843
1.6589199875183422
totals\_hits   84
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63984
[200]	valid\_0's rmse: 1.63868
Early stopping, best iteration is:
[182]	valid\_0's rmse: 1.63831
1.6597962340615726
totals\_hits   85
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64145
[200]	valid\_0's rmse: 1.63923
Early stopping, best iteration is:
[194]	valid\_0's rmse: 1.63905
1.6596607072956215
totals\_hits   86
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64027
[200]	valid\_0's rmse: 1.6389
[300]	valid\_0's rmse: 1.63999
Early stopping, best iteration is:
[232]	valid\_0's rmse: 1.63847
1.6589370141875712
totals\_hits   87
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64041
[200]	valid\_0's rmse: 1.63876
Early stopping, best iteration is:
[186]	valid\_0's rmse: 1.63832
1.6589215373779809
totals\_hits   88
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64072
[200]	valid\_0's rmse: 1.63954
Early stopping, best iteration is:
[167]	valid\_0's rmse: 1.63908
1.6604544123942913
totals\_hits   89
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63945
[200]	valid\_0's rmse: 1.63723
[300]	valid\_0's rmse: 1.63817
Early stopping, best iteration is:
[228]	valid\_0's rmse: 1.63715
1.6575302223039827
totals\_hits   90
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64061
[200]	valid\_0's rmse: 1.63902
[300]	valid\_0's rmse: 1.63929
Early stopping, best iteration is:
[207]	valid\_0's rmse: 1.63884
1.6601724817014865
totals\_hits   91
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6405
[200]	valid\_0's rmse: 1.63888
[300]	valid\_0's rmse: 1.63902
Early stopping, best iteration is:
[272]	valid\_0's rmse: 1.63838
1.6585653309872153
totals\_hits   92
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63992
[200]	valid\_0's rmse: 1.63858
Early stopping, best iteration is:
[178]	valid\_0's rmse: 1.63807
1.6597288489080662
totals\_hits   93
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64058
[200]	valid\_0's rmse: 1.63972
Early stopping, best iteration is:
[166]	valid\_0's rmse: 1.63896
1.6606794240222926
totals\_hits   94
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63987
[200]	valid\_0's rmse: 1.63864
Early stopping, best iteration is:
[161]	valid\_0's rmse: 1.63844
1.6596932946517198
totals\_hits   95
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6408
[200]	valid\_0's rmse: 1.63976
Early stopping, best iteration is:
[168]	valid\_0's rmse: 1.63907
1.6599840526791012
totals\_hits   96
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63956
[200]	valid\_0's rmse: 1.6374
[300]	valid\_0's rmse: 1.63811
Early stopping, best iteration is:
[201]	valid\_0's rmse: 1.63712
1.658005726164206
totals\_hits   97
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64066
[200]	valid\_0's rmse: 1.63902
[300]	valid\_0's rmse: 1.63909
Early stopping, best iteration is:
[283]	valid\_0's rmse: 1.63867
1.658744402956583
totals\_hits   98
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64051
[200]	valid\_0's rmse: 1.63957
Early stopping, best iteration is:
[160]	valid\_0's rmse: 1.63893
1.659673862280382
totals\_hits   99
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63921
[200]	valid\_0's rmse: 1.63718
[300]	valid\_0's rmse: 1.63775
Early stopping, best iteration is:
[203]	valid\_0's rmse: 1.63675
1.6568955616928889
trafficSource\_campaign   0
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61514
[200]	valid\_0's rmse: 1.60819
[300]	valid\_0's rmse: 1.60697
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60688
1.6293299730406916
trafficSource\_campaign   1
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61383
[200]	valid\_0's rmse: 1.60727
[300]	valid\_0's rmse: 1.60558
Early stopping, best iteration is:
[293]	valid\_0's rmse: 1.60508
1.6274928015844519
trafficSource\_campaign   2
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61357
[200]	valid\_0's rmse: 1.6066
[300]	valid\_0's rmse: 1.60409
[400]	valid\_0's rmse: 1.60577
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60388
1.6261061961177277
trafficSource\_campaign   3
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6149
[200]	valid\_0's rmse: 1.60798
[300]	valid\_0's rmse: 1.60662
Early stopping, best iteration is:
[257]	valid\_0's rmse: 1.60606
1.6284821223055068
trafficSource\_campaign   4
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61515
[200]	valid\_0's rmse: 1.61012
[300]	valid\_0's rmse: 1.60716
[400]	valid\_0's rmse: 1.60898
Early stopping, best iteration is:
[317]	valid\_0's rmse: 1.60681
1.6285539549971366
trafficSource\_campaign   5
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61619
[200]	valid\_0's rmse: 1.60844
[300]	valid\_0's rmse: 1.60679
[400]	valid\_0's rmse: 1.60796
Early stopping, best iteration is:
[309]	valid\_0's rmse: 1.60643
1.627686596037699
trafficSource\_campaign   6
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61624
[200]	valid\_0's rmse: 1.60797
[300]	valid\_0's rmse: 1.60697
Early stopping, best iteration is:
[235]	valid\_0's rmse: 1.60662
1.6288032877124292
trafficSource\_campaign   7
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61568
[200]	valid\_0's rmse: 1.60842
[300]	valid\_0's rmse: 1.60657
Early stopping, best iteration is:
[263]	valid\_0's rmse: 1.60642
1.628748404142735
trafficSource\_campaign   8
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61407
[200]	valid\_0's rmse: 1.60741
[300]	valid\_0's rmse: 1.60598
Early stopping, best iteration is:
[287]	valid\_0's rmse: 1.60587
1.6274038110191933
trafficSource\_campaign   9
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61443
[200]	valid\_0's rmse: 1.60604
[300]	valid\_0's rmse: 1.60498
[400]	valid\_0's rmse: 1.60606
Early stopping, best iteration is:
[341]	valid\_0's rmse: 1.60463
1.625871696370572
trafficSource\_campaign   10
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61512
[200]	valid\_0's rmse: 1.60776
[300]	valid\_0's rmse: 1.60618
Early stopping, best iteration is:
[285]	valid\_0's rmse: 1.60605
1.627540331711749
trafficSource\_campaign   11
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61349
[200]	valid\_0's rmse: 1.60559
[300]	valid\_0's rmse: 1.60468
Early stopping, best iteration is:
[273]	valid\_0's rmse: 1.60463
1.6270528329724074
trafficSource\_campaign   12
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61408
[200]	valid\_0's rmse: 1.60841
[300]	valid\_0's rmse: 1.60722
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.60703
1.6290375583460306
trafficSource\_campaign   13
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61666
[200]	valid\_0's rmse: 1.60907
[300]	valid\_0's rmse: 1.60622
Early stopping, best iteration is:
[287]	valid\_0's rmse: 1.60612
1.6281904802929166
trafficSource\_campaign   14
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61682
[200]	valid\_0's rmse: 1.61077
[300]	valid\_0's rmse: 1.60786
[400]	valid\_0's rmse: 1.60832
Early stopping, best iteration is:
[332]	valid\_0's rmse: 1.60759
1.6298293912935455
trafficSource\_campaign   15
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61511
[200]	valid\_0's rmse: 1.60783
[300]	valid\_0's rmse: 1.60534
[400]	valid\_0's rmse: 1.60575
Early stopping, best iteration is:
[378]	valid\_0's rmse: 1.60521
1.626545113969588
trafficSource\_campaign   16
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61405
[200]	valid\_0's rmse: 1.60715
[300]	valid\_0's rmse: 1.60647
[400]	valid\_0's rmse: 1.60685
Early stopping, best iteration is:
[334]	valid\_0's rmse: 1.60588
1.627502447457238
trafficSource\_campaign   17
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61471
[200]	valid\_0's rmse: 1.60751
[300]	valid\_0's rmse: 1.60642
[400]	valid\_0's rmse: 1.60626
Early stopping, best iteration is:
[365]	valid\_0's rmse: 1.60595
1.6280312310295635
trafficSource\_campaign   18
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61392
[200]	valid\_0's rmse: 1.60862
[300]	valid\_0's rmse: 1.60653
[400]	valid\_0's rmse: 1.60737
Early stopping, best iteration is:
[322]	valid\_0's rmse: 1.60623
1.6279910841032859
trafficSource\_campaign   19
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61492
[200]	valid\_0's rmse: 1.60809
[300]	valid\_0's rmse: 1.6059
[400]	valid\_0's rmse: 1.60713
Early stopping, best iteration is:
[312]	valid\_0's rmse: 1.60576
1.6288649404546194
trafficSource\_campaign   20
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61424
[200]	valid\_0's rmse: 1.60772
[300]	valid\_0's rmse: 1.60512
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60496
1.6275759396392828
trafficSource\_campaign   21
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61506
[200]	valid\_0's rmse: 1.60831
[300]	valid\_0's rmse: 1.60581
[400]	valid\_0's rmse: 1.60704
Early stopping, best iteration is:
[312]	valid\_0's rmse: 1.6055
1.6271605366267894
trafficSource\_campaign   22
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6158
[200]	valid\_0's rmse: 1.60796
[300]	valid\_0's rmse: 1.60673
Early stopping, best iteration is:
[274]	valid\_0's rmse: 1.60643
1.6282130804534722
trafficSource\_campaign   23
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61626
[200]	valid\_0's rmse: 1.60874
[300]	valid\_0's rmse: 1.60716
[400]	valid\_0's rmse: 1.60744
Early stopping, best iteration is:
[358]	valid\_0's rmse: 1.60677
1.6286942557877166
trafficSource\_campaign   24
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61548
[200]	valid\_0's rmse: 1.60945
[300]	valid\_0's rmse: 1.60668
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60664
1.6285228151853717
trafficSource\_campaign   25
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61462
[200]	valid\_0's rmse: 1.60791
[300]	valid\_0's rmse: 1.60574
[400]	valid\_0's rmse: 1.60648
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.6056
1.6276058062674237
trafficSource\_campaign   26
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61432
[200]	valid\_0's rmse: 1.60623
[300]	valid\_0's rmse: 1.60579
[400]	valid\_0's rmse: 1.60655
Early stopping, best iteration is:
[326]	valid\_0's rmse: 1.60547
1.6276444643386405
trafficSource\_campaign   27
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61555
[200]	valid\_0's rmse: 1.60663
[300]	valid\_0's rmse: 1.60524
[400]	valid\_0's rmse: 1.60642
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60503
1.6273835666562568
trafficSource\_campaign   28
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61524
[200]	valid\_0's rmse: 1.60783
[300]	valid\_0's rmse: 1.60592
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60578
1.6274926086080983
trafficSource\_campaign   29
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61539
[200]	valid\_0's rmse: 1.60747
[300]	valid\_0's rmse: 1.606
Early stopping, best iteration is:
[298]	valid\_0's rmse: 1.60597
1.6272568222854167
trafficSource\_campaign   30
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61425
[200]	valid\_0's rmse: 1.60703
[300]	valid\_0's rmse: 1.60582
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.6055
1.6276118487154545
trafficSource\_campaign   31
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61582
[200]	valid\_0's rmse: 1.6091
[300]	valid\_0's rmse: 1.60778
Early stopping, best iteration is:
[295]	valid\_0's rmse: 1.60767
1.6297754704427685
trafficSource\_campaign   32
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61516
[200]	valid\_0's rmse: 1.60853
[300]	valid\_0's rmse: 1.60682
[400]	valid\_0's rmse: 1.6063
Early stopping, best iteration is:
[367]	valid\_0's rmse: 1.60594
1.6265716580332474
trafficSource\_campaign   33
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61473
[200]	valid\_0's rmse: 1.60809
[300]	valid\_0's rmse: 1.60728
Early stopping, best iteration is:
[286]	valid\_0's rmse: 1.607
1.6290369982658852
trafficSource\_campaign   34
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61386
[200]	valid\_0's rmse: 1.60614
[300]	valid\_0's rmse: 1.60516
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60489
1.626082354558382
trafficSource\_campaign   35
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61519
[200]	valid\_0's rmse: 1.60854
[300]	valid\_0's rmse: 1.6073
[400]	valid\_0's rmse: 1.60799
Early stopping, best iteration is:
[320]	valid\_0's rmse: 1.60689
1.6284941647154951
trafficSource\_campaign   36
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61446
[200]	valid\_0's rmse: 1.60754
[300]	valid\_0's rmse: 1.60646
Early stopping, best iteration is:
[274]	valid\_0's rmse: 1.60601
1.6271342192759097
trafficSource\_campaign   37
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6155
[200]	valid\_0's rmse: 1.6082
[300]	valid\_0's rmse: 1.60646
[400]	valid\_0's rmse: 1.60785
Early stopping, best iteration is:
[327]	valid\_0's rmse: 1.60636
1.6276051047066942
trafficSource\_campaign   38
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61583
[200]	valid\_0's rmse: 1.6078
[300]	valid\_0's rmse: 1.6062
Early stopping, best iteration is:
[268]	valid\_0's rmse: 1.60581
1.6283286382618056
trafficSource\_campaign   39
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6163
[200]	valid\_0's rmse: 1.60854
[300]	valid\_0's rmse: 1.60615
Early stopping, best iteration is:
[289]	valid\_0's rmse: 1.60603
1.6280622670789515
trafficSource\_campaign   40
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61519
[200]	valid\_0's rmse: 1.60684
[300]	valid\_0's rmse: 1.60435
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60434
1.6272541887154752
trafficSource\_campaign   41
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61465
[200]	valid\_0's rmse: 1.60737
[300]	valid\_0's rmse: 1.6044
[400]	valid\_0's rmse: 1.60499
Early stopping, best iteration is:
[335]	valid\_0's rmse: 1.60398
1.6263625610823773
trafficSource\_campaign   42
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61601
[200]	valid\_0's rmse: 1.60744
[300]	valid\_0's rmse: 1.6056
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.6053
1.627441123139131
trafficSource\_campaign   43
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61541
[200]	valid\_0's rmse: 1.60749
[300]	valid\_0's rmse: 1.60519
[400]	valid\_0's rmse: 1.60516
Early stopping, best iteration is:
[342]	valid\_0's rmse: 1.60465
1.6269188979300537
trafficSource\_campaign   44
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61462
[200]	valid\_0's rmse: 1.60776
[300]	valid\_0's rmse: 1.60603
Early stopping, best iteration is:
[295]	valid\_0's rmse: 1.60601
1.6283201503614337
trafficSource\_campaign   45
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61516
[200]	valid\_0's rmse: 1.60811
[300]	valid\_0's rmse: 1.60593
Early stopping, best iteration is:
[293]	valid\_0's rmse: 1.60565
1.6274135103502965
trafficSource\_campaign   46
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61498
[200]	valid\_0's rmse: 1.6067
[300]	valid\_0's rmse: 1.60575
[400]	valid\_0's rmse: 1.60575
Early stopping, best iteration is:
[374]	valid\_0's rmse: 1.60519
1.627397254313126
trafficSource\_campaign   47
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61516
[200]	valid\_0's rmse: 1.60888
[300]	valid\_0's rmse: 1.60734
[400]	valid\_0's rmse: 1.6075
Early stopping, best iteration is:
[314]	valid\_0's rmse: 1.60708
1.6284928677790347
trafficSource\_campaign   48
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61304
[200]	valid\_0's rmse: 1.60701
[300]	valid\_0's rmse: 1.60592
[400]	valid\_0's rmse: 1.60665
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.6058
1.6282338851902927
trafficSource\_campaign   49
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61564
[200]	valid\_0's rmse: 1.60887
[300]	valid\_0's rmse: 1.60708
[400]	valid\_0's rmse: 1.60825
Early stopping, best iteration is:
[306]	valid\_0's rmse: 1.60696
1.6295962229923648
trafficSource\_campaign   50
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61553
[200]	valid\_0's rmse: 1.60703
[300]	valid\_0's rmse: 1.60591
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60567
1.6270753019010908
trafficSource\_campaign   51
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61517
[200]	valid\_0's rmse: 1.60778
[300]	valid\_0's rmse: 1.60572
[400]	valid\_0's rmse: 1.60718
Early stopping, best iteration is:
[301]	valid\_0's rmse: 1.6057
1.6279652831452467
trafficSource\_campaign   52
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61525
[200]	valid\_0's rmse: 1.60834
[300]	valid\_0's rmse: 1.60595
[400]	valid\_0's rmse: 1.6062
Early stopping, best iteration is:
[363]	valid\_0's rmse: 1.6055
1.626504700857237
trafficSource\_campaign   53
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6152
[200]	valid\_0's rmse: 1.60779
[300]	valid\_0's rmse: 1.6071
[400]	valid\_0's rmse: 1.60849
Early stopping, best iteration is:
[322]	valid\_0's rmse: 1.60687
1.6286860233806801
trafficSource\_campaign   54
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6146
[200]	valid\_0's rmse: 1.60729
[300]	valid\_0's rmse: 1.60504
[400]	valid\_0's rmse: 1.60733
Early stopping, best iteration is:
[301]	valid\_0's rmse: 1.60503
1.627031663174588
trafficSource\_campaign   55
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61435
[200]	valid\_0's rmse: 1.60866
[300]	valid\_0's rmse: 1.60686
Early stopping, best iteration is:
[274]	valid\_0's rmse: 1.60665
1.6291218748620868
trafficSource\_campaign   56
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61437
[200]	valid\_0's rmse: 1.6078
[300]	valid\_0's rmse: 1.60537
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60517
1.6279300821259968
trafficSource\_campaign   57
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61562
[200]	valid\_0's rmse: 1.60831
[300]	valid\_0's rmse: 1.60629
[400]	valid\_0's rmse: 1.60779
Early stopping, best iteration is:
[308]	valid\_0's rmse: 1.60617
1.6277694662325628
trafficSource\_campaign   58
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61452
[200]	valid\_0's rmse: 1.60722
[300]	valid\_0's rmse: 1.60545
[400]	valid\_0's rmse: 1.60636
Early stopping, best iteration is:
[312]	valid\_0's rmse: 1.60514
1.6270413340966348
trafficSource\_campaign   59
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61349
[200]	valid\_0's rmse: 1.60621
[300]	valid\_0's rmse: 1.60409
[400]	valid\_0's rmse: 1.60513
Early stopping, best iteration is:
[300]	valid\_0's rmse: 1.60409
1.6259869063958672
trafficSource\_campaign   60
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61706
[200]	valid\_0's rmse: 1.60845
[300]	valid\_0's rmse: 1.60771
Early stopping, best iteration is:
[273]	valid\_0's rmse: 1.60752
1.6285158255581762
trafficSource\_campaign   61
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61522
[200]	valid\_0's rmse: 1.60856
[300]	valid\_0's rmse: 1.60666
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60662
1.6288258730478449
trafficSource\_campaign   62
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61328
[200]	valid\_0's rmse: 1.60726
[300]	valid\_0's rmse: 1.60585
Early stopping, best iteration is:
[294]	valid\_0's rmse: 1.60568
1.6273189793443672
trafficSource\_campaign   63
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61538
[200]	valid\_0's rmse: 1.6086
[300]	valid\_0's rmse: 1.60722
[400]	valid\_0's rmse: 1.60839
Early stopping, best iteration is:
[336]	valid\_0's rmse: 1.60682
1.6280588165489098
trafficSource\_campaign   64
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61354
[200]	valid\_0's rmse: 1.60787
[300]	valid\_0's rmse: 1.60605
Early stopping, best iteration is:
[271]	valid\_0's rmse: 1.60578
1.6277844566995392
trafficSource\_campaign   65
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61453
[200]	valid\_0's rmse: 1.60785
[300]	valid\_0's rmse: 1.60596
[400]	valid\_0's rmse: 1.60663
Early stopping, best iteration is:
[319]	valid\_0's rmse: 1.60562
1.6272692393383523
trafficSource\_campaign   66
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61542
[200]	valid\_0's rmse: 1.6078
[300]	valid\_0's rmse: 1.60683
[400]	valid\_0's rmse: 1.60717
Early stopping, best iteration is:
[342]	valid\_0's rmse: 1.60635
1.6272766022286402
trafficSource\_campaign   67
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61321
[200]	valid\_0's rmse: 1.60569
[300]	valid\_0's rmse: 1.60458
Early stopping, best iteration is:
[294]	valid\_0's rmse: 1.60448
1.6270020255228441
trafficSource\_campaign   68
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61312
[200]	valid\_0's rmse: 1.60545
[300]	valid\_0's rmse: 1.60453
Early stopping, best iteration is:
[284]	valid\_0's rmse: 1.60426
1.6263664394195687
trafficSource\_campaign   69
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61588
[200]	valid\_0's rmse: 1.60904
[300]	valid\_0's rmse: 1.60684
[400]	valid\_0's rmse: 1.60703
Early stopping, best iteration is:
[374]	valid\_0's rmse: 1.60656
1.6275971561392564
trafficSource\_campaign   70
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61566
[200]	valid\_0's rmse: 1.607
[300]	valid\_0's rmse: 1.60541
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60538
1.627514499034561
trafficSource\_campaign   71
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61308
[200]	valid\_0's rmse: 1.6057
[300]	valid\_0's rmse: 1.60445
[400]	valid\_0's rmse: 1.60481
Early stopping, best iteration is:
[317]	valid\_0's rmse: 1.60401
1.6268051747252341
trafficSource\_campaign   72
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61415
[200]	valid\_0's rmse: 1.60643
[300]	valid\_0's rmse: 1.60567
Early stopping, best iteration is:
[287]	valid\_0's rmse: 1.60543
1.6275224290501515
trafficSource\_campaign   73
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61546
[200]	valid\_0's rmse: 1.60888
[300]	valid\_0's rmse: 1.60786
Early stopping, best iteration is:
[286]	valid\_0's rmse: 1.60764
1.6296107750172553
trafficSource\_campaign   74
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61403
[200]	valid\_0's rmse: 1.6064
[300]	valid\_0's rmse: 1.6055
[400]	valid\_0's rmse: 1.60655
Early stopping, best iteration is:
[338]	valid\_0's rmse: 1.60533
1.6271278027386715
trafficSource\_campaign   75
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61415
[200]	valid\_0's rmse: 1.60724
[300]	valid\_0's rmse: 1.60549
[400]	valid\_0's rmse: 1.60702
Early stopping, best iteration is:
[323]	valid\_0's rmse: 1.60537
1.6272148415478505
trafficSource\_campaign   76
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61429
[200]	valid\_0's rmse: 1.6069
[300]	valid\_0's rmse: 1.60681
Early stopping, best iteration is:
[233]	valid\_0's rmse: 1.60606
1.6279052943491614
trafficSource\_campaign   77
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61452
[200]	valid\_0's rmse: 1.60736
[300]	valid\_0's rmse: 1.60639
[400]	valid\_0's rmse: 1.60681
Early stopping, best iteration is:
[318]	valid\_0's rmse: 1.60621
1.6285033949944847
trafficSource\_campaign   78
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61537
[200]	valid\_0's rmse: 1.60853
[300]	valid\_0's rmse: 1.60628
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60622
1.628012166781119
trafficSource\_campaign   79
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61517
[200]	valid\_0's rmse: 1.60802
[300]	valid\_0's rmse: 1.60672
[400]	valid\_0's rmse: 1.60756
Early stopping, best iteration is:
[340]	valid\_0's rmse: 1.60638
1.6280951988719334
trafficSource\_campaign   80
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61557
[200]	valid\_0's rmse: 1.60687
[300]	valid\_0's rmse: 1.60586
Early stopping, best iteration is:
[262]	valid\_0's rmse: 1.60527
1.627032523505746
trafficSource\_campaign   81
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61408
[200]	valid\_0's rmse: 1.60808
[300]	valid\_0's rmse: 1.60551
[400]	valid\_0's rmse: 1.60611
Early stopping, best iteration is:
[357]	valid\_0's rmse: 1.6055
1.6269795417445512
trafficSource\_campaign   82
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61625
[200]	valid\_0's rmse: 1.61023
[300]	valid\_0's rmse: 1.60917
Early stopping, best iteration is:
[299]	valid\_0's rmse: 1.60915
1.6306888323969677
trafficSource\_campaign   83
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61452
[200]	valid\_0's rmse: 1.6071
[300]	valid\_0's rmse: 1.60496
[400]	valid\_0's rmse: 1.60503
Early stopping, best iteration is:
[374]	valid\_0's rmse: 1.60452
1.627024372037277
trafficSource\_campaign   84
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61355
[200]	valid\_0's rmse: 1.60614
[300]	valid\_0's rmse: 1.60468
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60462
1.6270304416216428
trafficSource\_campaign   85
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61463
[200]	valid\_0's rmse: 1.60702
[300]	valid\_0's rmse: 1.60643
[400]	valid\_0's rmse: 1.60711
Early stopping, best iteration is:
[342]	valid\_0's rmse: 1.60607
1.6275629767620927
trafficSource\_campaign   86
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61486
[200]	valid\_0's rmse: 1.60771
[300]	valid\_0's rmse: 1.6068
Early stopping, best iteration is:
[272]	valid\_0's rmse: 1.60643
1.6285367780981315
trafficSource\_campaign   87
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61457
[200]	valid\_0's rmse: 1.60753
[300]	valid\_0's rmse: 1.60656
Early stopping, best iteration is:
[263]	valid\_0's rmse: 1.60629
1.6288885373203872
trafficSource\_campaign   88
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61492
[200]	valid\_0's rmse: 1.60846
[300]	valid\_0's rmse: 1.60748
[400]	valid\_0's rmse: 1.60859
Early stopping, best iteration is:
[318]	valid\_0's rmse: 1.60722
1.6291563852568094
trafficSource\_campaign   89
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61679
[200]	valid\_0's rmse: 1.60906
[300]	valid\_0's rmse: 1.60683
[400]	valid\_0's rmse: 1.60784
Early stopping, best iteration is:
[320]	valid\_0's rmse: 1.60671
1.628890552077398
trafficSource\_campaign   90
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61544
[200]	valid\_0's rmse: 1.60633
[300]	valid\_0's rmse: 1.60491
[400]	valid\_0's rmse: 1.60646
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60482
1.62637672870822
trafficSource\_campaign   91
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61484
[200]	valid\_0's rmse: 1.60831
[300]	valid\_0's rmse: 1.60765
Early stopping, best iteration is:
[268]	valid\_0's rmse: 1.60729
1.629240974823243
trafficSource\_campaign   92
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61378
[200]	valid\_0's rmse: 1.60795
[300]	valid\_0's rmse: 1.60595
[400]	valid\_0's rmse: 1.60752
Early stopping, best iteration is:
[308]	valid\_0's rmse: 1.60576
1.6275483439994345
trafficSource\_campaign   93
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61638
[200]	valid\_0's rmse: 1.60803
[300]	valid\_0's rmse: 1.60715
Early stopping, best iteration is:
[262]	valid\_0's rmse: 1.60668
1.628646219295886
trafficSource\_campaign   94
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61484
[200]	valid\_0's rmse: 1.60779
[300]	valid\_0's rmse: 1.60572
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60568
1.6278451102597529
trafficSource\_campaign   95
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61438
[200]	valid\_0's rmse: 1.60828
[300]	valid\_0's rmse: 1.6076
Early stopping, best iteration is:
[247]	valid\_0's rmse: 1.60747
1.6292056176642296
trafficSource\_campaign   96
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61568
[200]	valid\_0's rmse: 1.60852
[300]	valid\_0's rmse: 1.60686
[400]	valid\_0's rmse: 1.60701
Early stopping, best iteration is:
[359]	valid\_0's rmse: 1.60648
1.6281592551387696
trafficSource\_campaign   97
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61451
[200]	valid\_0's rmse: 1.60738
[300]	valid\_0's rmse: 1.60565
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60556
1.6280951072520131
trafficSource\_campaign   98
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61436
[200]	valid\_0's rmse: 1.60664
[300]	valid\_0's rmse: 1.60526
[400]	valid\_0's rmse: 1.60537
Early stopping, best iteration is:
[344]	valid\_0's rmse: 1.60478
1.627427924667281
trafficSource\_campaign   99
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61671
[200]	valid\_0's rmse: 1.60927
[300]	valid\_0's rmse: 1.60799
Early stopping, best iteration is:
[283]	valid\_0's rmse: 1.60757
1.6297162483934697

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{n+nb}{print} \PY{p}{(}\PY{n}{p\PYZus{}val}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[0.0, 0.79]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{n}{base\PYZus{}rmse} \PY{o}{=} \PY{l+m+mf}{1.6288250113593938}
         \PY{n+nb}{iter} \PY{o}{=} \PY{l+m+mi}{100}
         \PY{n}{p\PYZus{}val} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{}for column\PYZus{}perm in [\PYZdq{}totals\PYZus{}pageviews\PYZdq{}, \PYZdq{}totals\PYZus{}hits\PYZdq{}, \PYZdq{}visitID\PYZdq{}, \PYZdq{}totals\PYZus{}newVisits\PYZdq{}, \PYZdq{}geoNetwork\PYZus{}continent\PYZdq{}, \PYZdq{}trafficSource\PYZus{}campaign\PYZdq{}]:}
         \PY{k}{for} \PY{n}{column\PYZus{}perm} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}pageviews}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}campaign}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
             \PY{n}{ans} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{iter}\PY{p}{)}\PY{p}{:}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{column\PYZus{}perm}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{i}\PY{p}{)}
                 \PY{n}{train\PYZus{}permute} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
                 \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{column\PYZus{}perm}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{permutation}\PY{p}{(}\PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{column\PYZus{}perm}\PY{p}{]}\PY{p}{)}
                 \PY{n}{x}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}
                 \PY{n}{x1} \PY{o}{=} \PY{l+m+mi}{3} \PY{o}{*} \PY{n+nb}{int}\PY{p}{(}\PY{n}{x} \PY{o}{/} \PY{l+m+mi}{4}\PY{p}{)}
         
                 \PY{n}{dev\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{x1}\PY{p}{]}
                 \PY{n}{val\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{x1}\PY{p}{:}\PY{n}{x}\PY{p}{]}
         
                 \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}df}
                 \PY{n}{val\PYZus{}X} \PY{o}{=} \PY{n}{val\PYZus{}df}
         
                 \PY{n}{dev\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
                 \PY{n}{val\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}X}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
                 \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{val\PYZus{}X} \PY{o}{=} \PY{n}{val\PYZus{}X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         
                 \PY{n}{model}\PY{p}{,} \PY{n}{pred\PYZus{}val} \PY{o}{=} \PY{n}{run\PYZus{}lgb\PYZus{}perm}\PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{p}{,} \PY{n}{dev\PYZus{}y}\PY{p}{,} \PY{n}{val\PYZus{}X}\PY{p}{,} \PY{n}{val\PYZus{}y}\PY{p}{)}
                 
                 \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
                 \PY{n}{pred\PYZus{}val}\PY{p}{[}\PY{n}{pred\PYZus{}val}\PY{o}{\PYZlt{}}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{val\PYZus{}pred\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{\PYZcb{}}\PY{p}{)}
                 \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
                 \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{expm1}\PY{p}{(}\PY{n}{pred\PYZus{}val}\PY{p}{)}
                 \PY{n}{val\PYZus{}pred\PYZus{}df} \PY{o}{=} \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                 \PY{n}{ans}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{less\PYZus{}sum} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{i} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{base\PYZus{}rmse} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ans}\PY{p}{)}
             \PY{n}{p\PYZus{}val}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{less\PYZus{}sum}\PY{o}{/}\PY{n+nb}{iter}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
totals\_pageviews   0
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67677
[200]	valid\_0's rmse: 1.67553
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67535
1.6961747323386536
totals\_pageviews   1
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67883
[200]	valid\_0's rmse: 1.6776
Early stopping, best iteration is:
[166]	valid\_0's rmse: 1.67747
1.6998017951878899
totals\_pageviews   2
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67885
[200]	valid\_0's rmse: 1.67673
Early stopping, best iteration is:
[198]	valid\_0's rmse: 1.67672
1.6985315755889436
totals\_pageviews   3
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67829
[200]	valid\_0's rmse: 1.67675
Early stopping, best iteration is:
[174]	valid\_0's rmse: 1.67649
1.6989213615713228
totals\_pageviews   4
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67861
[200]	valid\_0's rmse: 1.6762
[300]	valid\_0's rmse: 1.67754
Early stopping, best iteration is:
[210]	valid\_0's rmse: 1.67617
1.6987711076470178
totals\_pageviews   5
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67894
[200]	valid\_0's rmse: 1.67776
Early stopping, best iteration is:
[156]	valid\_0's rmse: 1.6775
1.7003015533161299
totals\_pageviews   6
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67853
[200]	valid\_0's rmse: 1.67703
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.67674
1.6990624247294837
totals\_pageviews   7
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67905
[200]	valid\_0's rmse: 1.67695
Early stopping, best iteration is:
[196]	valid\_0's rmse: 1.67689
1.6990040319377795
totals\_pageviews   8
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67967
[200]	valid\_0's rmse: 1.67851
[300]	valid\_0's rmse: 1.67767
[400]	valid\_0's rmse: 1.67813
Early stopping, best iteration is:
[378]	valid\_0's rmse: 1.67752
1.698385641231648
totals\_pageviews   9
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67747
[200]	valid\_0's rmse: 1.67538
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.6753
1.6979615662591079
totals\_pageviews   10
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67824
[200]	valid\_0's rmse: 1.67538
Early stopping, best iteration is:
[199]	valid\_0's rmse: 1.67538
1.697282998328556
totals\_pageviews   11
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6782
[200]	valid\_0's rmse: 1.678
Early stopping, best iteration is:
[153]	valid\_0's rmse: 1.67753
1.700026497241635
totals\_pageviews   12
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67873
[200]	valid\_0's rmse: 1.67722
[300]	valid\_0's rmse: 1.67737
Early stopping, best iteration is:
[239]	valid\_0's rmse: 1.67682
1.6974832042942336
totals\_pageviews   13
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.677
[200]	valid\_0's rmse: 1.67563
[300]	valid\_0's rmse: 1.67601
Early stopping, best iteration is:
[223]	valid\_0's rmse: 1.67497
1.6967915341155242
totals\_pageviews   14
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67848
[200]	valid\_0's rmse: 1.67771
Early stopping, best iteration is:
[149]	valid\_0's rmse: 1.67728
1.6997961142919211
totals\_pageviews   15
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67762
[200]	valid\_0's rmse: 1.67702
Early stopping, best iteration is:
[166]	valid\_0's rmse: 1.6768
1.6992620235196665
totals\_pageviews   16
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67854
[200]	valid\_0's rmse: 1.67726
Early stopping, best iteration is:
[159]	valid\_0's rmse: 1.67678
1.699435776482451
totals\_pageviews   17
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67826
[200]	valid\_0's rmse: 1.6765
[300]	valid\_0's rmse: 1.6769
Early stopping, best iteration is:
[249]	valid\_0's rmse: 1.67634
1.6975328072500693
totals\_pageviews   18
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67856
[200]	valid\_0's rmse: 1.67578
Early stopping, best iteration is:
[199]	valid\_0's rmse: 1.67575
1.6978687458684902
totals\_pageviews   19
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6785
[200]	valid\_0's rmse: 1.67765
[300]	valid\_0's rmse: 1.6774
Early stopping, best iteration is:
[274]	valid\_0's rmse: 1.67708
1.6987613816923688
totals\_pageviews   20
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67897
[200]	valid\_0's rmse: 1.67715
[300]	valid\_0's rmse: 1.67837
Early stopping, best iteration is:
[204]	valid\_0's rmse: 1.67709
1.6985168357995675
totals\_pageviews   21
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67851
[200]	valid\_0's rmse: 1.67747
Early stopping, best iteration is:
[162]	valid\_0's rmse: 1.67702
1.6997287820318423
totals\_pageviews   22
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67799
[200]	valid\_0's rmse: 1.67536
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67532
1.6974995386472076
totals\_pageviews   23
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.679
[200]	valid\_0's rmse: 1.67735
Early stopping, best iteration is:
[185]	valid\_0's rmse: 1.67731
1.699618633584893
totals\_pageviews   24
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67733
[200]	valid\_0's rmse: 1.67586
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67573
1.698537722403409
totals\_pageviews   25
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67906
[200]	valid\_0's rmse: 1.67673
[300]	valid\_0's rmse: 1.67652
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.67648
1.6975890060656684
totals\_pageviews   26
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67867
[200]	valid\_0's rmse: 1.67755
Early stopping, best iteration is:
[167]	valid\_0's rmse: 1.67721
1.6995750594798327
totals\_pageviews   27
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6788
[200]	valid\_0's rmse: 1.67589
[300]	valid\_0's rmse: 1.67606
Early stopping, best iteration is:
[282]	valid\_0's rmse: 1.6756
1.696606411031572
totals\_pageviews   28
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67793
[200]	valid\_0's rmse: 1.67626
Early stopping, best iteration is:
[164]	valid\_0's rmse: 1.67596
1.6993955844716044
totals\_pageviews   29
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6779
[200]	valid\_0's rmse: 1.67623
[300]	valid\_0's rmse: 1.67608
Early stopping, best iteration is:
[235]	valid\_0's rmse: 1.67532
1.697053235268341
totals\_pageviews   30
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67906
[200]	valid\_0's rmse: 1.67783
[300]	valid\_0's rmse: 1.67841
Early stopping, best iteration is:
[219]	valid\_0's rmse: 1.67754
1.6997166950834093
totals\_pageviews   31
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67738
[200]	valid\_0's rmse: 1.67618
Early stopping, best iteration is:
[155]	valid\_0's rmse: 1.67579
1.6986218133163375
totals\_pageviews   32
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67753
[200]	valid\_0's rmse: 1.67711
Early stopping, best iteration is:
[125]	valid\_0's rmse: 1.67673
1.7001439667262759
totals\_pageviews   33
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67972
[200]	valid\_0's rmse: 1.67776
[300]	valid\_0's rmse: 1.67872
Early stopping, best iteration is:
[223]	valid\_0's rmse: 1.67752
1.6994829356929628
totals\_pageviews   34
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67927
[200]	valid\_0's rmse: 1.67683
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.67665
1.6988151381823573
totals\_pageviews   35
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6801
[200]	valid\_0's rmse: 1.67767
[300]	valid\_0's rmse: 1.67751
Early stopping, best iteration is:
[246]	valid\_0's rmse: 1.67693
1.6987315980975761
totals\_pageviews   36
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67857
[200]	valid\_0's rmse: 1.67779
Early stopping, best iteration is:
[167]	valid\_0's rmse: 1.67767
1.6999808889825225
totals\_pageviews   37
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6773
[200]	valid\_0's rmse: 1.6752
[300]	valid\_0's rmse: 1.67542
Early stopping, best iteration is:
[224]	valid\_0's rmse: 1.67456
1.6962458174068968
totals\_pageviews   38
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67814
[200]	valid\_0's rmse: 1.67708
[300]	valid\_0's rmse: 1.67745
Early stopping, best iteration is:
[221]	valid\_0's rmse: 1.67643
1.6979966379686358
totals\_pageviews   39
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67788
[200]	valid\_0's rmse: 1.67673
Early stopping, best iteration is:
[185]	valid\_0's rmse: 1.67642
1.6981508700989545
totals\_pageviews   40
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67673
[200]	valid\_0's rmse: 1.67515
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67504
1.697861092159002
totals\_pageviews   41
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67749
[200]	valid\_0's rmse: 1.67672
Early stopping, best iteration is:
[165]	valid\_0's rmse: 1.67613
1.6984285404773802
totals\_pageviews   42
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67838
[200]	valid\_0's rmse: 1.67748
Early stopping, best iteration is:
[184]	valid\_0's rmse: 1.67727
1.6988800992352333
totals\_pageviews   43
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67844
[200]	valid\_0's rmse: 1.67757
Early stopping, best iteration is:
[193]	valid\_0's rmse: 1.67728
1.6993349476496176
totals\_pageviews   44
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67895
[200]	valid\_0's rmse: 1.67647
[300]	valid\_0's rmse: 1.67687
Early stopping, best iteration is:
[202]	valid\_0's rmse: 1.67636
1.6981802434057023
totals\_pageviews   45
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67852
[200]	valid\_0's rmse: 1.67679
[300]	valid\_0's rmse: 1.67594
[400]	valid\_0's rmse: 1.6766
Early stopping, best iteration is:
[360]	valid\_0's rmse: 1.67567
1.6956395958161097
totals\_pageviews   46
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67815
[200]	valid\_0's rmse: 1.67696
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.67661
1.6988623886430025
totals\_pageviews   47
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6771
[200]	valid\_0's rmse: 1.67671
Early stopping, best iteration is:
[148]	valid\_0's rmse: 1.67591
1.6988898037983269
totals\_pageviews   48
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67899
[200]	valid\_0's rmse: 1.67702
[300]	valid\_0's rmse: 1.67636
[400]	valid\_0's rmse: 1.67724
Early stopping, best iteration is:
[318]	valid\_0's rmse: 1.67616
1.6972280352116456
totals\_pageviews   49
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6784
[200]	valid\_0's rmse: 1.67766
Early stopping, best iteration is:
[148]	valid\_0's rmse: 1.67701
1.699519654618632
totals\_pageviews   50
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67913
[200]	valid\_0's rmse: 1.67723
Early stopping, best iteration is:
[167]	valid\_0's rmse: 1.67686
1.6994795640791174
totals\_pageviews   51
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67845
[200]	valid\_0's rmse: 1.67676
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67669
1.6985474019588052
totals\_pageviews   52
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67853
[200]	valid\_0's rmse: 1.67615
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.6761
1.6981550429553376
totals\_pageviews   53
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67795
[200]	valid\_0's rmse: 1.67617
[300]	valid\_0's rmse: 1.67591
Early stopping, best iteration is:
[261]	valid\_0's rmse: 1.67532
1.6971894939688774
totals\_pageviews   54
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67832
[200]	valid\_0's rmse: 1.67648
Early stopping, best iteration is:
[194]	valid\_0's rmse: 1.67642
1.6983285967151167
totals\_pageviews   55
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67907
[200]	valid\_0's rmse: 1.67788
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.67771
1.6990894592753587
totals\_pageviews   56
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67806
[200]	valid\_0's rmse: 1.67575
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67568
1.6980823815397017
totals\_pageviews   57
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6787
[200]	valid\_0's rmse: 1.67632
Early stopping, best iteration is:
[190]	valid\_0's rmse: 1.67617
1.69810356739935
totals\_pageviews   58
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67944
[200]	valid\_0's rmse: 1.67781
[300]	valid\_0's rmse: 1.67715
[400]	valid\_0's rmse: 1.67769
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.67702
1.6975178153690405
totals\_pageviews   59
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67856
[200]	valid\_0's rmse: 1.67633
[300]	valid\_0's rmse: 1.67713
Early stopping, best iteration is:
[205]	valid\_0's rmse: 1.67619
1.6981574204720453
totals\_pageviews   60
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67783
[200]	valid\_0's rmse: 1.67653
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.67643
1.699361368863696
totals\_pageviews   61
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6779
[200]	valid\_0's rmse: 1.67631
[300]	valid\_0's rmse: 1.67692
Early stopping, best iteration is:
[208]	valid\_0's rmse: 1.67597
1.697855951165924
totals\_pageviews   62
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67824
[200]	valid\_0's rmse: 1.67673
[300]	valid\_0's rmse: 1.67767
Early stopping, best iteration is:
[203]	valid\_0's rmse: 1.67665
1.699414388021294
totals\_pageviews   63
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67803
[200]	valid\_0's rmse: 1.67697
[300]	valid\_0's rmse: 1.67783
Early stopping, best iteration is:
[224]	valid\_0's rmse: 1.67661
1.6984577331277215
totals\_pageviews   64
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67906
[200]	valid\_0's rmse: 1.67648
[300]	valid\_0's rmse: 1.6762
Early stopping, best iteration is:
[276]	valid\_0's rmse: 1.67577
1.6968629685275074
totals\_pageviews   65
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67751
[200]	valid\_0's rmse: 1.67471
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67453
1.6962146033825856
totals\_pageviews   66
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6789
[200]	valid\_0's rmse: 1.67809
Early stopping, best iteration is:
[159]	valid\_0's rmse: 1.67733
1.7000473631048691
totals\_pageviews   67
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67802
[200]	valid\_0's rmse: 1.67653
Early stopping, best iteration is:
[190]	valid\_0's rmse: 1.67647
1.6980526376925003
totals\_pageviews   68
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67736
[200]	valid\_0's rmse: 1.67628
Early stopping, best iteration is:
[186]	valid\_0's rmse: 1.67611
1.6991524686056005
totals\_pageviews   69
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67776
[200]	valid\_0's rmse: 1.67652
[300]	valid\_0's rmse: 1.67654
Early stopping, best iteration is:
[249]	valid\_0's rmse: 1.67625
1.6981056259908012
totals\_pageviews   70
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67925
[200]	valid\_0's rmse: 1.67737
[300]	valid\_0's rmse: 1.67832
Early stopping, best iteration is:
[213]	valid\_0's rmse: 1.67705
1.6986511497928274
totals\_pageviews   71
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67839
[200]	valid\_0's rmse: 1.67586
[300]	valid\_0's rmse: 1.67555
[400]	valid\_0's rmse: 1.67615
Early stopping, best iteration is:
[345]	valid\_0's rmse: 1.67519
1.6961861907613274
totals\_pageviews   72
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67761
[200]	valid\_0's rmse: 1.67577
[300]	valid\_0's rmse: 1.6755
[400]	valid\_0's rmse: 1.67627
Early stopping, best iteration is:
[301]	valid\_0's rmse: 1.67548
1.695507426824723
totals\_pageviews   73
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67828
[200]	valid\_0's rmse: 1.67605
[300]	valid\_0's rmse: 1.67656
Early stopping, best iteration is:
[225]	valid\_0's rmse: 1.6757
1.698707397865145
totals\_pageviews   74
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67699
[200]	valid\_0's rmse: 1.67589
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.6758
1.6976823600453548
totals\_pageviews   75
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67916
[200]	valid\_0's rmse: 1.67622
Early stopping, best iteration is:
[196]	valid\_0's rmse: 1.67617
1.698035510182312
totals\_pageviews   76
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67817
[200]	valid\_0's rmse: 1.67721
[300]	valid\_0's rmse: 1.67782
Early stopping, best iteration is:
[268]	valid\_0's rmse: 1.67713
1.6977536633454189
totals\_pageviews   77
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67875
[200]	valid\_0's rmse: 1.67763
Early stopping, best iteration is:
[157]	valid\_0's rmse: 1.67711
1.6999543058328892
totals\_pageviews   78
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67807
[200]	valid\_0's rmse: 1.67703
[300]	valid\_0's rmse: 1.67721
Early stopping, best iteration is:
[249]	valid\_0's rmse: 1.67687
1.698686296756465
totals\_pageviews   79
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67921
[200]	valid\_0's rmse: 1.67799
[300]	valid\_0's rmse: 1.67779
[400]	valid\_0's rmse: 1.67809
Early stopping, best iteration is:
[307]	valid\_0's rmse: 1.67742
1.6992619707447283
totals\_pageviews   80
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67862
[200]	valid\_0's rmse: 1.67837
Early stopping, best iteration is:
[112]	valid\_0's rmse: 1.6782
1.7021134357953225
totals\_pageviews   81
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67838
[200]	valid\_0's rmse: 1.67696
Early stopping, best iteration is:
[150]	valid\_0's rmse: 1.67661
1.699089156570922
totals\_pageviews   82
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67855
[200]	valid\_0's rmse: 1.67673
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67662
1.699002418729685
totals\_pageviews   83
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67803
[200]	valid\_0's rmse: 1.67676
Early stopping, best iteration is:
[170]	valid\_0's rmse: 1.6766
1.698571272083012
totals\_pageviews   84
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67818
[200]	valid\_0's rmse: 1.67713
Early stopping, best iteration is:
[185]	valid\_0's rmse: 1.67699
1.6991892189411375
totals\_pageviews   85
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67826
[200]	valid\_0's rmse: 1.67604
Early stopping, best iteration is:
[170]	valid\_0's rmse: 1.67575
1.698039381552507
totals\_pageviews   86
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67898
[200]	valid\_0's rmse: 1.67652
[300]	valid\_0's rmse: 1.67567
[400]	valid\_0's rmse: 1.67597
Early stopping, best iteration is:
[344]	valid\_0's rmse: 1.67549
1.69623872607879
totals\_pageviews   87
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67909
[200]	valid\_0's rmse: 1.67684
[300]	valid\_0's rmse: 1.6766
Early stopping, best iteration is:
[283]	valid\_0's rmse: 1.67642
1.6975815512983545
totals\_pageviews   88
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67819
[200]	valid\_0's rmse: 1.67638
[300]	valid\_0's rmse: 1.67656
Early stopping, best iteration is:
[249]	valid\_0's rmse: 1.67587
1.6971053108608491
totals\_pageviews   89
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6784
[200]	valid\_0's rmse: 1.67729
Early stopping, best iteration is:
[198]	valid\_0's rmse: 1.67726
1.6989413838571403
totals\_pageviews   90
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6798
[200]	valid\_0's rmse: 1.67718
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.67704
1.6984555422839196
totals\_pageviews   91
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67948
[200]	valid\_0's rmse: 1.67671
[300]	valid\_0's rmse: 1.67728
Early stopping, best iteration is:
[217]	valid\_0's rmse: 1.67632
1.6993649673573785
totals\_pageviews   92
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67759
[200]	valid\_0's rmse: 1.67569
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67569
1.697419937452226
totals\_pageviews   93
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67865
[200]	valid\_0's rmse: 1.67613
Early stopping, best iteration is:
[196]	valid\_0's rmse: 1.67607
1.6990607126086026
totals\_pageviews   94
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67706
[200]	valid\_0's rmse: 1.67522
[300]	valid\_0's rmse: 1.67567
Early stopping, best iteration is:
[203]	valid\_0's rmse: 1.67515
1.6969401414487677
totals\_pageviews   95
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67782
[200]	valid\_0's rmse: 1.67483
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67467
1.6967469417125212
totals\_pageviews   96
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67877
[200]	valid\_0's rmse: 1.67767
Early stopping, best iteration is:
[178]	valid\_0's rmse: 1.67751
1.699842768748927
totals\_pageviews   97
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67783
[200]	valid\_0's rmse: 1.67609
Early stopping, best iteration is:
[194]	valid\_0's rmse: 1.67589
1.6985306763090144
totals\_pageviews   98
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6783
[200]	valid\_0's rmse: 1.67632
Early stopping, best iteration is:
[197]	valid\_0's rmse: 1.67627
1.6978806776373316
totals\_pageviews   99
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.67818
[200]	valid\_0's rmse: 1.67597
[300]	valid\_0's rmse: 1.67601
Early stopping, best iteration is:
[228]	valid\_0's rmse: 1.6756
1.6975263343425417
trafficSource\_campaign   0
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61446
[200]	valid\_0's rmse: 1.60758
[300]	valid\_0's rmse: 1.60468
[400]	valid\_0's rmse: 1.60554
Early stopping, best iteration is:
[321]	valid\_0's rmse: 1.60454
1.6266862621538862
trafficSource\_campaign   1
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61365
[200]	valid\_0's rmse: 1.60785
[300]	valid\_0's rmse: 1.60516
[400]	valid\_0's rmse: 1.60698
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60513
1.6278725154806037
trafficSource\_campaign   2
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61554
[200]	valid\_0's rmse: 1.60759
[300]	valid\_0's rmse: 1.60519
Early stopping, best iteration is:
[299]	valid\_0's rmse: 1.60519
1.6268587048494498
trafficSource\_campaign   3
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61414
[200]	valid\_0's rmse: 1.60652
[300]	valid\_0's rmse: 1.60527
[400]	valid\_0's rmse: 1.60565
[500]	valid\_0's rmse: 1.60705
Early stopping, best iteration is:
[429]	valid\_0's rmse: 1.605
1.6260716946173193
trafficSource\_campaign   4
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61446
[200]	valid\_0's rmse: 1.60759
[300]	valid\_0's rmse: 1.60557
Early stopping, best iteration is:
[292]	valid\_0's rmse: 1.60547
1.6277123866391197
trafficSource\_campaign   5
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61493
[200]	valid\_0's rmse: 1.6097
[300]	valid\_0's rmse: 1.6074
[400]	valid\_0's rmse: 1.60912
Early stopping, best iteration is:
[314]	valid\_0's rmse: 1.6071
1.6286599434974198
trafficSource\_campaign   6
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61467
[200]	valid\_0's rmse: 1.60676
[300]	valid\_0's rmse: 1.60481
[400]	valid\_0's rmse: 1.60654
Early stopping, best iteration is:
[304]	valid\_0's rmse: 1.6047
1.6272897495544627
trafficSource\_campaign   7
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61629
[200]	valid\_0's rmse: 1.60814
[300]	valid\_0's rmse: 1.6071
Early stopping, best iteration is:
[286]	valid\_0's rmse: 1.60675
1.6291648152313438
trafficSource\_campaign   8
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61497
[200]	valid\_0's rmse: 1.60719
[300]	valid\_0's rmse: 1.60527
[400]	valid\_0's rmse: 1.60604
Early stopping, best iteration is:
[335]	valid\_0's rmse: 1.60483
1.6266588870588803
trafficSource\_campaign   9
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61521
[200]	valid\_0's rmse: 1.60836
[300]	valid\_0's rmse: 1.606
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60593
1.6272241645640817
trafficSource\_campaign   10
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61601
[200]	valid\_0's rmse: 1.60883
[300]	valid\_0's rmse: 1.6068
[400]	valid\_0's rmse: 1.60708
Early stopping, best iteration is:
[300]	valid\_0's rmse: 1.6068
1.6292311418348657
trafficSource\_campaign   11
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61396
[200]	valid\_0's rmse: 1.60733
[300]	valid\_0's rmse: 1.60521
[400]	valid\_0's rmse: 1.60685
Early stopping, best iteration is:
[315]	valid\_0's rmse: 1.60476
1.6272610247512886
trafficSource\_campaign   12
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61539
[200]	valid\_0's rmse: 1.60785
[300]	valid\_0's rmse: 1.6061
Early stopping, best iteration is:
[272]	valid\_0's rmse: 1.60569
1.6282802582621028
trafficSource\_campaign   13
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61429
[200]	valid\_0's rmse: 1.609
[300]	valid\_0's rmse: 1.60726
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.60709
1.6295962642561888
trafficSource\_campaign   14
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61456
[200]	valid\_0's rmse: 1.60841
[300]	valid\_0's rmse: 1.60676
Early stopping, best iteration is:
[290]	valid\_0's rmse: 1.60654
1.6285012806126946
trafficSource\_campaign   15
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61432
[200]	valid\_0's rmse: 1.60718
[300]	valid\_0's rmse: 1.60574
[400]	valid\_0's rmse: 1.60749
Early stopping, best iteration is:
[309]	valid\_0's rmse: 1.60568
1.627858514677949
trafficSource\_campaign   16
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61493
[200]	valid\_0's rmse: 1.60791
[300]	valid\_0's rmse: 1.60677
Early stopping, best iteration is:
[299]	valid\_0's rmse: 1.60676
1.6283913948919644
trafficSource\_campaign   17
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61613
[200]	valid\_0's rmse: 1.60905
[300]	valid\_0's rmse: 1.60778
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60758
1.6290325218862347
trafficSource\_campaign   18
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61517
[200]	valid\_0's rmse: 1.60705
[300]	valid\_0's rmse: 1.60553
[400]	valid\_0's rmse: 1.60722
Early stopping, best iteration is:
[301]	valid\_0's rmse: 1.60551
1.6269663314632579
trafficSource\_campaign   19
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61407
[200]	valid\_0's rmse: 1.60725
[300]	valid\_0's rmse: 1.60548
Early stopping, best iteration is:
[266]	valid\_0's rmse: 1.60508
1.6276169434505467
trafficSource\_campaign   20
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61643
[200]	valid\_0's rmse: 1.60885
[300]	valid\_0's rmse: 1.60765
Early stopping, best iteration is:
[293]	valid\_0's rmse: 1.60756
1.6300701264367432
trafficSource\_campaign   21
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61559
[200]	valid\_0's rmse: 1.60685
[300]	valid\_0's rmse: 1.60623
Early stopping, best iteration is:
[269]	valid\_0's rmse: 1.60581
1.6279327532451981
trafficSource\_campaign   22
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61461
[200]	valid\_0's rmse: 1.60745
[300]	valid\_0's rmse: 1.60546
[400]	valid\_0's rmse: 1.60668
Early stopping, best iteration is:
[300]	valid\_0's rmse: 1.60546
1.6285838457345236
trafficSource\_campaign   23
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61622
[200]	valid\_0's rmse: 1.60838
[300]	valid\_0's rmse: 1.60615
[400]	valid\_0's rmse: 1.60652
Early stopping, best iteration is:
[322]	valid\_0's rmse: 1.60603
1.6272288349022945
trafficSource\_campaign   24
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6154
[200]	valid\_0's rmse: 1.60951
[300]	valid\_0's rmse: 1.60755
Early stopping, best iteration is:
[285]	valid\_0's rmse: 1.6072
1.630165499519173
trafficSource\_campaign   25
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6157
[200]	valid\_0's rmse: 1.60772
[300]	valid\_0's rmse: 1.60655
[400]	valid\_0's rmse: 1.6066
Early stopping, best iteration is:
[336]	valid\_0's rmse: 1.60616
1.6279338633738836
trafficSource\_campaign   26
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61467
[200]	valid\_0's rmse: 1.6077
[300]	valid\_0's rmse: 1.60601
[400]	valid\_0's rmse: 1.60699
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60596
1.627761461592214
trafficSource\_campaign   27
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61494
[200]	valid\_0's rmse: 1.6076
[300]	valid\_0's rmse: 1.60584
[400]	valid\_0's rmse: 1.60685
Early stopping, best iteration is:
[322]	valid\_0's rmse: 1.60545
1.6272299287620833
trafficSource\_campaign   28
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6143
[200]	valid\_0's rmse: 1.60759
[300]	valid\_0's rmse: 1.60718
[400]	valid\_0's rmse: 1.60753
Early stopping, best iteration is:
[327]	valid\_0's rmse: 1.60691
1.6282488813467566
trafficSource\_campaign   29
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61332
[200]	valid\_0's rmse: 1.60773
[300]	valid\_0's rmse: 1.6064
Early stopping, best iteration is:
[274]	valid\_0's rmse: 1.60622
1.6285117893284697
trafficSource\_campaign   30
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6147
[200]	valid\_0's rmse: 1.60698
[300]	valid\_0's rmse: 1.60573
Early stopping, best iteration is:
[286]	valid\_0's rmse: 1.60531
1.6268866860164783
trafficSource\_campaign   31
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61585
[200]	valid\_0's rmse: 1.60855
[300]	valid\_0's rmse: 1.60774
[400]	valid\_0's rmse: 1.60882
Early stopping, best iteration is:
[314]	valid\_0's rmse: 1.60736
1.629845423275689
trafficSource\_campaign   32
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61592
[200]	valid\_0's rmse: 1.60725
[300]	valid\_0's rmse: 1.60518
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60515
1.6273277569257727
trafficSource\_campaign   33
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61575
[200]	valid\_0's rmse: 1.60852
[300]	valid\_0's rmse: 1.60588
[400]	valid\_0's rmse: 1.60595
Early stopping, best iteration is:
[395]	valid\_0's rmse: 1.60574
1.6270775900148058
trafficSource\_campaign   34
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61413
[200]	valid\_0's rmse: 1.60676
[300]	valid\_0's rmse: 1.60588
Early stopping, best iteration is:
[226]	valid\_0's rmse: 1.60548
1.6280096505985866
trafficSource\_campaign   35
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61432
[200]	valid\_0's rmse: 1.6086
[300]	valid\_0's rmse: 1.60744
Early stopping, best iteration is:
[269]	valid\_0's rmse: 1.60693
1.6282943649203059
trafficSource\_campaign   36
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61496
[200]	valid\_0's rmse: 1.6076
[300]	valid\_0's rmse: 1.60654
[400]	valid\_0's rmse: 1.60692
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60633
1.6280355675016254
trafficSource\_campaign   37
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61449
[200]	valid\_0's rmse: 1.60669
[300]	valid\_0's rmse: 1.60632
Early stopping, best iteration is:
[285]	valid\_0's rmse: 1.60579
1.6284642113218175
trafficSource\_campaign   38
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61529
[200]	valid\_0's rmse: 1.60752
[300]	valid\_0's rmse: 1.6044
[400]	valid\_0's rmse: 1.60545
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60415
1.62633640689187
trafficSource\_campaign   39
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61463
[200]	valid\_0's rmse: 1.60775
[300]	valid\_0's rmse: 1.60513
[400]	valid\_0's rmse: 1.60604
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60504
1.6262093126968773
trafficSource\_campaign   40
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6139
[200]	valid\_0's rmse: 1.60709
[300]	valid\_0's rmse: 1.60535
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60516
1.6266651237011602
trafficSource\_campaign   41
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61483
[200]	valid\_0's rmse: 1.60708
[300]	valid\_0's rmse: 1.60537
[400]	valid\_0's rmse: 1.60628
Early stopping, best iteration is:
[308]	valid\_0's rmse: 1.60503
1.6271970910947473
trafficSource\_campaign   42
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61613
[200]	valid\_0's rmse: 1.60826
[300]	valid\_0's rmse: 1.60687
[400]	valid\_0's rmse: 1.60802
Early stopping, best iteration is:
[301]	valid\_0's rmse: 1.60685
1.6277932378549413
trafficSource\_campaign   43
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61425
[200]	valid\_0's rmse: 1.60753
[300]	valid\_0's rmse: 1.60654
[400]	valid\_0's rmse: 1.60684
Early stopping, best iteration is:
[305]	valid\_0's rmse: 1.60636
1.6290204085318536
trafficSource\_campaign   44
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61535
[200]	valid\_0's rmse: 1.6088
[300]	valid\_0's rmse: 1.6076
[400]	valid\_0's rmse: 1.60868
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60738
1.6298374376421363
trafficSource\_campaign   45
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61425
[200]	valid\_0's rmse: 1.60788
[300]	valid\_0's rmse: 1.60774
Early stopping, best iteration is:
[267]	valid\_0's rmse: 1.60732
1.6286998004941948
trafficSource\_campaign   46
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61427
[200]	valid\_0's rmse: 1.6083
[300]	valid\_0's rmse: 1.60758
[400]	valid\_0's rmse: 1.60888
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60738
1.6300363173741736
trafficSource\_campaign   47
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61588
[200]	valid\_0's rmse: 1.60792
[300]	valid\_0's rmse: 1.60548
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60513
1.6273617361992478
trafficSource\_campaign   48
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61376
[200]	valid\_0's rmse: 1.60679
[300]	valid\_0's rmse: 1.60505
Early stopping, best iteration is:
[285]	valid\_0's rmse: 1.60481
1.6271697537048586
trafficSource\_campaign   49
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61479
[200]	valid\_0's rmse: 1.60778
[300]	valid\_0's rmse: 1.60705
Early stopping, best iteration is:
[273]	valid\_0's rmse: 1.60684
1.628317639333455
trafficSource\_campaign   50
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61401
[200]	valid\_0's rmse: 1.60789
[300]	valid\_0's rmse: 1.60616
[400]	valid\_0's rmse: 1.60709
Early stopping, best iteration is:
[335]	valid\_0's rmse: 1.60584
1.6275521460071487
trafficSource\_campaign   51
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61407
[200]	valid\_0's rmse: 1.60688
[300]	valid\_0's rmse: 1.60446
[400]	valid\_0's rmse: 1.60467
Early stopping, best iteration is:
[384]	valid\_0's rmse: 1.60419
1.6259857029243754
trafficSource\_campaign   52
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61453
[200]	valid\_0's rmse: 1.60779
[300]	valid\_0's rmse: 1.60628
[400]	valid\_0's rmse: 1.60686
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60602
1.6285104112884523
trafficSource\_campaign   53
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61428
[200]	valid\_0's rmse: 1.60888
[300]	valid\_0's rmse: 1.60651
[400]	valid\_0's rmse: 1.60766
Early stopping, best iteration is:
[329]	valid\_0's rmse: 1.60635
1.628256222532322
trafficSource\_campaign   54
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61531
[200]	valid\_0's rmse: 1.60834
[300]	valid\_0's rmse: 1.60686
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60679
1.6284698825091182
trafficSource\_campaign   55
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6142
[200]	valid\_0's rmse: 1.60731
[300]	valid\_0's rmse: 1.60582
[400]	valid\_0's rmse: 1.60634
Early stopping, best iteration is:
[336]	valid\_0's rmse: 1.60527
1.6273291428395524
trafficSource\_campaign   56
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61472
[200]	valid\_0's rmse: 1.60837
[300]	valid\_0's rmse: 1.60654
Early stopping, best iteration is:
[275]	valid\_0's rmse: 1.60633
1.6280093365002286
trafficSource\_campaign   57
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61315
[200]	valid\_0's rmse: 1.60666
[300]	valid\_0's rmse: 1.60478
[400]	valid\_0's rmse: 1.60623
Early stopping, best iteration is:
[308]	valid\_0's rmse: 1.60461
1.6271933938375596
trafficSource\_campaign   58
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61563
[200]	valid\_0's rmse: 1.60857
[300]	valid\_0's rmse: 1.60695
Early stopping, best iteration is:
[295]	valid\_0's rmse: 1.60671
1.6288798142596934
trafficSource\_campaign   59
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61634
[200]	valid\_0's rmse: 1.60984
[300]	valid\_0's rmse: 1.60719
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60712
1.6290935452122024
trafficSource\_campaign   60
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61476
[200]	valid\_0's rmse: 1.60737
[300]	valid\_0's rmse: 1.60553
[400]	valid\_0's rmse: 1.60665
Early stopping, best iteration is:
[306]	valid\_0's rmse: 1.60544
1.6274190865307192
trafficSource\_campaign   61
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61409
[200]	valid\_0's rmse: 1.6065
[300]	valid\_0's rmse: 1.60475
[400]	valid\_0's rmse: 1.60607
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60463
1.6271109913562427
trafficSource\_campaign   62
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61574
[200]	valid\_0's rmse: 1.60831
[300]	valid\_0's rmse: 1.60677
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60673
1.6287841640612817
trafficSource\_campaign   63
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61437
[200]	valid\_0's rmse: 1.60637
[300]	valid\_0's rmse: 1.60405
[400]	valid\_0's rmse: 1.60519
Early stopping, best iteration is:
[315]	valid\_0's rmse: 1.60395
1.6259248017063272
trafficSource\_campaign   64
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61339
[200]	valid\_0's rmse: 1.60653
[300]	valid\_0's rmse: 1.60543
Early stopping, best iteration is:
[290]	valid\_0's rmse: 1.60522
1.627647586807492
trafficSource\_campaign   65
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6152
[200]	valid\_0's rmse: 1.60692
[300]	valid\_0's rmse: 1.60513
Early stopping, best iteration is:
[289]	valid\_0's rmse: 1.60471
1.6270256112514334
trafficSource\_campaign   66
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61394
[200]	valid\_0's rmse: 1.60784
[300]	valid\_0's rmse: 1.60723
[400]	valid\_0's rmse: 1.60718
Early stopping, best iteration is:
[386]	valid\_0's rmse: 1.60653
1.6283533788404883
trafficSource\_campaign   67
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61439
[200]	valid\_0's rmse: 1.60753
[300]	valid\_0's rmse: 1.60571
[400]	valid\_0's rmse: 1.60736
Early stopping, best iteration is:
[301]	valid\_0's rmse: 1.6057
1.6264512511265297
trafficSource\_campaign   68
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61626
[200]	valid\_0's rmse: 1.60919
[300]	valid\_0's rmse: 1.60646
[400]	valid\_0's rmse: 1.608
Early stopping, best iteration is:
[305]	valid\_0's rmse: 1.60632
1.6284684182746798
trafficSource\_campaign   69
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61545
[200]	valid\_0's rmse: 1.60852
[300]	valid\_0's rmse: 1.60716
Early stopping, best iteration is:
[287]	valid\_0's rmse: 1.60689
1.6287680092698391
trafficSource\_campaign   70
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61543
[200]	valid\_0's rmse: 1.60769
[300]	valid\_0's rmse: 1.60747
Early stopping, best iteration is:
[240]	valid\_0's rmse: 1.60697
1.629165716750808
trafficSource\_campaign   71
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61521
[200]	valid\_0's rmse: 1.60767
[300]	valid\_0's rmse: 1.60648
Early stopping, best iteration is:
[283]	valid\_0's rmse: 1.60619
1.628794622043828
trafficSource\_campaign   72
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61569
[200]	valid\_0's rmse: 1.60887
[300]	valid\_0's rmse: 1.60765
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.60758
1.629455009969746
trafficSource\_campaign   73
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61426
[200]	valid\_0's rmse: 1.60799
[300]	valid\_0's rmse: 1.60635
[400]	valid\_0's rmse: 1.60744
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60632
1.6275621739064379
trafficSource\_campaign   74
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.616
[200]	valid\_0's rmse: 1.60892
[300]	valid\_0's rmse: 1.6069
Early stopping, best iteration is:
[288]	valid\_0's rmse: 1.60671
1.6283987416743526
trafficSource\_campaign   75
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61551
[200]	valid\_0's rmse: 1.60934
[300]	valid\_0's rmse: 1.60709
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60707
1.6291856037947179
trafficSource\_campaign   76
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61382
[200]	valid\_0's rmse: 1.60634
[300]	valid\_0's rmse: 1.60549
Early stopping, best iteration is:
[274]	valid\_0's rmse: 1.60523
1.627260560591948
trafficSource\_campaign   77
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61485
[200]	valid\_0's rmse: 1.60802
[300]	valid\_0's rmse: 1.6066
Early stopping, best iteration is:
[285]	valid\_0's rmse: 1.60634
1.6290409013212597
trafficSource\_campaign   78
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61467
[200]	valid\_0's rmse: 1.60768
[300]	valid\_0's rmse: 1.60724
Early stopping, best iteration is:
[290]	valid\_0's rmse: 1.60683
1.6292290476617246
trafficSource\_campaign   79
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61475
[200]	valid\_0's rmse: 1.60856
[300]	valid\_0's rmse: 1.60657
Early stopping, best iteration is:
[293]	valid\_0's rmse: 1.60648
1.6281942608332078
trafficSource\_campaign   80
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61516
[200]	valid\_0's rmse: 1.61067
[300]	valid\_0's rmse: 1.60904
Early stopping, best iteration is:
[292]	valid\_0's rmse: 1.60879
1.629830987339246
trafficSource\_campaign   81
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61647
[200]	valid\_0's rmse: 1.60796
[300]	valid\_0's rmse: 1.60648
Early stopping, best iteration is:
[290]	valid\_0's rmse: 1.60638
1.628428509065658
trafficSource\_campaign   82
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61567
[200]	valid\_0's rmse: 1.60766
[300]	valid\_0's rmse: 1.60637
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.60609
1.628114875946481
trafficSource\_campaign   83
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6151
[200]	valid\_0's rmse: 1.60779
[300]	valid\_0's rmse: 1.60552
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60545
1.6273047931122955
trafficSource\_campaign   84
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61551
[200]	valid\_0's rmse: 1.60709
[300]	valid\_0's rmse: 1.60675
[400]	valid\_0's rmse: 1.60831
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60669
1.628948058518984
trafficSource\_campaign   85
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61384
[200]	valid\_0's rmse: 1.60928
[300]	valid\_0's rmse: 1.60752
[400]	valid\_0's rmse: 1.60951
Early stopping, best iteration is:
[309]	valid\_0's rmse: 1.60722
1.629861426573618
trafficSource\_campaign   86
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61521
[200]	valid\_0's rmse: 1.60788
[300]	valid\_0's rmse: 1.60611
[400]	valid\_0's rmse: 1.6068
Early stopping, best iteration is:
[334]	valid\_0's rmse: 1.60597
1.6285866107468254
trafficSource\_campaign   87
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61496
[200]	valid\_0's rmse: 1.60823
[300]	valid\_0's rmse: 1.60688
[400]	valid\_0's rmse: 1.60818
Early stopping, best iteration is:
[307]	valid\_0's rmse: 1.60668
1.6287482680245837
trafficSource\_campaign   88
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61451
[200]	valid\_0's rmse: 1.60806
[300]	valid\_0's rmse: 1.60575
[400]	valid\_0's rmse: 1.60681
Early stopping, best iteration is:
[309]	valid\_0's rmse: 1.60549
1.627466879022464
trafficSource\_campaign   89
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61551
[200]	valid\_0's rmse: 1.60613
[300]	valid\_0's rmse: 1.60402
[400]	valid\_0's rmse: 1.60631
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60398
1.6262491021925685
trafficSource\_campaign   90
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61483
[200]	valid\_0's rmse: 1.6073
[300]	valid\_0's rmse: 1.60645
Early stopping, best iteration is:
[292]	valid\_0's rmse: 1.60636
1.6283123182205175
trafficSource\_campaign   91
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61627
[200]	valid\_0's rmse: 1.60782
[300]	valid\_0's rmse: 1.60675
Early stopping, best iteration is:
[287]	valid\_0's rmse: 1.60647
1.6281784541509126
trafficSource\_campaign   92
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61552
[200]	valid\_0's rmse: 1.60769
[300]	valid\_0's rmse: 1.60622
[400]	valid\_0's rmse: 1.60659
Early stopping, best iteration is:
[306]	valid\_0's rmse: 1.60604
1.628044699638732
trafficSource\_campaign   93
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61511
[200]	valid\_0's rmse: 1.60845
[300]	valid\_0's rmse: 1.60664
[400]	valid\_0's rmse: 1.60585
[500]	valid\_0's rmse: 1.60783
Early stopping, best iteration is:
[403]	valid\_0's rmse: 1.60579
1.627138738327757
trafficSource\_campaign   94
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61567
[200]	valid\_0's rmse: 1.60825
[300]	valid\_0's rmse: 1.60553
[400]	valid\_0's rmse: 1.60575
Early stopping, best iteration is:
[337]	valid\_0's rmse: 1.60475
1.6262310389087888
trafficSource\_campaign   95
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61488
[200]	valid\_0's rmse: 1.60711
[300]	valid\_0's rmse: 1.60644
[400]	valid\_0's rmse: 1.60696
Early stopping, best iteration is:
[319]	valid\_0's rmse: 1.60595
1.6281533314813383
trafficSource\_campaign   96
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61434
[200]	valid\_0's rmse: 1.60756
[300]	valid\_0's rmse: 1.60574
[400]	valid\_0's rmse: 1.60673
Early stopping, best iteration is:
[335]	valid\_0's rmse: 1.60561
1.627968875570156
trafficSource\_campaign   97
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61459
[200]	valid\_0's rmse: 1.60592
[300]	valid\_0's rmse: 1.60575
[400]	valid\_0's rmse: 1.60576
Early stopping, best iteration is:
[322]	valid\_0's rmse: 1.60497
1.6268626957643524
trafficSource\_campaign   98
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61595
[200]	valid\_0's rmse: 1.60838
[300]	valid\_0's rmse: 1.60648
Early stopping, best iteration is:
[286]	valid\_0's rmse: 1.60642
1.6286707721764202
trafficSource\_campaign   99
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61565
[200]	valid\_0's rmse: 1.60918
[300]	valid\_0's rmse: 1.60737
[400]	valid\_0's rmse: 1.60848
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60719
1.6292242579289304

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pval for totals\PYZus{}pageviews and trafficSource\PYZus{}campaign}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{pval1} \PY{o}{=} \PY{n}{p\PYZus{}val}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{pval1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
pval for totals\_pageviews and trafficSource\_campaign
[0.0, 0.79]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{n}{base\PYZus{}rmse} \PY{o}{=} \PY{l+m+mf}{1.6288250113593938}
         \PY{n+nb}{iter} \PY{o}{=} \PY{l+m+mi}{100}
         \PY{n}{p\PYZus{}val} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{column\PYZus{}perm} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}hits}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{visitID}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}newVisits}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}continent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}adwordsClickInfo.isVideoAd}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
         \PY{c+c1}{\PYZsh{}for column\PYZus{}perm in [\PYZdq{}totals\PYZus{}pageviews\PYZdq{}, \PYZdq{}trafficSource\PYZus{}campaign\PYZdq{}]:}
             \PY{n}{ans} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{iter}\PY{p}{)}\PY{p}{:}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{column\PYZus{}perm}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{i}\PY{p}{)}
                 \PY{n}{train\PYZus{}permute} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
                 \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{column\PYZus{}perm}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{permutation}\PY{p}{(}\PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{column\PYZus{}perm}\PY{p}{]}\PY{p}{)}
                 \PY{n}{x}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}
                 \PY{n}{x1} \PY{o}{=} \PY{l+m+mi}{3} \PY{o}{*} \PY{n+nb}{int}\PY{p}{(}\PY{n}{x} \PY{o}{/} \PY{l+m+mi}{4}\PY{p}{)}
         
                 \PY{n}{dev\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{x1}\PY{p}{]}
                 \PY{n}{val\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{x1}\PY{p}{:}\PY{n}{x}\PY{p}{]}
         
                 \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}df}
                 \PY{n}{val\PYZus{}X} \PY{o}{=} \PY{n}{val\PYZus{}df}
         
                 \PY{n}{dev\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
                 \PY{n}{val\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}X}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
                 \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{val\PYZus{}X} \PY{o}{=} \PY{n}{val\PYZus{}X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         
                 \PY{n}{model}\PY{p}{,} \PY{n}{pred\PYZus{}val} \PY{o}{=} \PY{n}{run\PYZus{}lgb\PYZus{}perm}\PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{p}{,} \PY{n}{dev\PYZus{}y}\PY{p}{,} \PY{n}{val\PYZus{}X}\PY{p}{,} \PY{n}{val\PYZus{}y}\PY{p}{)}
                 
                 \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
                 \PY{n}{pred\PYZus{}val}\PY{p}{[}\PY{n}{pred\PYZus{}val}\PY{o}{\PYZlt{}}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{val\PYZus{}pred\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{\PYZcb{}}\PY{p}{)}
                 \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
                 \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{expm1}\PY{p}{(}\PY{n}{pred\PYZus{}val}\PY{p}{)}
                 \PY{n}{val\PYZus{}pred\PYZus{}df} \PY{o}{=} \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                 \PY{n}{ans}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{less\PYZus{}sum} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{i} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{base\PYZus{}rmse} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ans}\PY{p}{)}
             \PY{n}{p\PYZus{}val}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{less\PYZus{}sum}\PY{o}{/}\PY{n+nb}{iter}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
totals\_hits   0
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63955
[200]	valid\_0's rmse: 1.63827
[300]	valid\_0's rmse: 1.63873
Early stopping, best iteration is:
[246]	valid\_0's rmse: 1.63782
1.6581963765435563
totals\_hits   1
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63971
[200]	valid\_0's rmse: 1.63812
Early stopping, best iteration is:
[185]	valid\_0's rmse: 1.63784
1.6586896120522647
totals\_hits   2
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63965
[200]	valid\_0's rmse: 1.63883
Early stopping, best iteration is:
[160]	valid\_0's rmse: 1.63819
1.6596700273645464
totals\_hits   3
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64063
[200]	valid\_0's rmse: 1.63872
[300]	valid\_0's rmse: 1.63904
Early stopping, best iteration is:
[202]	valid\_0's rmse: 1.63852
1.6590737782825022
totals\_hits   4
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6393
[200]	valid\_0's rmse: 1.63739
[300]	valid\_0's rmse: 1.63768
Early stopping, best iteration is:
[237]	valid\_0's rmse: 1.63698
1.65771115492575
totals\_hits   5
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63971
[200]	valid\_0's rmse: 1.63828
[300]	valid\_0's rmse: 1.63899
Early stopping, best iteration is:
[230]	valid\_0's rmse: 1.63803
1.658802786507439
totals\_hits   6
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64096
[200]	valid\_0's rmse: 1.63981
Early stopping, best iteration is:
[160]	valid\_0's rmse: 1.63912
1.6607462863364593
totals\_hits   7
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6401
[200]	valid\_0's rmse: 1.63753
Early stopping, best iteration is:
[178]	valid\_0's rmse: 1.63738
1.6578681595242344
totals\_hits   8
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64012
[200]	valid\_0's rmse: 1.63932
[300]	valid\_0's rmse: 1.63949
Early stopping, best iteration is:
[226]	valid\_0's rmse: 1.63906
1.6598788537405897
totals\_hits   9
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64039
[200]	valid\_0's rmse: 1.63931
Early stopping, best iteration is:
[162]	valid\_0's rmse: 1.63879
1.6597852073620276
totals\_hits   10
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64064
[200]	valid\_0's rmse: 1.63911
[300]	valid\_0's rmse: 1.63981
Early stopping, best iteration is:
[248]	valid\_0's rmse: 1.63867
1.6593017587695844
totals\_hits   11
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63964
[200]	valid\_0's rmse: 1.63821
Early stopping, best iteration is:
[185]	valid\_0's rmse: 1.63799
1.659439923307088
totals\_hits   12
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63941
[200]	valid\_0's rmse: 1.63831
Early stopping, best iteration is:
[167]	valid\_0's rmse: 1.63778
1.6591729097912045
totals\_hits   13
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64046
[200]	valid\_0's rmse: 1.64022
Early stopping, best iteration is:
[160]	valid\_0's rmse: 1.6393
1.6609549098048624
totals\_hits   14
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64057
[200]	valid\_0's rmse: 1.639
[300]	valid\_0's rmse: 1.63896
Early stopping, best iteration is:
[235]	valid\_0's rmse: 1.63822
1.6588936797519587
totals\_hits   15
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64095
[200]	valid\_0's rmse: 1.63925
[300]	valid\_0's rmse: 1.6393
Early stopping, best iteration is:
[290]	valid\_0's rmse: 1.639
1.6592825943932836
totals\_hits   16
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6408
[200]	valid\_0's rmse: 1.63949
Early stopping, best iteration is:
[160]	valid\_0's rmse: 1.63921
1.6598004142917817
totals\_hits   17
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6396
[200]	valid\_0's rmse: 1.63873
Early stopping, best iteration is:
[161]	valid\_0's rmse: 1.63811
1.659907327908716
totals\_hits   18
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64006
[200]	valid\_0's rmse: 1.63871
[300]	valid\_0's rmse: 1.63888
Early stopping, best iteration is:
[224]	valid\_0's rmse: 1.63839
1.6590859378183387
totals\_hits   19
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63939
[200]	valid\_0's rmse: 1.63828
[300]	valid\_0's rmse: 1.63856
Early stopping, best iteration is:
[229]	valid\_0's rmse: 1.63769
1.6589212714831114
totals\_hits   20
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64011
[200]	valid\_0's rmse: 1.63843
Early stopping, best iteration is:
[199]	valid\_0's rmse: 1.63843
1.6590580844226008
totals\_hits   21
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64126
[200]	valid\_0's rmse: 1.6405
Early stopping, best iteration is:
[169]	valid\_0's rmse: 1.63967
1.661256123425933
totals\_hits   22
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64037
[200]	valid\_0's rmse: 1.63896
[300]	valid\_0's rmse: 1.63972
Early stopping, best iteration is:
[244]	valid\_0's rmse: 1.6387
1.6585013105695334
totals\_hits   23
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64071
[200]	valid\_0's rmse: 1.63763
[300]	valid\_0's rmse: 1.63786
Early stopping, best iteration is:
[237]	valid\_0's rmse: 1.6374
1.6583363813214365
totals\_hits   24
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64018
[200]	valid\_0's rmse: 1.63909
Early stopping, best iteration is:
[168]	valid\_0's rmse: 1.6386
1.6595726308244438
totals\_hits   25
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63976
[200]	valid\_0's rmse: 1.63752
Early stopping, best iteration is:
[194]	valid\_0's rmse: 1.63742
1.6579445482934412
totals\_hits   26
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64118
[200]	valid\_0's rmse: 1.63896
[300]	valid\_0's rmse: 1.6394
Early stopping, best iteration is:
[225]	valid\_0's rmse: 1.63874
1.658896413205667
totals\_hits   27
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63951
[200]	valid\_0's rmse: 1.63789
[300]	valid\_0's rmse: 1.63843
Early stopping, best iteration is:
[223]	valid\_0's rmse: 1.63751
1.6582780557566321
totals\_hits   28
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64093
[200]	valid\_0's rmse: 1.63979
Early stopping, best iteration is:
[194]	valid\_0's rmse: 1.63958
1.6598070617717255
totals\_hits   29
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64074
[200]	valid\_0's rmse: 1.63949
Early stopping, best iteration is:
[150]	valid\_0's rmse: 1.63894
1.661191062072186
totals\_hits   30
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64097
[200]	valid\_0's rmse: 1.63958
[300]	valid\_0's rmse: 1.64056
Early stopping, best iteration is:
[207]	valid\_0's rmse: 1.63919
1.6603850685417227
totals\_hits   31
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63992
[200]	valid\_0's rmse: 1.63799
[300]	valid\_0's rmse: 1.63885
Early stopping, best iteration is:
[213]	valid\_0's rmse: 1.63771
1.6586952869741944
totals\_hits   32
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63974
[200]	valid\_0's rmse: 1.63949
Early stopping, best iteration is:
[151]	valid\_0's rmse: 1.63889
1.6607333914961904
totals\_hits   33
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63977
[200]	valid\_0's rmse: 1.63898
Early stopping, best iteration is:
[160]	valid\_0's rmse: 1.63868
1.6603367640342643
totals\_hits   34
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64148
[200]	valid\_0's rmse: 1.64003
[300]	valid\_0's rmse: 1.64034
Early stopping, best iteration is:
[225]	valid\_0's rmse: 1.63971
1.6595498226896224
totals\_hits   35
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64001
[200]	valid\_0's rmse: 1.6392
[300]	valid\_0's rmse: 1.63858
Early stopping, best iteration is:
[295]	valid\_0's rmse: 1.63838
1.6589235798860622
totals\_hits   36
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64075
[200]	valid\_0's rmse: 1.63846
Early stopping, best iteration is:
[193]	valid\_0's rmse: 1.63823
1.6580189159622674
totals\_hits   37
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64048
[200]	valid\_0's rmse: 1.63849
[300]	valid\_0's rmse: 1.63945
Early stopping, best iteration is:
[212]	valid\_0's rmse: 1.6382
1.659406496934629
totals\_hits   38
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64102
[200]	valid\_0's rmse: 1.63908
Early stopping, best iteration is:
[169]	valid\_0's rmse: 1.63865
1.6594158432550636
totals\_hits   39
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64152
[200]	valid\_0's rmse: 1.63979
[300]	valid\_0's rmse: 1.63972
Early stopping, best iteration is:
[229]	valid\_0's rmse: 1.63957
1.6597915442839077
totals\_hits   40
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64048
[200]	valid\_0's rmse: 1.6399
Early stopping, best iteration is:
[153]	valid\_0's rmse: 1.63935
1.66137490676332
totals\_hits   41
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64117
[200]	valid\_0's rmse: 1.63872
[300]	valid\_0's rmse: 1.63855
Early stopping, best iteration is:
[239]	valid\_0's rmse: 1.6381
1.6589734691010087
totals\_hits   42
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64026
[200]	valid\_0's rmse: 1.63841
[300]	valid\_0's rmse: 1.63916
Early stopping, best iteration is:
[206]	valid\_0's rmse: 1.63835
1.6593261241732455
totals\_hits   43
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64089
[200]	valid\_0's rmse: 1.63895
Early stopping, best iteration is:
[185]	valid\_0's rmse: 1.63866
1.6600357864049005
totals\_hits   44
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64039
[200]	valid\_0's rmse: 1.63887
Early stopping, best iteration is:
[168]	valid\_0's rmse: 1.6385
1.6601274098430032
totals\_hits   45
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63981
[200]	valid\_0's rmse: 1.6378
[300]	valid\_0's rmse: 1.63793
Early stopping, best iteration is:
[271]	valid\_0's rmse: 1.63722
1.6578167077923072
totals\_hits   46
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64032
[200]	valid\_0's rmse: 1.63981
Early stopping, best iteration is:
[171]	valid\_0's rmse: 1.63844
1.6601861773709838
totals\_hits   47
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64009
[200]	valid\_0's rmse: 1.63736
[300]	valid\_0's rmse: 1.63776
Early stopping, best iteration is:
[201]	valid\_0's rmse: 1.63733
1.6578192919610286
totals\_hits   48
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63978
[200]	valid\_0's rmse: 1.63899
Early stopping, best iteration is:
[119]	valid\_0's rmse: 1.63841
1.6603988240224312
totals\_hits   49
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6402
[200]	valid\_0's rmse: 1.63867
[300]	valid\_0's rmse: 1.63879
Early stopping, best iteration is:
[242]	valid\_0's rmse: 1.63811
1.6592490931787696
totals\_hits   50
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64143
[200]	valid\_0's rmse: 1.6398
Early stopping, best iteration is:
[153]	valid\_0's rmse: 1.63953
1.6606230841105498
totals\_hits   51
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63985
[200]	valid\_0's rmse: 1.63887
Early stopping, best iteration is:
[169]	valid\_0's rmse: 1.63858
1.6596140837466886
totals\_hits   52
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63985
[200]	valid\_0's rmse: 1.6393
Early stopping, best iteration is:
[187]	valid\_0's rmse: 1.63899
1.6595240603314587
totals\_hits   53
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63926
[200]	valid\_0's rmse: 1.63735
Early stopping, best iteration is:
[193]	valid\_0's rmse: 1.63719
1.6577996602965195
totals\_hits   54
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64043
[200]	valid\_0's rmse: 1.63819
Early stopping, best iteration is:
[194]	valid\_0's rmse: 1.63799
1.659286249729011
totals\_hits   55
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64017
[200]	valid\_0's rmse: 1.63939
Early stopping, best iteration is:
[125]	valid\_0's rmse: 1.6391
1.6607026356157955
totals\_hits   56
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64038
[200]	valid\_0's rmse: 1.63888
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.63867
1.6599647593598512
totals\_hits   57
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64179
[200]	valid\_0's rmse: 1.63985
[300]	valid\_0's rmse: 1.64081
Early stopping, best iteration is:
[207]	valid\_0's rmse: 1.63962
1.66048524320907
totals\_hits   58
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64067
[200]	valid\_0's rmse: 1.63885
Early stopping, best iteration is:
[171]	valid\_0's rmse: 1.63863
1.6589283159527852
totals\_hits   59
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63966
[200]	valid\_0's rmse: 1.63776
Early stopping, best iteration is:
[173]	valid\_0's rmse: 1.63756
1.6587597711725526
totals\_hits   60
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64035
[200]	valid\_0's rmse: 1.63833
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.63831
1.658600333668876
totals\_hits   61
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6407
[200]	valid\_0's rmse: 1.63929
[300]	valid\_0's rmse: 1.64095
Early stopping, best iteration is:
[204]	valid\_0's rmse: 1.6392
1.6602343598944116
totals\_hits   62
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63955
[200]	valid\_0's rmse: 1.63841
[300]	valid\_0's rmse: 1.63995
Early stopping, best iteration is:
[207]	valid\_0's rmse: 1.63827
1.6594354778302394
totals\_hits   63
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64062
[200]	valid\_0's rmse: 1.63855
Early stopping, best iteration is:
[168]	valid\_0's rmse: 1.63838
1.6596718360508533
totals\_hits   64
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64064
[200]	valid\_0's rmse: 1.64031
Early stopping, best iteration is:
[119]	valid\_0's rmse: 1.63951
1.6608796715040839
totals\_hits   65
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63998
[200]	valid\_0's rmse: 1.63855
[300]	valid\_0's rmse: 1.64052
Early stopping, best iteration is:
[203]	valid\_0's rmse: 1.63853
1.6589846957247276
totals\_hits   66
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6392
[200]	valid\_0's rmse: 1.63781
Early stopping, best iteration is:
[174]	valid\_0's rmse: 1.63742
1.6585579549981548
totals\_hits   67
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64076
[200]	valid\_0's rmse: 1.63803
[300]	valid\_0's rmse: 1.63787
Early stopping, best iteration is:
[279]	valid\_0's rmse: 1.63752
1.6579619623161488
totals\_hits   68
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64031
[200]	valid\_0's rmse: 1.63812
[300]	valid\_0's rmse: 1.63923
Early stopping, best iteration is:
[230]	valid\_0's rmse: 1.63794
1.6590345725415467
totals\_hits   69
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64029
[200]	valid\_0's rmse: 1.63846
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.6384
1.658924880834794
totals\_hits   70
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64081
[200]	valid\_0's rmse: 1.6385
[300]	valid\_0's rmse: 1.63944
Early stopping, best iteration is:
[224]	valid\_0's rmse: 1.6384
1.6589547022353002
totals\_hits   71
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64021
[200]	valid\_0's rmse: 1.63806
[300]	valid\_0's rmse: 1.63913
Early stopping, best iteration is:
[207]	valid\_0's rmse: 1.63799
1.6586696287786469
totals\_hits   72
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64028
[200]	valid\_0's rmse: 1.63889
[300]	valid\_0's rmse: 1.63975
Early stopping, best iteration is:
[207]	valid\_0's rmse: 1.63863
1.6592684656687935
totals\_hits   73
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64074
[200]	valid\_0's rmse: 1.63924
Early stopping, best iteration is:
[169]	valid\_0's rmse: 1.63883
1.660279663984504
totals\_hits   74
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64006
[200]	valid\_0's rmse: 1.63932
Early stopping, best iteration is:
[152]	valid\_0's rmse: 1.63837
1.6601558478383847
totals\_hits   75
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63969
[200]	valid\_0's rmse: 1.63858
[300]	valid\_0's rmse: 1.63893
Early stopping, best iteration is:
[234]	valid\_0's rmse: 1.63826
1.6595300575775087
totals\_hits   76
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64107
[200]	valid\_0's rmse: 1.63952
Early stopping, best iteration is:
[194]	valid\_0's rmse: 1.63939
1.6604686719283908
totals\_hits   77
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64012
[200]	valid\_0's rmse: 1.63843
Early stopping, best iteration is:
[160]	valid\_0's rmse: 1.63794
1.6594021319036765
totals\_hits   78
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64015
[200]	valid\_0's rmse: 1.63782
[300]	valid\_0's rmse: 1.63868
Early stopping, best iteration is:
[229]	valid\_0's rmse: 1.63751
1.65856767006898
totals\_hits   79
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64108
[200]	valid\_0's rmse: 1.63982
[300]	valid\_0's rmse: 1.64018
Early stopping, best iteration is:
[241]	valid\_0's rmse: 1.63917
1.6590764565339986
totals\_hits   80
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64059
[200]	valid\_0's rmse: 1.63989
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.63971
1.6612289288694335
totals\_hits   81
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64068
[200]	valid\_0's rmse: 1.63936
[300]	valid\_0's rmse: 1.64061
Early stopping, best iteration is:
[236]	valid\_0's rmse: 1.63904
1.659648344269839
totals\_hits   82
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64029
[200]	valid\_0's rmse: 1.63775
[300]	valid\_0's rmse: 1.63873
Early stopping, best iteration is:
[244]	valid\_0's rmse: 1.63745
1.65720655131367
totals\_hits   83
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64065
[200]	valid\_0's rmse: 1.63854
[300]	valid\_0's rmse: 1.63993
Early stopping, best iteration is:
[207]	valid\_0's rmse: 1.63841
1.6587374757561717
totals\_hits   84
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63964
[200]	valid\_0's rmse: 1.63773
Early stopping, best iteration is:
[190]	valid\_0's rmse: 1.63756
1.6581374722111482
totals\_hits   85
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63997
[200]	valid\_0's rmse: 1.63852
[300]	valid\_0's rmse: 1.63975
Early stopping, best iteration is:
[201]	valid\_0's rmse: 1.63849
1.658969250132919
totals\_hits   86
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63967
[200]	valid\_0's rmse: 1.63892
Early stopping, best iteration is:
[169]	valid\_0's rmse: 1.63851
1.65979726898884
totals\_hits   87
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64045
[200]	valid\_0's rmse: 1.63989
Early stopping, best iteration is:
[154]	valid\_0's rmse: 1.63926
1.660678980986641
totals\_hits   88
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64105
[200]	valid\_0's rmse: 1.63906
[300]	valid\_0's rmse: 1.6396
Early stopping, best iteration is:
[202]	valid\_0's rmse: 1.63887
1.6597170457642278
totals\_hits   89
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63907
[200]	valid\_0's rmse: 1.63753
Early stopping, best iteration is:
[188]	valid\_0's rmse: 1.63727
1.6587001678129203
totals\_hits   90
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64088
[200]	valid\_0's rmse: 1.63879
Early stopping, best iteration is:
[194]	valid\_0's rmse: 1.63875
1.659875611221985
totals\_hits   91
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63978
[200]	valid\_0's rmse: 1.63779
[300]	valid\_0's rmse: 1.63897
Early stopping, best iteration is:
[225]	valid\_0's rmse: 1.63743
1.6581098964325762
totals\_hits   92
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64107
[200]	valid\_0's rmse: 1.63936
Early stopping, best iteration is:
[169]	valid\_0's rmse: 1.63889
1.6600952642731772
totals\_hits   93
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64143
[200]	valid\_0's rmse: 1.63946
Early stopping, best iteration is:
[166]	valid\_0's rmse: 1.63924
1.6600290650568683
totals\_hits   94
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64088
[200]	valid\_0's rmse: 1.6392
[300]	valid\_0's rmse: 1.64093
Early stopping, best iteration is:
[200]	valid\_0's rmse: 1.6392
1.6595061227244703
totals\_hits   95
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64015
[200]	valid\_0's rmse: 1.63895
Early stopping, best iteration is:
[160]	valid\_0's rmse: 1.63824
1.6589184659213312
totals\_hits   96
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63999
[200]	valid\_0's rmse: 1.63877
[300]	valid\_0's rmse: 1.63888
Early stopping, best iteration is:
[213]	valid\_0's rmse: 1.63856
1.6587876813226696
totals\_hits   97
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64
[200]	valid\_0's rmse: 1.638
[300]	valid\_0's rmse: 1.63821
Early stopping, best iteration is:
[274]	valid\_0's rmse: 1.63788
1.6577732305389095
totals\_hits   98
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.63991
[200]	valid\_0's rmse: 1.63843
[300]	valid\_0's rmse: 1.63879
Early stopping, best iteration is:
[229]	valid\_0's rmse: 1.63808
1.6590182284128343
totals\_hits   99
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.64021
[200]	valid\_0's rmse: 1.63853
Early stopping, best iteration is:
[169]	valid\_0's rmse: 1.63798
1.6588411081670387
visitID   0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        KeyError                                  Traceback (most recent call last)

        /anaconda3/lib/python3.6/site-packages/pandas/core/indexes/base.py in get\_loc(self, key, method, tolerance)
       3062             try:
    -> 3063                 return self.\_engine.get\_loc(key)
       3064             except KeyError:


        pandas/\_libs/index.pyx in pandas.\_libs.index.IndexEngine.get\_loc()


        pandas/\_libs/index.pyx in pandas.\_libs.index.IndexEngine.get\_loc()


        pandas/\_libs/hashtable\_class\_helper.pxi in pandas.\_libs.hashtable.PyObjectHashTable.get\_item()


        pandas/\_libs/hashtable\_class\_helper.pxi in pandas.\_libs.hashtable.PyObjectHashTable.get\_item()


        KeyError: 'visitID'

        
    During handling of the above exception, another exception occurred:


        KeyError                                  Traceback (most recent call last)

        <ipython-input-64-36978ef7a66e> in <module>()
          9         print(column\_perm," ",i)
         10         train\_permute = train\_df.copy()
    ---> 11         train\_permute[column\_perm] = np.random.permutation(train\_permute[column\_perm])
         12         x, y = train\_df.shape
         13         x1 = 3 * int(x / 4)


        /anaconda3/lib/python3.6/site-packages/pandas/core/frame.py in \_\_getitem\_\_(self, key)
       2683             return self.\_getitem\_multilevel(key)
       2684         else:
    -> 2685             return self.\_getitem\_column(key)
       2686 
       2687     def \_getitem\_column(self, key):


        /anaconda3/lib/python3.6/site-packages/pandas/core/frame.py in \_getitem\_column(self, key)
       2690         \# get column
       2691         if self.columns.is\_unique:
    -> 2692             return self.\_get\_item\_cache(key)
       2693 
       2694         \# duplicate columns \& possible reduce dimensionality


        /anaconda3/lib/python3.6/site-packages/pandas/core/generic.py in \_get\_item\_cache(self, item)
       2484         res = cache.get(item)
       2485         if res is None:
    -> 2486             values = self.\_data.get(item)
       2487             res = self.\_box\_item\_values(item, values)
       2488             cache[item] = res


        /anaconda3/lib/python3.6/site-packages/pandas/core/internals.py in get(self, item, fastpath)
       4113 
       4114             if not isna(item):
    -> 4115                 loc = self.items.get\_loc(item)
       4116             else:
       4117                 indexer = np.arange(len(self.items))[isna(self.items)]


        /anaconda3/lib/python3.6/site-packages/pandas/core/indexes/base.py in get\_loc(self, key, method, tolerance)
       3063                 return self.\_engine.get\_loc(key)
       3064             except KeyError:
    -> 3065                 return self.\_engine.get\_loc(self.\_maybe\_cast\_indexer(key))
       3066 
       3067         indexer = self.get\_indexer([key], method=method, tolerance=tolerance)


        pandas/\_libs/index.pyx in pandas.\_libs.index.IndexEngine.get\_loc()


        pandas/\_libs/index.pyx in pandas.\_libs.index.IndexEngine.get\_loc()


        pandas/\_libs/hashtable\_class\_helper.pxi in pandas.\_libs.hashtable.PyObjectHashTable.get\_item()


        pandas/\_libs/hashtable\_class\_helper.pxi in pandas.\_libs.hashtable.PyObjectHashTable.get\_item()


        KeyError: 'visitID'

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pval for totals\PYZus{}hits}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{pval2} \PY{o}{=} \PY{n}{p\PYZus{}val}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{pval2}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
pval for totals\_hits
[0.0]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{n}{base\PYZus{}rmse} \PY{o}{=} \PY{l+m+mf}{1.6288250113593938}
         \PY{n+nb}{iter} \PY{o}{=} \PY{l+m+mi}{100}
         \PY{n}{p\PYZus{}val} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{column\PYZus{}perm} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{visitId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}newVisits}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}continent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trafficSource\PYZus{}adwordsClickInfo.isVideoAd}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
         \PY{c+c1}{\PYZsh{}for column\PYZus{}perm in [\PYZdq{}totals\PYZus{}pageviews\PYZdq{}, \PYZdq{}trafficSource\PYZus{}campaign\PYZdq{}]:}
             \PY{n}{ans} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{iter}\PY{p}{)}\PY{p}{:}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{column\PYZus{}perm}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{i}\PY{p}{)}
                 \PY{n}{train\PYZus{}permute} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
                 \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{column\PYZus{}perm}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{permutation}\PY{p}{(}\PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{column\PYZus{}perm}\PY{p}{]}\PY{p}{)}
                 \PY{n}{x}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}
                 \PY{n}{x1} \PY{o}{=} \PY{l+m+mi}{3} \PY{o}{*} \PY{n+nb}{int}\PY{p}{(}\PY{n}{x} \PY{o}{/} \PY{l+m+mi}{4}\PY{p}{)}
         
                 \PY{n}{dev\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{x1}\PY{p}{]}
                 \PY{n}{val\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{x1}\PY{p}{:}\PY{n}{x}\PY{p}{]}
         
                 \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}df}
                 \PY{n}{val\PYZus{}X} \PY{o}{=} \PY{n}{val\PYZus{}df}
         
                 \PY{n}{dev\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
                 \PY{n}{val\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}X}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
                 \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{val\PYZus{}X} \PY{o}{=} \PY{n}{val\PYZus{}X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         
                 \PY{n}{model}\PY{p}{,} \PY{n}{pred\PYZus{}val} \PY{o}{=} \PY{n}{run\PYZus{}lgb\PYZus{}perm}\PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{p}{,} \PY{n}{dev\PYZus{}y}\PY{p}{,} \PY{n}{val\PYZus{}X}\PY{p}{,} \PY{n}{val\PYZus{}y}\PY{p}{)}
                 
                 \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
                 \PY{n}{pred\PYZus{}val}\PY{p}{[}\PY{n}{pred\PYZus{}val}\PY{o}{\PYZlt{}}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{val\PYZus{}pred\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{\PYZcb{}}\PY{p}{)}
                 \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
                 \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{expm1}\PY{p}{(}\PY{n}{pred\PYZus{}val}\PY{p}{)}
                 \PY{n}{val\PYZus{}pred\PYZus{}df} \PY{o}{=} \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                 \PY{n}{ans}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{less\PYZus{}sum} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{i} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{base\PYZus{}rmse} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ans}\PY{p}{)}
             \PY{n}{p\PYZus{}val}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{less\PYZus{}sum}\PY{o}{/}\PY{n+nb}{iter}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
visitId   0
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61874
[200]	valid\_0's rmse: 1.61186
[300]	valid\_0's rmse: 1.61079
[400]	valid\_0's rmse: 1.61236
Early stopping, best iteration is:
[301]	valid\_0's rmse: 1.61077
1.6318902324996944
visitId   1
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61864
[200]	valid\_0's rmse: 1.61235
[300]	valid\_0's rmse: 1.61163
Early stopping, best iteration is:
[257]	valid\_0's rmse: 1.61134
1.6329603860924704
visitId   2
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61831
[200]	valid\_0's rmse: 1.61137
[300]	valid\_0's rmse: 1.61071
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.61052
1.632458383551135
visitId   3
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61824
[200]	valid\_0's rmse: 1.6138
[300]	valid\_0's rmse: 1.61188
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.61183
1.634061356879683
visitId   4
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61828
[200]	valid\_0's rmse: 1.61047
[300]	valid\_0's rmse: 1.60995
Early stopping, best iteration is:
[269]	valid\_0's rmse: 1.6097
1.6316937866942478
visitId   5
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61878
[200]	valid\_0's rmse: 1.61326
[300]	valid\_0's rmse: 1.61198
[400]	valid\_0's rmse: 1.61214
Early stopping, best iteration is:
[378]	valid\_0's rmse: 1.61178
1.6333636157559461
visitId   6
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61809
[200]	valid\_0's rmse: 1.61281
[300]	valid\_0's rmse: 1.61126
Early stopping, best iteration is:
[286]	valid\_0's rmse: 1.61113
1.633193720677367
visitId   7
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61862
[200]	valid\_0's rmse: 1.6119
[300]	valid\_0's rmse: 1.6113
Early stopping, best iteration is:
[258]	valid\_0's rmse: 1.61065
1.6326833257389168
visitId   8
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61853
[200]	valid\_0's rmse: 1.61214
[300]	valid\_0's rmse: 1.61151
[400]	valid\_0's rmse: 1.61177
Early stopping, best iteration is:
[322]	valid\_0's rmse: 1.61093
1.632609217572635
visitId   9
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61913
[200]	valid\_0's rmse: 1.61152
[300]	valid\_0's rmse: 1.61012
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60993
1.6316970234449948
visitId   10
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6183
[200]	valid\_0's rmse: 1.61168
[300]	valid\_0's rmse: 1.61151
[400]	valid\_0's rmse: 1.61267
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.61128
1.6325227565916947
visitId   11
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61882
[200]	valid\_0's rmse: 1.61268
[300]	valid\_0's rmse: 1.61158
Early stopping, best iteration is:
[245]	valid\_0's rmse: 1.61146
1.6335387090220326
visitId   12
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61818
[200]	valid\_0's rmse: 1.61179
[300]	valid\_0's rmse: 1.61033
Early stopping, best iteration is:
[262]	valid\_0's rmse: 1.60985
1.63108894392559
visitId   13
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61776
[200]	valid\_0's rmse: 1.61272
[300]	valid\_0's rmse: 1.6112
[400]	valid\_0's rmse: 1.61252
Early stopping, best iteration is:
[327]	valid\_0's rmse: 1.61085
1.6318148426540853
visitId   14
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61829
[200]	valid\_0's rmse: 1.6127
[300]	valid\_0's rmse: 1.61146
Early stopping, best iteration is:
[288]	valid\_0's rmse: 1.61122
1.6327497440107355
visitId   15
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61675
[200]	valid\_0's rmse: 1.61068
[300]	valid\_0's rmse: 1.61021
Early stopping, best iteration is:
[253]	valid\_0's rmse: 1.60966
1.6318461870692527
visitId   16
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61845
[200]	valid\_0's rmse: 1.6109
[300]	valid\_0's rmse: 1.60939
[400]	valid\_0's rmse: 1.60982
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60922
1.6300612257303966
visitId   17
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61845
[200]	valid\_0's rmse: 1.61336
[300]	valid\_0's rmse: 1.61164
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.61156
1.6331461989927456
visitId   18
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6187
[200]	valid\_0's rmse: 1.61301
[300]	valid\_0's rmse: 1.61176
[400]	valid\_0's rmse: 1.61158
Early stopping, best iteration is:
[394]	valid\_0's rmse: 1.61121
1.631659158656369
visitId   19
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.62001
[200]	valid\_0's rmse: 1.61327
[300]	valid\_0's rmse: 1.61208
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.612
1.6340061937021346
visitId   20
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61829
[200]	valid\_0's rmse: 1.61155
[300]	valid\_0's rmse: 1.61005
[400]	valid\_0's rmse: 1.61083
Early stopping, best iteration is:
[307]	valid\_0's rmse: 1.60969
1.6317313285928672
visitId   21
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61968
[200]	valid\_0's rmse: 1.61306
[300]	valid\_0's rmse: 1.6121
Early stopping, best iteration is:
[289]	valid\_0's rmse: 1.61186
1.6338458979748498
visitId   22
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61806
[200]	valid\_0's rmse: 1.61326
[300]	valid\_0's rmse: 1.61274
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.61262
1.6340891752522442
visitId   23
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.62066
[200]	valid\_0's rmse: 1.61334
[300]	valid\_0's rmse: 1.61388
Early stopping, best iteration is:
[202]	valid\_0's rmse: 1.613
1.6356481110097898
visitId   24
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61823
[200]	valid\_0's rmse: 1.61173
[300]	valid\_0's rmse: 1.61073
[400]	valid\_0's rmse: 1.61183
Early stopping, best iteration is:
[342]	valid\_0's rmse: 1.61043
1.6315818868247434
visitId   25
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61785
[200]	valid\_0's rmse: 1.6139
[300]	valid\_0's rmse: 1.61206
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.61201
1.6339316328914555
visitId   26
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61705
[200]	valid\_0's rmse: 1.61176
[300]	valid\_0's rmse: 1.61219
Early stopping, best iteration is:
[202]	valid\_0's rmse: 1.61163
1.6340306331607968
visitId   27
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6189
[200]	valid\_0's rmse: 1.61145
[300]	valid\_0's rmse: 1.61142
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.61077
1.6332378499115612
visitId   28
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61965
[200]	valid\_0's rmse: 1.61545
[300]	valid\_0's rmse: 1.61423
Early stopping, best iteration is:
[283]	valid\_0's rmse: 1.61405
1.6353145033445626
visitId   29
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61867
[200]	valid\_0's rmse: 1.61327
[300]	valid\_0's rmse: 1.61182
Early stopping, best iteration is:
[249]	valid\_0's rmse: 1.61168
1.6337554291458092
visitId   30
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61797
[200]	valid\_0's rmse: 1.6116
[300]	valid\_0's rmse: 1.61049
Early stopping, best iteration is:
[283]	valid\_0's rmse: 1.61027
1.6319102491095594
visitId   31
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61926
[200]	valid\_0's rmse: 1.6122
[300]	valid\_0's rmse: 1.61055
[400]	valid\_0's rmse: 1.61181
Early stopping, best iteration is:
[301]	valid\_0's rmse: 1.61054
1.6323870397161369
visitId   32
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61903
[200]	valid\_0's rmse: 1.61353
[300]	valid\_0's rmse: 1.61276
Early stopping, best iteration is:
[273]	valid\_0's rmse: 1.61257
1.633772432562727
visitId   33
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61722
[200]	valid\_0's rmse: 1.61117
[300]	valid\_0's rmse: 1.60977
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.60911
1.6309293008684291
visitId   34
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61794
[200]	valid\_0's rmse: 1.61042
[300]	valid\_0's rmse: 1.60871
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60863
1.629324400747333
visitId   35
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61945
[200]	valid\_0's rmse: 1.61256
[300]	valid\_0's rmse: 1.61033
[400]	valid\_0's rmse: 1.61198
Early stopping, best iteration is:
[305]	valid\_0's rmse: 1.61015
1.6319142823336994
visitId   36
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61678
[200]	valid\_0's rmse: 1.61
[300]	valid\_0's rmse: 1.6095
Early stopping, best iteration is:
[235]	valid\_0's rmse: 1.60913
1.6317190687340586
visitId   37
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61972
[200]	valid\_0's rmse: 1.61457
[300]	valid\_0's rmse: 1.61377
[400]	valid\_0's rmse: 1.61465
Early stopping, best iteration is:
[326]	valid\_0's rmse: 1.61352
1.6351695789611636
visitId   38
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61833
[200]	valid\_0's rmse: 1.61155
[300]	valid\_0's rmse: 1.61106
[400]	valid\_0's rmse: 1.61224
Early stopping, best iteration is:
[309]	valid\_0's rmse: 1.61084
1.6321257550352757
visitId   39
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61716
[200]	valid\_0's rmse: 1.61239
[300]	valid\_0's rmse: 1.6116
Early stopping, best iteration is:
[268]	valid\_0's rmse: 1.61136
1.6334765357129615
visitId   40
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61885
[200]	valid\_0's rmse: 1.61246
[300]	valid\_0's rmse: 1.61168
Early stopping, best iteration is:
[235]	valid\_0's rmse: 1.61154
1.633995696408148
visitId   41
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61882
[200]	valid\_0's rmse: 1.61161
[300]	valid\_0's rmse: 1.61119
[400]	valid\_0's rmse: 1.6114
Early stopping, best iteration is:
[371]	valid\_0's rmse: 1.61094
1.6327208270913343
visitId   42
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.619
[200]	valid\_0's rmse: 1.61298
Early stopping, best iteration is:
[199]	valid\_0's rmse: 1.61286
1.6344097727829539
visitId   43
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61854
[200]	valid\_0's rmse: 1.6116
[300]	valid\_0's rmse: 1.6104
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.61032
1.631500921664443
visitId   44
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61735
[200]	valid\_0's rmse: 1.61028
[300]	valid\_0's rmse: 1.60981
[400]	valid\_0's rmse: 1.61077
Early stopping, best iteration is:
[336]	valid\_0's rmse: 1.60979
1.6305247254510307
visitId   45
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61721
[200]	valid\_0's rmse: 1.6115
[300]	valid\_0's rmse: 1.61061
Early stopping, best iteration is:
[273]	valid\_0's rmse: 1.61041
1.6318600601916606
visitId   46
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61947
[200]	valid\_0's rmse: 1.61436
[300]	valid\_0's rmse: 1.6132
Early stopping, best iteration is:
[256]	valid\_0's rmse: 1.61295
1.6339924969857358
visitId   47
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6195
[200]	valid\_0's rmse: 1.61262
[300]	valid\_0's rmse: 1.61178
[400]	valid\_0's rmse: 1.61295
Early stopping, best iteration is:
[326]	valid\_0's rmse: 1.61156
1.6333912398255477
visitId   48
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61789
[200]	valid\_0's rmse: 1.61232
[300]	valid\_0's rmse: 1.61242
Early stopping, best iteration is:
[207]	valid\_0's rmse: 1.61195
1.634047140756213
visitId   49
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61809
[200]	valid\_0's rmse: 1.61109
[300]	valid\_0's rmse: 1.60992
[400]	valid\_0's rmse: 1.61082
Early stopping, best iteration is:
[306]	valid\_0's rmse: 1.60959
1.6314658011871825
visitId   50
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61833
[200]	valid\_0's rmse: 1.61163
[300]	valid\_0's rmse: 1.61067
Early stopping, best iteration is:
[268]	valid\_0's rmse: 1.61039
1.6315487372763149
visitId   51
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61786
[200]	valid\_0's rmse: 1.60991
[300]	valid\_0's rmse: 1.60946
Early stopping, best iteration is:
[285]	valid\_0's rmse: 1.60913
1.6308500536693056
visitId   52
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61664
[200]	valid\_0's rmse: 1.61094
[300]	valid\_0's rmse: 1.6106
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.61007
1.6321987615268274
visitId   53
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61874
[200]	valid\_0's rmse: 1.6133
[300]	valid\_0's rmse: 1.61128
[400]	valid\_0's rmse: 1.61193
Early stopping, best iteration is:
[301]	valid\_0's rmse: 1.61128
1.632949698644953
visitId   54
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61865
[200]	valid\_0's rmse: 1.61187
[300]	valid\_0's rmse: 1.61042
[400]	valid\_0's rmse: 1.61134
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.61033
1.6321651875011582
visitId   55
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61775
[200]	valid\_0's rmse: 1.61174
[300]	valid\_0's rmse: 1.61073
Early stopping, best iteration is:
[289]	valid\_0's rmse: 1.61059
1.6317418568588091
visitId   56
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61929
[200]	valid\_0's rmse: 1.61232
[300]	valid\_0's rmse: 1.61169
[400]	valid\_0's rmse: 1.61261
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.61161
1.633110855855907
visitId   57
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.62061
[200]	valid\_0's rmse: 1.61454
[300]	valid\_0's rmse: 1.61416
Early stopping, best iteration is:
[268]	valid\_0's rmse: 1.61376
1.6342938916792207
visitId   58
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61763
[200]	valid\_0's rmse: 1.61102
[300]	valid\_0's rmse: 1.60991
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60979
1.6315042404320605
visitId   59
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61906
[200]	valid\_0's rmse: 1.61216
[300]	valid\_0's rmse: 1.61138
Early stopping, best iteration is:
[267]	valid\_0's rmse: 1.61109
1.633067726855477
visitId   60
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6178
[200]	valid\_0's rmse: 1.61143
[300]	valid\_0's rmse: 1.61068
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.6106
1.6324154212850464
visitId   61
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61949
[200]	valid\_0's rmse: 1.61199
[300]	valid\_0's rmse: 1.61146
Early stopping, best iteration is:
[234]	valid\_0's rmse: 1.61141
1.6337572615882823
visitId   62
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61813
[200]	valid\_0's rmse: 1.61308
[300]	valid\_0's rmse: 1.61189
Early stopping, best iteration is:
[256]	valid\_0's rmse: 1.61167
1.6336357555574659
visitId   63
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61858
[200]	valid\_0's rmse: 1.61182
[300]	valid\_0's rmse: 1.60958
[400]	valid\_0's rmse: 1.61095
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60938
1.630442688812988
visitId   64
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61877
[200]	valid\_0's rmse: 1.61124
[300]	valid\_0's rmse: 1.6093
[400]	valid\_0's rmse: 1.60991
Early stopping, best iteration is:
[361]	valid\_0's rmse: 1.60892
1.6311351223674024
visitId   65
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61939
[200]	valid\_0's rmse: 1.61356
[300]	valid\_0's rmse: 1.61292
Early stopping, best iteration is:
[247]	valid\_0's rmse: 1.61266
1.6347809585325694
visitId   66
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61813
[200]	valid\_0's rmse: 1.61284
[300]	valid\_0's rmse: 1.61097
Early stopping, best iteration is:
[285]	valid\_0's rmse: 1.61085
1.6322319333635513
visitId   67
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61706
[200]	valid\_0's rmse: 1.61126
[300]	valid\_0's rmse: 1.60949
[400]	valid\_0's rmse: 1.61004
Early stopping, best iteration is:
[300]	valid\_0's rmse: 1.60949
1.6317376456192367
visitId   68
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61861
[200]	valid\_0's rmse: 1.6123
[300]	valid\_0's rmse: 1.61289
Early stopping, best iteration is:
[235]	valid\_0's rmse: 1.61194
1.6344542514000613
visitId   69
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61655
[200]	valid\_0's rmse: 1.60974
[300]	valid\_0's rmse: 1.60922
Early stopping, best iteration is:
[259]	valid\_0's rmse: 1.60897
1.6302293117422322
visitId   70
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61762
[200]	valid\_0's rmse: 1.61075
[300]	valid\_0's rmse: 1.6091
[400]	valid\_0's rmse: 1.60936
Early stopping, best iteration is:
[358]	valid\_0's rmse: 1.60863
1.630345638422814
visitId   71
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61791
[200]	valid\_0's rmse: 1.61198
[300]	valid\_0's rmse: 1.6108
[400]	valid\_0's rmse: 1.61167
Early stopping, best iteration is:
[328]	valid\_0's rmse: 1.61043
1.6314145641845068
visitId   72
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6192
[200]	valid\_0's rmse: 1.61206
[300]	valid\_0's rmse: 1.61104
[400]	valid\_0's rmse: 1.61079
Early stopping, best iteration is:
[384]	valid\_0's rmse: 1.61069
1.6329147941355984
visitId   73
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61851
[200]	valid\_0's rmse: 1.61243
[300]	valid\_0's rmse: 1.61119
[400]	valid\_0's rmse: 1.61223
Early stopping, best iteration is:
[364]	valid\_0's rmse: 1.61105
1.6327046786012243
visitId   74
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61746
[200]	valid\_0's rmse: 1.61079
[300]	valid\_0's rmse: 1.61124
Early stopping, best iteration is:
[202]	valid\_0's rmse: 1.61055
1.6330781667868126
visitId   75
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6172
[200]	valid\_0's rmse: 1.61122
[300]	valid\_0's rmse: 1.60991
[400]	valid\_0's rmse: 1.60999
Early stopping, best iteration is:
[363]	valid\_0's rmse: 1.60924
1.6306707954033164
visitId   76
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61708
[200]	valid\_0's rmse: 1.6109
Early stopping, best iteration is:
[199]	valid\_0's rmse: 1.61073
1.6327626643908841
visitId   77
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61889
[200]	valid\_0's rmse: 1.61298
[300]	valid\_0's rmse: 1.61313
Early stopping, best iteration is:
[202]	valid\_0's rmse: 1.61242
1.635270152245707
visitId   78
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61885
[200]	valid\_0's rmse: 1.61217
[300]	valid\_0's rmse: 1.61044
[400]	valid\_0's rmse: 1.61184
Early stopping, best iteration is:
[326]	valid\_0's rmse: 1.61034
1.631935896815351
visitId   79
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61858
[200]	valid\_0's rmse: 1.61144
[300]	valid\_0's rmse: 1.61235
Early stopping, best iteration is:
[200]	valid\_0's rmse: 1.61144
1.6329764342309208
visitId   80
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61797
[200]	valid\_0's rmse: 1.61197
[300]	valid\_0's rmse: 1.61054
Early stopping, best iteration is:
[273]	valid\_0's rmse: 1.61012
1.6310716106511842
visitId   81
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61918
[200]	valid\_0's rmse: 1.61279
[300]	valid\_0's rmse: 1.61155
[400]	valid\_0's rmse: 1.61232
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.61122
1.6326801872797259
visitId   82
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61773
[200]	valid\_0's rmse: 1.6118
[300]	valid\_0's rmse: 1.61057
[400]	valid\_0's rmse: 1.6108
Early stopping, best iteration is:
[309]	valid\_0's rmse: 1.61033
1.6317874695344379
visitId   83
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61876
[200]	valid\_0's rmse: 1.61128
[300]	valid\_0's rmse: 1.6096
[400]	valid\_0's rmse: 1.61024
Early stopping, best iteration is:
[334]	valid\_0's rmse: 1.60914
1.6303584737960375
visitId   84
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61852
[200]	valid\_0's rmse: 1.6128
[300]	valid\_0's rmse: 1.61132
Early stopping, best iteration is:
[286]	valid\_0's rmse: 1.61116
1.6329892813624023
visitId   85
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61838
[200]	valid\_0's rmse: 1.6108
[300]	valid\_0's rmse: 1.61018
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.61013
1.6323962799488123
visitId   86
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61787
[200]	valid\_0's rmse: 1.61205
[300]	valid\_0's rmse: 1.61085
Early stopping, best iteration is:
[299]	valid\_0's rmse: 1.61083
1.632072806130889
visitId   87
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61843
[200]	valid\_0's rmse: 1.61156
[300]	valid\_0's rmse: 1.61116
[400]	valid\_0's rmse: 1.61138
Early stopping, best iteration is:
[382]	valid\_0's rmse: 1.61072
1.6321735772237331
visitId   88
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61951
[200]	valid\_0's rmse: 1.61254
[300]	valid\_0's rmse: 1.61166
[400]	valid\_0's rmse: 1.61342
Early stopping, best iteration is:
[323]	valid\_0's rmse: 1.61153
1.6321782555838886
visitId   89
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61798
[200]	valid\_0's rmse: 1.61195
[300]	valid\_0's rmse: 1.61163
Early stopping, best iteration is:
[250]	valid\_0's rmse: 1.61032
1.6325631381098755
visitId   90
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61871
[200]	valid\_0's rmse: 1.61342
[300]	valid\_0's rmse: 1.61194
Early stopping, best iteration is:
[273]	valid\_0's rmse: 1.6114
1.6325530813008742
visitId   91
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61915
[200]	valid\_0's rmse: 1.61322
[300]	valid\_0's rmse: 1.61221
Early stopping, best iteration is:
[262]	valid\_0's rmse: 1.61183
1.6339727821644152
visitId   92
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61751
[200]	valid\_0's rmse: 1.6112
[300]	valid\_0's rmse: 1.60883
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60878
1.630375517364121
visitId   93
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61955
[200]	valid\_0's rmse: 1.61242
[300]	valid\_0's rmse: 1.61153
[400]	valid\_0's rmse: 1.61275
Early stopping, best iteration is:
[315]	valid\_0's rmse: 1.6114
1.6332351249796342
visitId   94
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61922
[200]	valid\_0's rmse: 1.61252
[300]	valid\_0's rmse: 1.61139
[400]	valid\_0's rmse: 1.61232
Early stopping, best iteration is:
[320]	valid\_0's rmse: 1.61128
1.6323583645786948
visitId   95
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61959
[200]	valid\_0's rmse: 1.61203
[300]	valid\_0's rmse: 1.61121
[400]	valid\_0's rmse: 1.613
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.61091
1.633337320698713
visitId   96
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.62023
[200]	valid\_0's rmse: 1.61294
[300]	valid\_0's rmse: 1.61234
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.61228
1.6339594085897122
visitId   97
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61865
[200]	valid\_0's rmse: 1.61119
[300]	valid\_0's rmse: 1.61147
Early stopping, best iteration is:
[229]	valid\_0's rmse: 1.61088
1.6331451820179088
visitId   98
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61771
[200]	valid\_0's rmse: 1.612
[300]	valid\_0's rmse: 1.61178
Early stopping, best iteration is:
[268]	valid\_0's rmse: 1.61132
1.6330723001212948
visitId   99
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61845
[200]	valid\_0's rmse: 1.6119
[300]	valid\_0's rmse: 1.61146
Early stopping, best iteration is:
[229]	valid\_0's rmse: 1.61134
1.6336832488152448
totals\_newVisits   0
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61455
[200]	valid\_0's rmse: 1.60731
[300]	valid\_0's rmse: 1.6059
[400]	valid\_0's rmse: 1.60601
Early stopping, best iteration is:
[360]	valid\_0's rmse: 1.60515
1.6274320789351469
totals\_newVisits   1
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61529
[200]	valid\_0's rmse: 1.60831
[300]	valid\_0's rmse: 1.60762
Early stopping, best iteration is:
[235]	valid\_0's rmse: 1.60707
1.629823688096823
totals\_newVisits   2
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61505
[200]	valid\_0's rmse: 1.60773
[300]	valid\_0's rmse: 1.60533
[400]	valid\_0's rmse: 1.60686
Early stopping, best iteration is:
[305]	valid\_0's rmse: 1.60526
1.627275142586443
totals\_newVisits   3
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61444
[200]	valid\_0's rmse: 1.60714
[300]	valid\_0's rmse: 1.60615
[400]	valid\_0's rmse: 1.60614
Early stopping, best iteration is:
[314]	valid\_0's rmse: 1.60557
1.6278359137129508
totals\_newVisits   4
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61523
[200]	valid\_0's rmse: 1.6078
[300]	valid\_0's rmse: 1.60625
[400]	valid\_0's rmse: 1.60713
Early stopping, best iteration is:
[301]	valid\_0's rmse: 1.60624
1.6283797183587323
totals\_newVisits   5
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61475
[200]	valid\_0's rmse: 1.60732
[300]	valid\_0's rmse: 1.60613
[400]	valid\_0's rmse: 1.60736
Early stopping, best iteration is:
[306]	valid\_0's rmse: 1.6058
1.628572791758939
totals\_newVisits   6
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61516
[200]	valid\_0's rmse: 1.60873
[300]	valid\_0's rmse: 1.60683
Early stopping, best iteration is:
[293]	valid\_0's rmse: 1.60653
1.628421153110338
totals\_newVisits   7
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61386
[200]	valid\_0's rmse: 1.60763
[300]	valid\_0's rmse: 1.60538
[400]	valid\_0's rmse: 1.60519
Early stopping, best iteration is:
[305]	valid\_0's rmse: 1.60499
1.627167446436141
totals\_newVisits   8
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61403
[200]	valid\_0's rmse: 1.60799
[300]	valid\_0's rmse: 1.60593
[400]	valid\_0's rmse: 1.60834
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60587
1.6284470445935963
totals\_newVisits   9
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61502
[200]	valid\_0's rmse: 1.60894
[300]	valid\_0's rmse: 1.6081
Early stopping, best iteration is:
[226]	valid\_0's rmse: 1.60757
1.6303360073000186
totals\_newVisits   10
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61314
[200]	valid\_0's rmse: 1.60528
[300]	valid\_0's rmse: 1.60416
[400]	valid\_0's rmse: 1.60473
Early stopping, best iteration is:
[313]	valid\_0's rmse: 1.60386
1.626425225666219
totals\_newVisits   11
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61454
[200]	valid\_0's rmse: 1.60782
[300]	valid\_0's rmse: 1.60654
[400]	valid\_0's rmse: 1.60722
Early stopping, best iteration is:
[324]	valid\_0's rmse: 1.60633
1.6283504688062391
totals\_newVisits   12
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6145
[200]	valid\_0's rmse: 1.60773
[300]	valid\_0's rmse: 1.60577
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.60523
1.6273325366631595
totals\_newVisits   13
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6138
[200]	valid\_0's rmse: 1.60671
[300]	valid\_0's rmse: 1.60563
[400]	valid\_0's rmse: 1.60685
Early stopping, best iteration is:
[321]	valid\_0's rmse: 1.60532
1.6274591171814734
totals\_newVisits   14
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61413
[200]	valid\_0's rmse: 1.60693
[300]	valid\_0's rmse: 1.60526
[400]	valid\_0's rmse: 1.6065
Early stopping, best iteration is:
[309]	valid\_0's rmse: 1.6052
1.6257587448933537
totals\_newVisits   15
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61367
[200]	valid\_0's rmse: 1.60575
[300]	valid\_0's rmse: 1.60489
[400]	valid\_0's rmse: 1.60557
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60484
1.6278058122668837
totals\_newVisits   16
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61669
[200]	valid\_0's rmse: 1.60791
[300]	valid\_0's rmse: 1.60695
Early stopping, best iteration is:
[266]	valid\_0's rmse: 1.60668
1.6281416655774368
totals\_newVisits   17
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61485
[200]	valid\_0's rmse: 1.61005
[300]	valid\_0's rmse: 1.60946
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60931
1.6311403645153786
totals\_newVisits   18
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61326
[200]	valid\_0's rmse: 1.60665
[300]	valid\_0's rmse: 1.60547
Early stopping, best iteration is:
[259]	valid\_0's rmse: 1.60508
1.6277490735745674
totals\_newVisits   19
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61448
[200]	valid\_0's rmse: 1.60753
[300]	valid\_0's rmse: 1.60565
Early stopping, best iteration is:
[288]	valid\_0's rmse: 1.60545
1.6280115437715323
totals\_newVisits   20
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61546
[200]	valid\_0's rmse: 1.60939
[300]	valid\_0's rmse: 1.6084
Early stopping, best iteration is:
[262]	valid\_0's rmse: 1.60807
1.6298726480490675
totals\_newVisits   21
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61497
[200]	valid\_0's rmse: 1.60757
[300]	valid\_0's rmse: 1.60723
[400]	valid\_0's rmse: 1.6085
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60723
1.6292539128827075
totals\_newVisits   22
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61458
[200]	valid\_0's rmse: 1.60746
[300]	valid\_0's rmse: 1.60545
[400]	valid\_0's rmse: 1.60599
Early stopping, best iteration is:
[326]	valid\_0's rmse: 1.60515
1.6271084062213792
totals\_newVisits   23
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61641
[200]	valid\_0's rmse: 1.61004
[300]	valid\_0's rmse: 1.60834
[400]	valid\_0's rmse: 1.6103
Early stopping, best iteration is:
[321]	valid\_0's rmse: 1.60777
1.6291009081534027
totals\_newVisits   24
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61406
[200]	valid\_0's rmse: 1.60775
[300]	valid\_0's rmse: 1.60632
[400]	valid\_0's rmse: 1.60677
Early stopping, best iteration is:
[369]	valid\_0's rmse: 1.60621
1.627845047460162
totals\_newVisits   25
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61435
[200]	valid\_0's rmse: 1.60689
[300]	valid\_0's rmse: 1.60554
[400]	valid\_0's rmse: 1.60636
Early stopping, best iteration is:
[317]	valid\_0's rmse: 1.60528
1.6276734805963624
totals\_newVisits   26
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61625
[200]	valid\_0's rmse: 1.60835
[300]	valid\_0's rmse: 1.60722
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60685
1.629065404851213
totals\_newVisits   27
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61341
[200]	valid\_0's rmse: 1.60656
[300]	valid\_0's rmse: 1.60582
[400]	valid\_0's rmse: 1.60699
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60548
1.627479827903906
totals\_newVisits   28
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61518
[200]	valid\_0's rmse: 1.60884
[300]	valid\_0's rmse: 1.60721
[400]	valid\_0's rmse: 1.6081
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60694
1.6290985583252227
totals\_newVisits   29
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61449
[200]	valid\_0's rmse: 1.60878
[300]	valid\_0's rmse: 1.60876
Early stopping, best iteration is:
[240]	valid\_0's rmse: 1.60774
1.6295398714690486
totals\_newVisits   30
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61532
[200]	valid\_0's rmse: 1.60798
[300]	valid\_0's rmse: 1.60633
[400]	valid\_0's rmse: 1.60721
Early stopping, best iteration is:
[332]	valid\_0's rmse: 1.60597
1.6274869889213421
totals\_newVisits   31
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61485
[200]	valid\_0's rmse: 1.60805
[300]	valid\_0's rmse: 1.60588
[400]	valid\_0's rmse: 1.60677
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60584
1.6271439861681671
totals\_newVisits   32
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61447
[200]	valid\_0's rmse: 1.60674
[300]	valid\_0's rmse: 1.60594
[400]	valid\_0's rmse: 1.60729
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60589
1.6283773472565062
totals\_newVisits   33
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61373
[200]	valid\_0's rmse: 1.60608
Early stopping, best iteration is:
[195]	valid\_0's rmse: 1.606
1.6290771594393634
totals\_newVisits   34
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61382
[200]	valid\_0's rmse: 1.60683
[300]	valid\_0's rmse: 1.60643
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60632
1.6292023645242135
totals\_newVisits   35
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61485
[200]	valid\_0's rmse: 1.60735
[300]	valid\_0's rmse: 1.60612
Early stopping, best iteration is:
[292]	valid\_0's rmse: 1.60596
1.6283856743096685
totals\_newVisits   36
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6138
[200]	valid\_0's rmse: 1.6073
[300]	valid\_0's rmse: 1.60622
Early stopping, best iteration is:
[289]	valid\_0's rmse: 1.60585
1.628363040398834
totals\_newVisits   37
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61521
[200]	valid\_0's rmse: 1.60935
[300]	valid\_0's rmse: 1.6079
[400]	valid\_0's rmse: 1.60878
Early stopping, best iteration is:
[317]	valid\_0's rmse: 1.60768
1.6294248257671067
totals\_newVisits   38
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61392
[200]	valid\_0's rmse: 1.60632
[300]	valid\_0's rmse: 1.60421
[400]	valid\_0's rmse: 1.60634
Early stopping, best iteration is:
[314]	valid\_0's rmse: 1.60389
1.6266400914355998
totals\_newVisits   39
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6143
[200]	valid\_0's rmse: 1.60707
[300]	valid\_0's rmse: 1.60626
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60614
1.6286591540837534
totals\_newVisits   40
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61451
[200]	valid\_0's rmse: 1.60766
[300]	valid\_0's rmse: 1.60553
Early stopping, best iteration is:
[288]	valid\_0's rmse: 1.60526
1.6271301183473166
totals\_newVisits   41
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6147
[200]	valid\_0's rmse: 1.60725
[300]	valid\_0's rmse: 1.6064
Early stopping, best iteration is:
[262]	valid\_0's rmse: 1.60573
1.6280679321472529
totals\_newVisits   42
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61526
[200]	valid\_0's rmse: 1.60689
[300]	valid\_0's rmse: 1.6053
[400]	valid\_0's rmse: 1.60584
Early stopping, best iteration is:
[320]	valid\_0's rmse: 1.60462
1.6261883201516514
totals\_newVisits   43
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61408
[200]	valid\_0's rmse: 1.60633
[300]	valid\_0's rmse: 1.60461
[400]	valid\_0's rmse: 1.60481
Early stopping, best iteration is:
[306]	valid\_0's rmse: 1.60442
1.6267923952381076
totals\_newVisits   44
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6147
[200]	valid\_0's rmse: 1.60794
[300]	valid\_0's rmse: 1.60677
[400]	valid\_0's rmse: 1.60808
Early stopping, best iteration is:
[324]	valid\_0's rmse: 1.60621
1.62801168041056
totals\_newVisits   45
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61471
[200]	valid\_0's rmse: 1.60814
[300]	valid\_0's rmse: 1.60633
Early stopping, best iteration is:
[274]	valid\_0's rmse: 1.60626
1.6283250407124814
totals\_newVisits   46
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61459
[200]	valid\_0's rmse: 1.60748
[300]	valid\_0's rmse: 1.60592
[400]	valid\_0's rmse: 1.60732
Early stopping, best iteration is:
[334]	valid\_0's rmse: 1.60536
1.6273760314900918
totals\_newVisits   47
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61373
[200]	valid\_0's rmse: 1.60692
[300]	valid\_0's rmse: 1.60468
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.6046
1.6269499845533486
totals\_newVisits   48
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61483
[200]	valid\_0's rmse: 1.60756
[300]	valid\_0's rmse: 1.60587
[400]	valid\_0's rmse: 1.60709
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60544
1.6274806026824145
totals\_newVisits   49
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61621
[200]	valid\_0's rmse: 1.60824
[300]	valid\_0's rmse: 1.60795
Early stopping, best iteration is:
[266]	valid\_0's rmse: 1.60745
1.6303485208051316
totals\_newVisits   50
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61488
[200]	valid\_0's rmse: 1.60841
[300]	valid\_0's rmse: 1.60686
Early stopping, best iteration is:
[273]	valid\_0's rmse: 1.60647
1.6284440893533016
totals\_newVisits   51
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61539
[200]	valid\_0's rmse: 1.60888
[300]	valid\_0's rmse: 1.60724
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60715
1.6291350286085027
totals\_newVisits   52
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61553
[200]	valid\_0's rmse: 1.60737
[300]	valid\_0's rmse: 1.60581
[400]	valid\_0's rmse: 1.60715
Early stopping, best iteration is:
[305]	valid\_0's rmse: 1.60565
1.628381000181784
totals\_newVisits   53
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61496
[200]	valid\_0's rmse: 1.60794
[300]	valid\_0's rmse: 1.60697
Early stopping, best iteration is:
[292]	valid\_0's rmse: 1.60688
1.6292481493040039
totals\_newVisits   54
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61458
[200]	valid\_0's rmse: 1.6076
[300]	valid\_0's rmse: 1.60608
[400]	valid\_0's rmse: 1.60764
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60601
1.6278611738863464
totals\_newVisits   55
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61404
[200]	valid\_0's rmse: 1.60686
[300]	valid\_0's rmse: 1.60516
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.6051
1.628033139552096
totals\_newVisits   56
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61495
[200]	valid\_0's rmse: 1.60686
[300]	valid\_0's rmse: 1.60558
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60532
1.6269768167152543
totals\_newVisits   57
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61468
[200]	valid\_0's rmse: 1.60597
[300]	valid\_0's rmse: 1.60507
[400]	valid\_0's rmse: 1.60654
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60499
1.6275628120695633
totals\_newVisits   58
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61402
[200]	valid\_0's rmse: 1.60752
[300]	valid\_0's rmse: 1.60711
[400]	valid\_0's rmse: 1.60694
Early stopping, best iteration is:
[377]	valid\_0's rmse: 1.60672
1.6285849483981747
totals\_newVisits   59
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61575
[200]	valid\_0's rmse: 1.6098
[300]	valid\_0's rmse: 1.60745
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60733
1.629071448053123
totals\_newVisits   60
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61592
[200]	valid\_0's rmse: 1.60874
[300]	valid\_0's rmse: 1.60847
Early stopping, best iteration is:
[235]	valid\_0's rmse: 1.60825
1.6302741215472245
totals\_newVisits   61
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61596
[200]	valid\_0's rmse: 1.60786
[300]	valid\_0's rmse: 1.60618
[400]	valid\_0's rmse: 1.60606
Early stopping, best iteration is:
[328]	valid\_0's rmse: 1.60572
1.6284130223663709
totals\_newVisits   62
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61493
[200]	valid\_0's rmse: 1.60808
[300]	valid\_0's rmse: 1.60574
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60563
1.628183188209762
totals\_newVisits   63
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61476
[200]	valid\_0's rmse: 1.6077
[300]	valid\_0's rmse: 1.60524
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60513
1.6278098114205417
totals\_newVisits   64
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61471
[200]	valid\_0's rmse: 1.60781
[300]	valid\_0's rmse: 1.60622
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60619
1.629101824033085
totals\_newVisits   65
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61443
[200]	valid\_0's rmse: 1.60746
[300]	valid\_0's rmse: 1.60627
Early stopping, best iteration is:
[285]	valid\_0's rmse: 1.60617
1.6279956511021636
totals\_newVisits   66
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61533
[200]	valid\_0's rmse: 1.60796
[300]	valid\_0's rmse: 1.60712
[400]	valid\_0's rmse: 1.60695
Early stopping, best iteration is:
[371]	valid\_0's rmse: 1.6066
1.6282488369519972
totals\_newVisits   67
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61482
[200]	valid\_0's rmse: 1.60741
[300]	valid\_0's rmse: 1.60602
[400]	valid\_0's rmse: 1.60601
Early stopping, best iteration is:
[368]	valid\_0's rmse: 1.60517
1.627687970370403
totals\_newVisits   68
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61399
[200]	valid\_0's rmse: 1.60744
[300]	valid\_0's rmse: 1.60612
[400]	valid\_0's rmse: 1.60701
Early stopping, best iteration is:
[315]	valid\_0's rmse: 1.60584
1.6284677872632427
totals\_newVisits   69
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61445
[200]	valid\_0's rmse: 1.60868
[300]	valid\_0's rmse: 1.60657
[400]	valid\_0's rmse: 1.60672
Early stopping, best iteration is:
[388]	valid\_0's rmse: 1.60624
1.6280543733332375
totals\_newVisits   70
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61479
[200]	valid\_0's rmse: 1.60718
[300]	valid\_0's rmse: 1.607
Early stopping, best iteration is:
[249]	valid\_0's rmse: 1.60644
1.6290838842387574
totals\_newVisits   71
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61492
[200]	valid\_0's rmse: 1.60624
[300]	valid\_0's rmse: 1.60521
[400]	valid\_0's rmse: 1.60591
Early stopping, best iteration is:
[306]	valid\_0's rmse: 1.60516
1.6272913459620197
totals\_newVisits   72
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61547
[200]	valid\_0's rmse: 1.60757
[300]	valid\_0's rmse: 1.60555
[400]	valid\_0's rmse: 1.60617
Early stopping, best iteration is:
[321]	valid\_0's rmse: 1.60534
1.6269745954086097
totals\_newVisits   73
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61498
[200]	valid\_0's rmse: 1.60727
[300]	valid\_0's rmse: 1.60565
[400]	valid\_0's rmse: 1.60691
Early stopping, best iteration is:
[300]	valid\_0's rmse: 1.60565
1.627380144920987
totals\_newVisits   74
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61294
[200]	valid\_0's rmse: 1.60692
[300]	valid\_0's rmse: 1.60517
Early stopping, best iteration is:
[295]	valid\_0's rmse: 1.60502
1.6274705173244992
totals\_newVisits   75
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61378
[200]	valid\_0's rmse: 1.60581
[300]	valid\_0's rmse: 1.60483
[400]	valid\_0's rmse: 1.60584
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.6046
1.62661575027649
totals\_newVisits   76
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61498
[200]	valid\_0's rmse: 1.60827
[300]	valid\_0's rmse: 1.60685
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60673
1.6289527110713558
totals\_newVisits   77
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61431
[200]	valid\_0's rmse: 1.60667
[300]	valid\_0's rmse: 1.60556
[400]	valid\_0's rmse: 1.60567
Early stopping, best iteration is:
[371]	valid\_0's rmse: 1.60519
1.6274934264480547
totals\_newVisits   78
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61413
[200]	valid\_0's rmse: 1.60679
[300]	valid\_0's rmse: 1.60664
[400]	valid\_0's rmse: 1.60778
Early stopping, best iteration is:
[322]	valid\_0's rmse: 1.60616
1.6275777419231476
totals\_newVisits   79
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61531
[200]	valid\_0's rmse: 1.60895
[300]	valid\_0's rmse: 1.60757
[400]	valid\_0's rmse: 1.60761
Early stopping, best iteration is:
[389]	valid\_0's rmse: 1.60715
1.6281380798938194
totals\_newVisits   80
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6145
[200]	valid\_0's rmse: 1.607
[300]	valid\_0's rmse: 1.60689
[400]	valid\_0's rmse: 1.60766
Early stopping, best iteration is:
[333]	valid\_0's rmse: 1.60653
1.6289679745294454
totals\_newVisits   81
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61516
[200]	valid\_0's rmse: 1.60839
[300]	valid\_0's rmse: 1.60729
[400]	valid\_0's rmse: 1.60884
Early stopping, best iteration is:
[309]	valid\_0's rmse: 1.60713
1.6284323335209456
totals\_newVisits   82
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61477
[200]	valid\_0's rmse: 1.6069
[300]	valid\_0's rmse: 1.60604
Early stopping, best iteration is:
[286]	valid\_0's rmse: 1.60553
1.6270349224988376
totals\_newVisits   83
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61501
[200]	valid\_0's rmse: 1.60692
[300]	valid\_0's rmse: 1.60575
[400]	valid\_0's rmse: 1.60743
Early stopping, best iteration is:
[305]	valid\_0's rmse: 1.60561
1.628413199444522
totals\_newVisits   84
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61455
[200]	valid\_0's rmse: 1.609
[300]	valid\_0's rmse: 1.60534
[400]	valid\_0's rmse: 1.60696
Early stopping, best iteration is:
[317]	valid\_0's rmse: 1.60495
1.6277114448520473
totals\_newVisits   85
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61467
[200]	valid\_0's rmse: 1.60855
[300]	valid\_0's rmse: 1.60689
[400]	valid\_0's rmse: 1.60624
[500]	valid\_0's rmse: 1.60891
Early stopping, best iteration is:
[410]	valid\_0's rmse: 1.60618
1.627611957572389
totals\_newVisits   86
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61488
[200]	valid\_0's rmse: 1.6073
[300]	valid\_0's rmse: 1.60513
Early stopping, best iteration is:
[298]	valid\_0's rmse: 1.60511
1.6272716762822643
totals\_newVisits   87
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61373
[200]	valid\_0's rmse: 1.60735
[300]	valid\_0's rmse: 1.60607
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60592
1.6278972732921246
totals\_newVisits   88
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61524
[200]	valid\_0's rmse: 1.60764
[300]	valid\_0's rmse: 1.60582
[400]	valid\_0's rmse: 1.60459
Early stopping, best iteration is:
[389]	valid\_0's rmse: 1.60442
1.626969497235188
totals\_newVisits   89
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61399
[200]	valid\_0's rmse: 1.60771
[300]	valid\_0's rmse: 1.60589
[400]	valid\_0's rmse: 1.60662
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60583
1.6282201812021273
totals\_newVisits   90
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61474
[200]	valid\_0's rmse: 1.60644
[300]	valid\_0's rmse: 1.60639
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60611
1.6282417177857893
totals\_newVisits   91
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61461
[200]	valid\_0's rmse: 1.60712
[300]	valid\_0's rmse: 1.60551
Early stopping, best iteration is:
[299]	valid\_0's rmse: 1.60549
1.6279344546560666
totals\_newVisits   92
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61377
[200]	valid\_0's rmse: 1.60703
[300]	valid\_0's rmse: 1.6054
Early stopping, best iteration is:
[294]	valid\_0's rmse: 1.60517
1.6276108767857316
totals\_newVisits   93
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61501
[200]	valid\_0's rmse: 1.60776
[300]	valid\_0's rmse: 1.60586
[400]	valid\_0's rmse: 1.60609
Early stopping, best iteration is:
[378]	valid\_0's rmse: 1.60563
1.6272708652520782
totals\_newVisits   94
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6139
[200]	valid\_0's rmse: 1.60835
[300]	valid\_0's rmse: 1.60662
[400]	valid\_0's rmse: 1.6062
Early stopping, best iteration is:
[370]	valid\_0's rmse: 1.60586
1.6274406874261331
totals\_newVisits   95
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61381
[200]	valid\_0's rmse: 1.60669
[300]	valid\_0's rmse: 1.60536
Early stopping, best iteration is:
[292]	valid\_0's rmse: 1.60516
1.6275801011245814
totals\_newVisits   96
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61438
[200]	valid\_0's rmse: 1.60857
[300]	valid\_0's rmse: 1.60727
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.6072
1.6291823696042609
totals\_newVisits   97
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61463
[200]	valid\_0's rmse: 1.6093
[300]	valid\_0's rmse: 1.6085
Early stopping, best iteration is:
[240]	valid\_0's rmse: 1.60841
1.6313189072346792
totals\_newVisits   98
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61456
[200]	valid\_0's rmse: 1.60675
[300]	valid\_0's rmse: 1.60708
Early stopping, best iteration is:
[226]	valid\_0's rmse: 1.60601
1.6282304011653423
totals\_newVisits   99
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61488
[200]	valid\_0's rmse: 1.60703
[300]	valid\_0's rmse: 1.60712
Early stopping, best iteration is:
[255]	valid\_0's rmse: 1.60677
1.629630721419308
geoNetwork\_continent   0
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61582
[200]	valid\_0's rmse: 1.60934
[300]	valid\_0's rmse: 1.60846
Early stopping, best iteration is:
[288]	valid\_0's rmse: 1.60796
1.6295654133362625
geoNetwork\_continent   1
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61672
[200]	valid\_0's rmse: 1.60948
[300]	valid\_0's rmse: 1.60937
Early stopping, best iteration is:
[288]	valid\_0's rmse: 1.60921
1.6308633918902784
geoNetwork\_continent   2
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61518
[200]	valid\_0's rmse: 1.6092
[300]	valid\_0's rmse: 1.60734
[400]	valid\_0's rmse: 1.60757
Early stopping, best iteration is:
[339]	valid\_0's rmse: 1.60702
1.6287032844982348
geoNetwork\_continent   3
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61414
[200]	valid\_0's rmse: 1.60771
[300]	valid\_0's rmse: 1.60654
Early stopping, best iteration is:
[292]	valid\_0's rmse: 1.60637
1.6286285097842543
geoNetwork\_continent   4
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61672
[200]	valid\_0's rmse: 1.60868
[300]	valid\_0's rmse: 1.60713
[400]	valid\_0's rmse: 1.60847
Early stopping, best iteration is:
[334]	valid\_0's rmse: 1.60708
1.6279388162888302
geoNetwork\_continent   5
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61638
[200]	valid\_0's rmse: 1.60954
[300]	valid\_0's rmse: 1.60713
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60698
1.6282537723603832
geoNetwork\_continent   6
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6159
[200]	valid\_0's rmse: 1.60825
[300]	valid\_0's rmse: 1.60598
Early stopping, best iteration is:
[295]	valid\_0's rmse: 1.60576
1.6274247275380447
geoNetwork\_continent   7
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61606
[200]	valid\_0's rmse: 1.60946
[300]	valid\_0's rmse: 1.60697
[400]	valid\_0's rmse: 1.60858
Early stopping, best iteration is:
[301]	valid\_0's rmse: 1.60696
1.6285100416508975
geoNetwork\_continent   8
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61672
[200]	valid\_0's rmse: 1.60965
[300]	valid\_0's rmse: 1.60827
Early stopping, best iteration is:
[286]	valid\_0's rmse: 1.60789
1.6292690742665998
geoNetwork\_continent   9
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61528
[200]	valid\_0's rmse: 1.60805
[300]	valid\_0's rmse: 1.60657
[400]	valid\_0's rmse: 1.60743
Early stopping, best iteration is:
[321]	valid\_0's rmse: 1.60632
1.6276895777949123
geoNetwork\_continent   10
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61558
[200]	valid\_0's rmse: 1.60878
[300]	valid\_0's rmse: 1.60842
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.60812
1.6300356376517096
geoNetwork\_continent   11
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61555
[200]	valid\_0's rmse: 1.60815
[300]	valid\_0's rmse: 1.60664
[400]	valid\_0's rmse: 1.60648
Early stopping, best iteration is:
[370]	valid\_0's rmse: 1.60609
1.6274293000797297
geoNetwork\_continent   12
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61546
[200]	valid\_0's rmse: 1.6088
[300]	valid\_0's rmse: 1.60712
Early stopping, best iteration is:
[298]	valid\_0's rmse: 1.60709
1.6290887800623004
geoNetwork\_continent   13
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61712
[200]	valid\_0's rmse: 1.60935
[300]	valid\_0's rmse: 1.60867
Early stopping, best iteration is:
[267]	valid\_0's rmse: 1.60843
1.6298403103164696
geoNetwork\_continent   14
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61636
[200]	valid\_0's rmse: 1.60851
[300]	valid\_0's rmse: 1.60707
[400]	valid\_0's rmse: 1.60854
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60701
1.6287719469085655
geoNetwork\_continent   15
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6157
[200]	valid\_0's rmse: 1.60745
[300]	valid\_0's rmse: 1.60728
Early stopping, best iteration is:
[285]	valid\_0's rmse: 1.607
1.6288590228428401
geoNetwork\_continent   16
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61525
[200]	valid\_0's rmse: 1.60862
[300]	valid\_0's rmse: 1.60704
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60695
1.62834628453936
geoNetwork\_continent   17
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61636
[200]	valid\_0's rmse: 1.60965
[300]	valid\_0's rmse: 1.60748
[400]	valid\_0's rmse: 1.60852
Early stopping, best iteration is:
[320]	valid\_0's rmse: 1.60699
1.6283713459784788
geoNetwork\_continent   18
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61579
[200]	valid\_0's rmse: 1.61034
[300]	valid\_0's rmse: 1.60914
[400]	valid\_0's rmse: 1.60929
Early stopping, best iteration is:
[371]	valid\_0's rmse: 1.60844
1.6294619758816888
geoNetwork\_continent   19
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61577
[200]	valid\_0's rmse: 1.60956
[300]	valid\_0's rmse: 1.6082
Early stopping, best iteration is:
[246]	valid\_0's rmse: 1.60782
1.6305832837859455
geoNetwork\_continent   20
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61584
[200]	valid\_0's rmse: 1.60809
[300]	valid\_0's rmse: 1.60697
Early stopping, best iteration is:
[292]	valid\_0's rmse: 1.60681
1.6279382759650158
geoNetwork\_continent   21
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61521
[200]	valid\_0's rmse: 1.60885
[300]	valid\_0's rmse: 1.60791
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.6069
1.6284213514526618
geoNetwork\_continent   22
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61615
[200]	valid\_0's rmse: 1.61015
[300]	valid\_0's rmse: 1.60748
[400]	valid\_0's rmse: 1.60801
Early stopping, best iteration is:
[326]	valid\_0's rmse: 1.60691
1.6286370427002068
geoNetwork\_continent   23
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61676
[200]	valid\_0's rmse: 1.60999
[300]	valid\_0's rmse: 1.60851
Early stopping, best iteration is:
[268]	valid\_0's rmse: 1.60834
1.6298429530565288
geoNetwork\_continent   24
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61644
[200]	valid\_0's rmse: 1.6083
[300]	valid\_0's rmse: 1.60748
[400]	valid\_0's rmse: 1.608
Early stopping, best iteration is:
[323]	valid\_0's rmse: 1.60718
1.628224201477644
geoNetwork\_continent   25
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61572
[200]	valid\_0's rmse: 1.60969
[300]	valid\_0's rmse: 1.60799
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60786
1.629634499301745
geoNetwork\_continent   26
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61591
[200]	valid\_0's rmse: 1.60797
[300]	valid\_0's rmse: 1.60628
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60623
1.6279492181843391
geoNetwork\_continent   27
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61515
[200]	valid\_0's rmse: 1.60812
[300]	valid\_0's rmse: 1.60711
Early stopping, best iteration is:
[267]	valid\_0's rmse: 1.60694
1.6281534526322199
geoNetwork\_continent   28
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61645
[200]	valid\_0's rmse: 1.60927
[300]	valid\_0's rmse: 1.60797
Early stopping, best iteration is:
[285]	valid\_0's rmse: 1.60776
1.6294508604069005
geoNetwork\_continent   29
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.615
[200]	valid\_0's rmse: 1.60964
[300]	valid\_0's rmse: 1.60868
[400]	valid\_0's rmse: 1.60826
Early stopping, best iteration is:
[340]	valid\_0's rmse: 1.60783
1.6292837108356588
geoNetwork\_continent   30
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6159
[200]	valid\_0's rmse: 1.60952
[300]	valid\_0's rmse: 1.60839
Early stopping, best iteration is:
[235]	valid\_0's rmse: 1.60796
1.6296139839196366
geoNetwork\_continent   31
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61584
[200]	valid\_0's rmse: 1.60919
[300]	valid\_0's rmse: 1.60789
Early stopping, best iteration is:
[287]	valid\_0's rmse: 1.60761
1.6294260175514312
geoNetwork\_continent   32
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61508
[200]	valid\_0's rmse: 1.60803
[300]	valid\_0's rmse: 1.60792
Early stopping, best iteration is:
[268]	valid\_0's rmse: 1.60738
1.6286408895113156
geoNetwork\_continent   33
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61566
[200]	valid\_0's rmse: 1.60823
[300]	valid\_0's rmse: 1.60701
[400]	valid\_0's rmse: 1.60799
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60682
1.628856782064501
geoNetwork\_continent   34
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61512
[200]	valid\_0's rmse: 1.60745
[300]	valid\_0's rmse: 1.60644
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60641
1.6275763539620405
geoNetwork\_continent   35
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6158
[200]	valid\_0's rmse: 1.60847
[300]	valid\_0's rmse: 1.60692
[400]	valid\_0's rmse: 1.60761
Early stopping, best iteration is:
[325]	valid\_0's rmse: 1.60669
1.6287651286873543
geoNetwork\_continent   36
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6156
[200]	valid\_0's rmse: 1.60955
[300]	valid\_0's rmse: 1.60725
Early stopping, best iteration is:
[288]	valid\_0's rmse: 1.60721
1.6289259189572964
geoNetwork\_continent   37
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61609
[200]	valid\_0's rmse: 1.60869
[300]	valid\_0's rmse: 1.60635
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60611
1.6276469620284006
geoNetwork\_continent   38
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61593
[200]	valid\_0's rmse: 1.60757
[300]	valid\_0's rmse: 1.60703
Early stopping, best iteration is:
[267]	valid\_0's rmse: 1.60664
1.6282979553563515
geoNetwork\_continent   39
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61583
[200]	valid\_0's rmse: 1.60891
[300]	valid\_0's rmse: 1.60722
Early stopping, best iteration is:
[289]	valid\_0's rmse: 1.60714
1.6288968198824234
geoNetwork\_continent   40
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61604
[200]	valid\_0's rmse: 1.60972
[300]	valid\_0's rmse: 1.60879
Early stopping, best iteration is:
[288]	valid\_0's rmse: 1.60862
1.6305792405704271
geoNetwork\_continent   41
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61574
[200]	valid\_0's rmse: 1.60917
[300]	valid\_0's rmse: 1.60699
Early stopping, best iteration is:
[289]	valid\_0's rmse: 1.60689
1.6279700580314496
geoNetwork\_continent   42
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61591
[200]	valid\_0's rmse: 1.60937
[300]	valid\_0's rmse: 1.60721
Early stopping, best iteration is:
[293]	valid\_0's rmse: 1.60682
1.6278392492302443
geoNetwork\_continent   43
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61481
[200]	valid\_0's rmse: 1.60812
[300]	valid\_0's rmse: 1.60834
Early stopping, best iteration is:
[205]	valid\_0's rmse: 1.60758
1.6290913141708916
geoNetwork\_continent   44
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61499
[200]	valid\_0's rmse: 1.60842
[300]	valid\_0's rmse: 1.60629
[400]	valid\_0's rmse: 1.60797
Early stopping, best iteration is:
[307]	valid\_0's rmse: 1.60617
1.6275997990476678
geoNetwork\_continent   45
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61604
[200]	valid\_0's rmse: 1.60879
[300]	valid\_0's rmse: 1.60596
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60589
1.627581131451362
geoNetwork\_continent   46
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6161
[200]	valid\_0's rmse: 1.60967
[300]	valid\_0's rmse: 1.60857
Early stopping, best iteration is:
[289]	valid\_0's rmse: 1.60818
1.6290085179252192
geoNetwork\_continent   47
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61529
[200]	valid\_0's rmse: 1.6087
[300]	valid\_0's rmse: 1.60804
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60781
1.6292247507237816
geoNetwork\_continent   48
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61639
[200]	valid\_0's rmse: 1.60959
[300]	valid\_0's rmse: 1.60897
[400]	valid\_0's rmse: 1.60963
Early stopping, best iteration is:
[304]	valid\_0's rmse: 1.60874
1.6300652724694003
geoNetwork\_continent   49
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61608
[200]	valid\_0's rmse: 1.61003
[300]	valid\_0's rmse: 1.60777
[400]	valid\_0's rmse: 1.60916
Early stopping, best iteration is:
[318]	valid\_0's rmse: 1.60759
1.6286859365135966
geoNetwork\_continent   50
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61479
[200]	valid\_0's rmse: 1.60815
[300]	valid\_0's rmse: 1.60612
[400]	valid\_0's rmse: 1.60762
Early stopping, best iteration is:
[325]	valid\_0's rmse: 1.60569
1.6275167849089007
geoNetwork\_continent   51
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61544
[200]	valid\_0's rmse: 1.60816
[300]	valid\_0's rmse: 1.60753
Early stopping, best iteration is:
[257]	valid\_0's rmse: 1.60718
1.6286249439802267
geoNetwork\_continent   52
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61505
[200]	valid\_0's rmse: 1.61014
[300]	valid\_0's rmse: 1.60842
Early stopping, best iteration is:
[299]	valid\_0's rmse: 1.6084
1.6297440002903223
geoNetwork\_continent   53
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6159
[200]	valid\_0's rmse: 1.60859
[300]	valid\_0's rmse: 1.60695
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60674
1.6282297232079548
geoNetwork\_continent   54
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61562
[200]	valid\_0's rmse: 1.60884
[300]	valid\_0's rmse: 1.60625
[400]	valid\_0's rmse: 1.60803
Early stopping, best iteration is:
[300]	valid\_0's rmse: 1.60625
1.6283410535611043
geoNetwork\_continent   55
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61543
[200]	valid\_0's rmse: 1.60772
[300]	valid\_0's rmse: 1.60544
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.6053
1.6268409306783647
geoNetwork\_continent   56
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61651
[200]	valid\_0's rmse: 1.61078
[300]	valid\_0's rmse: 1.60895
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60893
1.6299641153479885
geoNetwork\_continent   57
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61649
[200]	valid\_0's rmse: 1.61142
[300]	valid\_0's rmse: 1.61123
Early stopping, best iteration is:
[258]	valid\_0's rmse: 1.61055
1.6319628868966722
geoNetwork\_continent   58
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61547
[200]	valid\_0's rmse: 1.60891
[300]	valid\_0's rmse: 1.6077
Early stopping, best iteration is:
[266]	valid\_0's rmse: 1.60752
1.6295777763532606
geoNetwork\_continent   59
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61576
[200]	valid\_0's rmse: 1.60786
[300]	valid\_0's rmse: 1.60755
Early stopping, best iteration is:
[257]	valid\_0's rmse: 1.607
1.6294338894187448
geoNetwork\_continent   60
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61558
[200]	valid\_0's rmse: 1.60962
[300]	valid\_0's rmse: 1.6087
Early stopping, best iteration is:
[284]	valid\_0's rmse: 1.60846
1.6307208948827623
geoNetwork\_continent   61
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61535
[200]	valid\_0's rmse: 1.60918
[300]	valid\_0's rmse: 1.60799
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.60741
1.6287203026625645
geoNetwork\_continent   62
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61469
[200]	valid\_0's rmse: 1.60791
[300]	valid\_0's rmse: 1.60577
[400]	valid\_0's rmse: 1.60699
Early stopping, best iteration is:
[319]	valid\_0's rmse: 1.60538
1.6263923070179864
geoNetwork\_continent   63
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61437
[200]	valid\_0's rmse: 1.6086
[300]	valid\_0's rmse: 1.6067
[400]	valid\_0's rmse: 1.60849
Early stopping, best iteration is:
[301]	valid\_0's rmse: 1.60668
1.6286547881595246
geoNetwork\_continent   64
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61509
[200]	valid\_0's rmse: 1.60827
[300]	valid\_0's rmse: 1.60678
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.6067
1.6293520588265515
geoNetwork\_continent   65
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61648
[200]	valid\_0's rmse: 1.60943
[300]	valid\_0's rmse: 1.60762
[400]	valid\_0's rmse: 1.60856
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60748
1.6293290915115244
geoNetwork\_continent   66
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61634
[200]	valid\_0's rmse: 1.60908
[300]	valid\_0's rmse: 1.60851
[400]	valid\_0's rmse: 1.60977
Early stopping, best iteration is:
[309]	valid\_0's rmse: 1.60829
1.629574715409025
geoNetwork\_continent   67
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61727
[200]	valid\_0's rmse: 1.61047
[300]	valid\_0's rmse: 1.61049
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.60961
1.6314566432190412
geoNetwork\_continent   68
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61612
[200]	valid\_0's rmse: 1.61001
[300]	valid\_0's rmse: 1.60759
[400]	valid\_0's rmse: 1.60916
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60737
1.629165509272356
geoNetwork\_continent   69
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61631
[200]	valid\_0's rmse: 1.60794
[300]	valid\_0's rmse: 1.60576
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60567
1.6282034915715868
geoNetwork\_continent   70
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61557
[200]	valid\_0's rmse: 1.60739
[300]	valid\_0's rmse: 1.60668
Early stopping, best iteration is:
[263]	valid\_0's rmse: 1.6062
1.6275627459610646
geoNetwork\_continent   71
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61624
[200]	valid\_0's rmse: 1.60794
[300]	valid\_0's rmse: 1.6068
Early stopping, best iteration is:
[259]	valid\_0's rmse: 1.60663
1.6281600474082594
geoNetwork\_continent   72
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61735
[200]	valid\_0's rmse: 1.6103
[300]	valid\_0's rmse: 1.60812
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.6081
1.6298263393204817
geoNetwork\_continent   73
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61546
[200]	valid\_0's rmse: 1.60931
[300]	valid\_0's rmse: 1.60795
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60787
1.6289446904120615
geoNetwork\_continent   74
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61609
[200]	valid\_0's rmse: 1.61064
[300]	valid\_0's rmse: 1.60905
[400]	valid\_0's rmse: 1.60963
Early stopping, best iteration is:
[334]	valid\_0's rmse: 1.60883
1.6300985984329361
geoNetwork\_continent   75
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61582
[200]	valid\_0's rmse: 1.60717
[300]	valid\_0's rmse: 1.6062
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.6061
1.6277413073393714
geoNetwork\_continent   76
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61488
[200]	valid\_0's rmse: 1.60934
[300]	valid\_0's rmse: 1.6091
Early stopping, best iteration is:
[292]	valid\_0's rmse: 1.60881
1.6303868222357092
geoNetwork\_continent   77
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61469
[200]	valid\_0's rmse: 1.60854
[300]	valid\_0's rmse: 1.60785
Early stopping, best iteration is:
[292]	valid\_0's rmse: 1.60781
1.6292727881731077
geoNetwork\_continent   78
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61586
[200]	valid\_0's rmse: 1.60885
[300]	valid\_0's rmse: 1.60753
Early stopping, best iteration is:
[290]	valid\_0's rmse: 1.60704
1.6288518575443285
geoNetwork\_continent   79
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61724
[200]	valid\_0's rmse: 1.61008
[300]	valid\_0's rmse: 1.60939
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.60916
1.6304845192050483
geoNetwork\_continent   80
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61533
[200]	valid\_0's rmse: 1.60829
[300]	valid\_0's rmse: 1.60547
[400]	valid\_0's rmse: 1.60636
Early stopping, best iteration is:
[363]	valid\_0's rmse: 1.60536
1.626582325080128
geoNetwork\_continent   81
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61613
[200]	valid\_0's rmse: 1.60883
[300]	valid\_0's rmse: 1.60723
[400]	valid\_0's rmse: 1.60943
Early stopping, best iteration is:
[306]	valid\_0's rmse: 1.60715
1.6288844859292024
geoNetwork\_continent   82
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61386
[200]	valid\_0's rmse: 1.60721
[300]	valid\_0's rmse: 1.60672
Early stopping, best iteration is:
[282]	valid\_0's rmse: 1.60622
1.628120266118874
geoNetwork\_continent   83
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61532
[200]	valid\_0's rmse: 1.60918
[300]	valid\_0's rmse: 1.60854
Early stopping, best iteration is:
[267]	valid\_0's rmse: 1.60777
1.6292663619478047
geoNetwork\_continent   84
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61646
[200]	valid\_0's rmse: 1.60901
[300]	valid\_0's rmse: 1.608
[400]	valid\_0's rmse: 1.60939
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60744
1.6278290927850734
geoNetwork\_continent   85
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61454
[200]	valid\_0's rmse: 1.60798
[300]	valid\_0's rmse: 1.60591
Early stopping, best iteration is:
[287]	valid\_0's rmse: 1.60579
1.627804916019608
geoNetwork\_continent   86
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61431
[200]	valid\_0's rmse: 1.60793
[300]	valid\_0's rmse: 1.60729
[400]	valid\_0's rmse: 1.60853
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60701
1.6286442458311046
geoNetwork\_continent   87
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6159
[200]	valid\_0's rmse: 1.60948
[300]	valid\_0's rmse: 1.60882
Early stopping, best iteration is:
[283]	valid\_0's rmse: 1.60856
1.6306429043977642
geoNetwork\_continent   88
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61561
[200]	valid\_0's rmse: 1.60812
[300]	valid\_0's rmse: 1.60636
[400]	valid\_0's rmse: 1.60757
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.6063
1.627517381597849
geoNetwork\_continent   89
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61485
[200]	valid\_0's rmse: 1.60756
[300]	valid\_0's rmse: 1.60649
Early stopping, best iteration is:
[272]	valid\_0's rmse: 1.60585
1.6286656935100539
geoNetwork\_continent   90
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61602
[200]	valid\_0's rmse: 1.60986
[300]	valid\_0's rmse: 1.60933
Early stopping, best iteration is:
[240]	valid\_0's rmse: 1.60888
1.6303364132989604
geoNetwork\_continent   91
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61577
[200]	valid\_0's rmse: 1.61001
[300]	valid\_0's rmse: 1.60881
[400]	valid\_0's rmse: 1.60955
Early stopping, best iteration is:
[339]	valid\_0's rmse: 1.60837
1.6303257525920016
geoNetwork\_continent   92
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61545
[200]	valid\_0's rmse: 1.6092
[300]	valid\_0's rmse: 1.60738
Early stopping, best iteration is:
[287]	valid\_0's rmse: 1.6073
1.6294312871125893
geoNetwork\_continent   93
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61528
[200]	valid\_0's rmse: 1.60902
[300]	valid\_0's rmse: 1.6076
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.6073
1.6292581904434367
geoNetwork\_continent   94
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61608
[200]	valid\_0's rmse: 1.60843
[300]	valid\_0's rmse: 1.60688
[400]	valid\_0's rmse: 1.60666
Early stopping, best iteration is:
[388]	valid\_0's rmse: 1.60619
1.6278269114712562
geoNetwork\_continent   95
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61641
[200]	valid\_0's rmse: 1.60864
[300]	valid\_0's rmse: 1.60823
[400]	valid\_0's rmse: 1.60993
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60812
1.6290136630376288
geoNetwork\_continent   96
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60839
[300]	valid\_0's rmse: 1.6065
[400]	valid\_0's rmse: 1.60733
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60632
1.628185421490788
geoNetwork\_continent   97
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61685
[200]	valid\_0's rmse: 1.61024
[300]	valid\_0's rmse: 1.60745
[400]	valid\_0's rmse: 1.60769
Early stopping, best iteration is:
[332]	valid\_0's rmse: 1.60699
1.6288478144328873
geoNetwork\_continent   98
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61573
[200]	valid\_0's rmse: 1.6079
[300]	valid\_0's rmse: 1.60731
Early stopping, best iteration is:
[240]	valid\_0's rmse: 1.60715
1.6295548374134259
geoNetwork\_continent   99
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60888
[300]	valid\_0's rmse: 1.60752
[400]	valid\_0's rmse: 1.60864
Early stopping, best iteration is:
[323]	valid\_0's rmse: 1.60743
1.6289493223000964
trafficSource\_adwordsClickInfo.isVideoAd   0
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61579
[200]	valid\_0's rmse: 1.60832
[300]	valid\_0's rmse: 1.60709
[400]	valid\_0's rmse: 1.60802
Early stopping, best iteration is:
[314]	valid\_0's rmse: 1.60667
1.627625081330889
trafficSource\_adwordsClickInfo.isVideoAd   1
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6156
[200]	valid\_0's rmse: 1.60857
[300]	valid\_0's rmse: 1.60671
[400]	valid\_0's rmse: 1.60608
Early stopping, best iteration is:
[341]	valid\_0's rmse: 1.60578
1.6279599643479297
trafficSource\_adwordsClickInfo.isVideoAd   2
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61548
[200]	valid\_0's rmse: 1.60767
[300]	valid\_0's rmse: 1.6062
Early stopping, best iteration is:
[273]	valid\_0's rmse: 1.60603
1.6276853954518116
trafficSource\_adwordsClickInfo.isVideoAd   3
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61556
[200]	valid\_0's rmse: 1.60872
[300]	valid\_0's rmse: 1.60683
[400]	valid\_0's rmse: 1.60787
Early stopping, best iteration is:
[309]	valid\_0's rmse: 1.60672
1.6281478781296947
trafficSource\_adwordsClickInfo.isVideoAd   4
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61453
[200]	valid\_0's rmse: 1.60786
[300]	valid\_0's rmse: 1.60675
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60671
1.628103659534005
trafficSource\_adwordsClickInfo.isVideoAd   5
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61486
[200]	valid\_0's rmse: 1.60856
[300]	valid\_0's rmse: 1.60662
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60648
1.6287457736877775
trafficSource\_adwordsClickInfo.isVideoAd   6
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61469
[200]	valid\_0's rmse: 1.60796
[300]	valid\_0's rmse: 1.6053
[400]	valid\_0's rmse: 1.60724
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60485
1.627200623269411
trafficSource\_adwordsClickInfo.isVideoAd   7
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61595
[200]	valid\_0's rmse: 1.60813
[300]	valid\_0's rmse: 1.60594
Early stopping, best iteration is:
[282]	valid\_0's rmse: 1.60577
1.6272761633885604
trafficSource\_adwordsClickInfo.isVideoAd   8
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60902
[300]	valid\_0's rmse: 1.60691
[400]	valid\_0's rmse: 1.60814
Early stopping, best iteration is:
[302]	valid\_0's rmse: 1.60683
1.6288541805945185
trafficSource\_adwordsClickInfo.isVideoAd   9
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61429
[200]	valid\_0's rmse: 1.60714
[300]	valid\_0's rmse: 1.60623
[400]	valid\_0's rmse: 1.60739
Early stopping, best iteration is:
[321]	valid\_0's rmse: 1.60597
1.6275939554272731
trafficSource\_adwordsClickInfo.isVideoAd   10
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61406
[200]	valid\_0's rmse: 1.60733
[300]	valid\_0's rmse: 1.60675
Early stopping, best iteration is:
[273]	valid\_0's rmse: 1.60634
1.6286519668155899
trafficSource\_adwordsClickInfo.isVideoAd   11
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61499
[200]	valid\_0's rmse: 1.60782
[300]	valid\_0's rmse: 1.60627
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60609
1.6280503010670948
trafficSource\_adwordsClickInfo.isVideoAd   12
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61391
[200]	valid\_0's rmse: 1.60719
[300]	valid\_0's rmse: 1.60539
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60524
1.6263640168451345
trafficSource\_adwordsClickInfo.isVideoAd   13
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61505
[200]	valid\_0's rmse: 1.60734
[300]	valid\_0's rmse: 1.60674
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60645
1.628081630809526
trafficSource\_adwordsClickInfo.isVideoAd   14
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61628
[200]	valid\_0's rmse: 1.60936
[300]	valid\_0's rmse: 1.60723
[400]	valid\_0's rmse: 1.60812
Early stopping, best iteration is:
[312]	valid\_0's rmse: 1.60704
1.628562169485312
trafficSource\_adwordsClickInfo.isVideoAd   15
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61365
[200]	valid\_0's rmse: 1.60635
[300]	valid\_0's rmse: 1.60516
Early stopping, best iteration is:
[264]	valid\_0's rmse: 1.60498
1.6269203690476461
trafficSource\_adwordsClickInfo.isVideoAd   16
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.6082
[300]	valid\_0's rmse: 1.60634
Early stopping, best iteration is:
[289]	valid\_0's rmse: 1.60617
1.62782331370879
trafficSource\_adwordsClickInfo.isVideoAd   17
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61538
[200]	valid\_0's rmse: 1.60704
[300]	valid\_0's rmse: 1.60558
Early stopping, best iteration is:
[287]	valid\_0's rmse: 1.60509
1.6273814931992372
trafficSource\_adwordsClickInfo.isVideoAd   18
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61559
[200]	valid\_0's rmse: 1.60783
[300]	valid\_0's rmse: 1.60602
[400]	valid\_0's rmse: 1.60903
Early stopping, best iteration is:
[305]	valid\_0's rmse: 1.60587
1.6274140014924503
trafficSource\_adwordsClickInfo.isVideoAd   19
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61449
[200]	valid\_0's rmse: 1.60666
[300]	valid\_0's rmse: 1.60526
[400]	valid\_0's rmse: 1.60644
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60511
1.6268735643743517
trafficSource\_adwordsClickInfo.isVideoAd   20
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61584
[200]	valid\_0's rmse: 1.60846
[300]	valid\_0's rmse: 1.60597
[400]	valid\_0's rmse: 1.60698
Early stopping, best iteration is:
[315]	valid\_0's rmse: 1.60549
1.6270510184262108
trafficSource\_adwordsClickInfo.isVideoAd   21
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60786
[300]	valid\_0's rmse: 1.60587
Early stopping, best iteration is:
[273]	valid\_0's rmse: 1.60568
1.6270657163974978
trafficSource\_adwordsClickInfo.isVideoAd   22
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61502
[200]	valid\_0's rmse: 1.60788
[300]	valid\_0's rmse: 1.6056
[400]	valid\_0's rmse: 1.60671
Early stopping, best iteration is:
[302]	valid\_0's rmse: 1.60553
1.628074212410166
trafficSource\_adwordsClickInfo.isVideoAd   23
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61586
[200]	valid\_0's rmse: 1.60833
[300]	valid\_0's rmse: 1.60685
[400]	valid\_0's rmse: 1.60732
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60663
1.6286484368413172
trafficSource\_adwordsClickInfo.isVideoAd   24
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61533
[200]	valid\_0's rmse: 1.60892
[300]	valid\_0's rmse: 1.60701
Early stopping, best iteration is:
[286]	valid\_0's rmse: 1.60675
1.6287126023351775
trafficSource\_adwordsClickInfo.isVideoAd   25
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61525
[200]	valid\_0's rmse: 1.60873
[300]	valid\_0's rmse: 1.60778
Early stopping, best iteration is:
[240]	valid\_0's rmse: 1.60724
1.6295908896061688
trafficSource\_adwordsClickInfo.isVideoAd   26
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61555
[200]	valid\_0's rmse: 1.60731
[300]	valid\_0's rmse: 1.60418
Early stopping, best iteration is:
[285]	valid\_0's rmse: 1.60405
1.6263306101010382
trafficSource\_adwordsClickInfo.isVideoAd   27
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61564
[200]	valid\_0's rmse: 1.60698
[300]	valid\_0's rmse: 1.60502
[400]	valid\_0's rmse: 1.60591
Early stopping, best iteration is:
[322]	valid\_0's rmse: 1.6049
1.6263703650206174
trafficSource\_adwordsClickInfo.isVideoAd   28
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61582
[200]	valid\_0's rmse: 1.60926
[300]	valid\_0's rmse: 1.6078
Early stopping, best iteration is:
[290]	valid\_0's rmse: 1.60749
1.6286280640156279
trafficSource\_adwordsClickInfo.isVideoAd   29
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61526
[200]	valid\_0's rmse: 1.60733
[300]	valid\_0's rmse: 1.60603
Early stopping, best iteration is:
[285]	valid\_0's rmse: 1.60575
1.6274849048977242
trafficSource\_adwordsClickInfo.isVideoAd   30
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61528
[200]	valid\_0's rmse: 1.60906
[300]	valid\_0's rmse: 1.60865
Early stopping, best iteration is:
[230]	valid\_0's rmse: 1.60809
1.6304563281297717
trafficSource\_adwordsClickInfo.isVideoAd   31
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61563
[200]	valid\_0's rmse: 1.60915
[300]	valid\_0's rmse: 1.60826
[400]	valid\_0's rmse: 1.60952
Early stopping, best iteration is:
[305]	valid\_0's rmse: 1.60818
1.6303523056018387
trafficSource\_adwordsClickInfo.isVideoAd   32
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60812
[300]	valid\_0's rmse: 1.60735
Early stopping, best iteration is:
[292]	valid\_0's rmse: 1.60716
1.6287630725030182
trafficSource\_adwordsClickInfo.isVideoAd   33
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61533
[200]	valid\_0's rmse: 1.60635
[300]	valid\_0's rmse: 1.60603
[400]	valid\_0's rmse: 1.60632
Early stopping, best iteration is:
[382]	valid\_0's rmse: 1.60582
1.6275511969909888
trafficSource\_adwordsClickInfo.isVideoAd   34
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61527
[200]	valid\_0's rmse: 1.60805
[300]	valid\_0's rmse: 1.606
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60598
1.6272015539083482
trafficSource\_adwordsClickInfo.isVideoAd   35
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61582
[200]	valid\_0's rmse: 1.60881
[300]	valid\_0's rmse: 1.60743
[400]	valid\_0's rmse: 1.60814
Early stopping, best iteration is:
[309]	valid\_0's rmse: 1.60672
1.6279354973220455
trafficSource\_adwordsClickInfo.isVideoAd   36
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61546
[200]	valid\_0's rmse: 1.60759
[300]	valid\_0's rmse: 1.60573
Early stopping, best iteration is:
[286]	valid\_0's rmse: 1.6056
1.6272645320017378
trafficSource\_adwordsClickInfo.isVideoAd   37
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61577
[200]	valid\_0's rmse: 1.60797
[300]	valid\_0's rmse: 1.60714
[400]	valid\_0's rmse: 1.60794
Early stopping, best iteration is:
[336]	valid\_0's rmse: 1.60696
1.6273734952853576
trafficSource\_adwordsClickInfo.isVideoAd   38
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61532
[200]	valid\_0's rmse: 1.60859
[300]	valid\_0's rmse: 1.60664
[400]	valid\_0's rmse: 1.60715
Early stopping, best iteration is:
[342]	valid\_0's rmse: 1.60619
1.6271315205564274
trafficSource\_adwordsClickInfo.isVideoAd   39
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61591
[200]	valid\_0's rmse: 1.60871
[300]	valid\_0's rmse: 1.60717
[400]	valid\_0's rmse: 1.60816
Early stopping, best iteration is:
[323]	valid\_0's rmse: 1.60703
1.629274607901262
trafficSource\_adwordsClickInfo.isVideoAd   40
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60928
[300]	valid\_0's rmse: 1.60802
[400]	valid\_0's rmse: 1.60936
Early stopping, best iteration is:
[318]	valid\_0's rmse: 1.60761
1.6285558489960668
trafficSource\_adwordsClickInfo.isVideoAd   41
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60897
[300]	valid\_0's rmse: 1.60664
Early stopping, best iteration is:
[287]	valid\_0's rmse: 1.60644
1.6280942430777043
trafficSource\_adwordsClickInfo.isVideoAd   42
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61574
[200]	valid\_0's rmse: 1.60795
[300]	valid\_0's rmse: 1.60692
[400]	valid\_0's rmse: 1.60747
Early stopping, best iteration is:
[304]	valid\_0's rmse: 1.60685
1.6284383434044103
trafficSource\_adwordsClickInfo.isVideoAd   43
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6149
[200]	valid\_0's rmse: 1.60808
[300]	valid\_0's rmse: 1.60591
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60574
1.627703652565981
trafficSource\_adwordsClickInfo.isVideoAd   44
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61532
[200]	valid\_0's rmse: 1.60874
[300]	valid\_0's rmse: 1.60697
[400]	valid\_0's rmse: 1.60801
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60686
1.6290075770476158
trafficSource\_adwordsClickInfo.isVideoAd   45
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61431
[200]	valid\_0's rmse: 1.6062
[300]	valid\_0's rmse: 1.60602
Early stopping, best iteration is:
[273]	valid\_0's rmse: 1.60555
1.627541099850047
trafficSource\_adwordsClickInfo.isVideoAd   46
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61582
[200]	valid\_0's rmse: 1.60843
[300]	valid\_0's rmse: 1.60671
[400]	valid\_0's rmse: 1.60749
Early stopping, best iteration is:
[321]	valid\_0's rmse: 1.6061
1.6268989569559835
trafficSource\_adwordsClickInfo.isVideoAd   47
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61582
[200]	valid\_0's rmse: 1.60765
[300]	valid\_0's rmse: 1.60704
Early stopping, best iteration is:
[226]	valid\_0's rmse: 1.6068
1.629479446865585
trafficSource\_adwordsClickInfo.isVideoAd   48
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61528
[200]	valid\_0's rmse: 1.60859
[300]	valid\_0's rmse: 1.60837
Early stopping, best iteration is:
[228]	valid\_0's rmse: 1.60778
1.6298816780315406
trafficSource\_adwordsClickInfo.isVideoAd   49
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61451
[200]	valid\_0's rmse: 1.60787
[300]	valid\_0's rmse: 1.60675
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60654
1.6284007105646747
trafficSource\_adwordsClickInfo.isVideoAd   50
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60745
[300]	valid\_0's rmse: 1.60647
Early stopping, best iteration is:
[274]	valid\_0's rmse: 1.60613
1.627573655275678
trafficSource\_adwordsClickInfo.isVideoAd   51
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61488
[200]	valid\_0's rmse: 1.60764
[300]	valid\_0's rmse: 1.60663
Early stopping, best iteration is:
[285]	valid\_0's rmse: 1.60649
1.6283445311223514
trafficSource\_adwordsClickInfo.isVideoAd   52
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61686
[200]	valid\_0's rmse: 1.6093
[300]	valid\_0's rmse: 1.60863
[400]	valid\_0's rmse: 1.60819
Early stopping, best iteration is:
[388]	valid\_0's rmse: 1.6078
1.6288718156273585
trafficSource\_adwordsClickInfo.isVideoAd   53
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61499
[200]	valid\_0's rmse: 1.6083
[300]	valid\_0's rmse: 1.60631
[400]	valid\_0's rmse: 1.60652
Early stopping, best iteration is:
[340]	valid\_0's rmse: 1.60547
1.626858821363521
trafficSource\_adwordsClickInfo.isVideoAd   54
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60813
[300]	valid\_0's rmse: 1.60685
[400]	valid\_0's rmse: 1.60883
Early stopping, best iteration is:
[314]	valid\_0's rmse: 1.60642
1.6282348960181907
trafficSource\_adwordsClickInfo.isVideoAd   55
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61547
[200]	valid\_0's rmse: 1.60797
[300]	valid\_0's rmse: 1.60541
[400]	valid\_0's rmse: 1.60632
Early stopping, best iteration is:
[317]	valid\_0's rmse: 1.60518
1.626799922497803
trafficSource\_adwordsClickInfo.isVideoAd   56
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.6079
[300]	valid\_0's rmse: 1.60607
[400]	valid\_0's rmse: 1.60693
Early stopping, best iteration is:
[323]	valid\_0's rmse: 1.60591
1.6274443926697701
trafficSource\_adwordsClickInfo.isVideoAd   57
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60968
[300]	valid\_0's rmse: 1.60717
[400]	valid\_0's rmse: 1.60884
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60714
1.6284116765354653
trafficSource\_adwordsClickInfo.isVideoAd   58
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61711
[200]	valid\_0's rmse: 1.60932
[300]	valid\_0's rmse: 1.60771
Early stopping, best iteration is:
[294]	valid\_0's rmse: 1.60755
1.6292470801426755
trafficSource\_adwordsClickInfo.isVideoAd   59
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60766
[300]	valid\_0's rmse: 1.60628
[400]	valid\_0's rmse: 1.60722
Early stopping, best iteration is:
[302]	valid\_0's rmse: 1.60625
1.6282282648065687
trafficSource\_adwordsClickInfo.isVideoAd   60
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61442
[200]	valid\_0's rmse: 1.6062
[300]	valid\_0's rmse: 1.60482
Early stopping, best iteration is:
[292]	valid\_0's rmse: 1.60452
1.6262856454966457
trafficSource\_adwordsClickInfo.isVideoAd   61
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61392
[200]	valid\_0's rmse: 1.60604
[300]	valid\_0's rmse: 1.60485
Early stopping, best iteration is:
[235]	valid\_0's rmse: 1.60453
1.626279583316436
trafficSource\_adwordsClickInfo.isVideoAd   62
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61533
[200]	valid\_0's rmse: 1.60796
[300]	valid\_0's rmse: 1.60671
[400]	valid\_0's rmse: 1.60655
Early stopping, best iteration is:
[304]	valid\_0's rmse: 1.60645
1.6285676539207288
trafficSource\_adwordsClickInfo.isVideoAd   63
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6148
[200]	valid\_0's rmse: 1.60798
[300]	valid\_0's rmse: 1.60675
Early stopping, best iteration is:
[268]	valid\_0's rmse: 1.60652
1.6283300575790873
trafficSource\_adwordsClickInfo.isVideoAd   64
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61453
[200]	valid\_0's rmse: 1.60754
[300]	valid\_0's rmse: 1.60551
[400]	valid\_0's rmse: 1.60764
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60527
1.6270620680516168
trafficSource\_adwordsClickInfo.isVideoAd   65
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61502
[200]	valid\_0's rmse: 1.60843
[300]	valid\_0's rmse: 1.60847
Early stopping, best iteration is:
[225]	valid\_0's rmse: 1.608
1.6308482766230397
trafficSource\_adwordsClickInfo.isVideoAd   66
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61356
[200]	valid\_0's rmse: 1.60839
[300]	valid\_0's rmse: 1.60664
Early stopping, best iteration is:
[293]	valid\_0's rmse: 1.60639
1.6283783132045013
trafficSource\_adwordsClickInfo.isVideoAd   67
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61417
[200]	valid\_0's rmse: 1.60693
[300]	valid\_0's rmse: 1.60473
[400]	valid\_0's rmse: 1.60608
Early stopping, best iteration is:
[303]	valid\_0's rmse: 1.60456
1.6263786579270796
trafficSource\_adwordsClickInfo.isVideoAd   68
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.6138
[200]	valid\_0's rmse: 1.60701
[300]	valid\_0's rmse: 1.60491
[400]	valid\_0's rmse: 1.60559
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60461
1.6266827593833952
trafficSource\_adwordsClickInfo.isVideoAd   69
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61488
[200]	valid\_0's rmse: 1.60689
[300]	valid\_0's rmse: 1.60472
Early stopping, best iteration is:
[288]	valid\_0's rmse: 1.60455
1.626526446748377
trafficSource\_adwordsClickInfo.isVideoAd   70
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61603
[200]	valid\_0's rmse: 1.60858
[300]	valid\_0's rmse: 1.60714
[400]	valid\_0's rmse: 1.60807
Early stopping, best iteration is:
[317]	valid\_0's rmse: 1.60693
1.628653626105662
trafficSource\_adwordsClickInfo.isVideoAd   71
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61471
[200]	valid\_0's rmse: 1.60703
[300]	valid\_0's rmse: 1.60522
[400]	valid\_0's rmse: 1.6052
Early stopping, best iteration is:
[378]	valid\_0's rmse: 1.60451
1.625506644622275
trafficSource\_adwordsClickInfo.isVideoAd   72
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61463
[200]	valid\_0's rmse: 1.60731
[300]	valid\_0's rmse: 1.60498
[400]	valid\_0's rmse: 1.60676
Early stopping, best iteration is:
[301]	valid\_0's rmse: 1.60494
1.6269291750103936
trafficSource\_adwordsClickInfo.isVideoAd   73
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61444
[200]	valid\_0's rmse: 1.60709
[300]	valid\_0's rmse: 1.60458
[400]	valid\_0's rmse: 1.6062
Early stopping, best iteration is:
[316]	valid\_0's rmse: 1.60421
1.626168118257207
trafficSource\_adwordsClickInfo.isVideoAd   74
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61504
[200]	valid\_0's rmse: 1.60726
[300]	valid\_0's rmse: 1.60577
[400]	valid\_0's rmse: 1.60789
Early stopping, best iteration is:
[323]	valid\_0's rmse: 1.60551
1.627948927577682
trafficSource\_adwordsClickInfo.isVideoAd   75
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60817
[300]	valid\_0's rmse: 1.60648
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.60634
1.6278360646379915
trafficSource\_adwordsClickInfo.isVideoAd   76
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61612
[200]	valid\_0's rmse: 1.60763
[300]	valid\_0's rmse: 1.60669
[400]	valid\_0's rmse: 1.60802
Early stopping, best iteration is:
[305]	valid\_0's rmse: 1.60654
1.6281922709619354
trafficSource\_adwordsClickInfo.isVideoAd   77
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61528
[200]	valid\_0's rmse: 1.60757
[300]	valid\_0's rmse: 1.60655
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60646
1.6284956076572172
trafficSource\_adwordsClickInfo.isVideoAd   78
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61405
[200]	valid\_0's rmse: 1.60729
[300]	valid\_0's rmse: 1.60571
[400]	valid\_0's rmse: 1.60699
Early stopping, best iteration is:
[307]	valid\_0's rmse: 1.60559
1.6285602736516043
trafficSource\_adwordsClickInfo.isVideoAd   79
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61629
[200]	valid\_0's rmse: 1.60883
[300]	valid\_0's rmse: 1.60767
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60753
1.629303267745314
trafficSource\_adwordsClickInfo.isVideoAd   80
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61507
[200]	valid\_0's rmse: 1.6068
[300]	valid\_0's rmse: 1.60574
Early stopping, best iteration is:
[275]	valid\_0's rmse: 1.60543
1.6272985829628444
trafficSource\_adwordsClickInfo.isVideoAd   81
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61536
[200]	valid\_0's rmse: 1.60911
[300]	valid\_0's rmse: 1.60701
[400]	valid\_0's rmse: 1.60791
Early stopping, best iteration is:
[327]	valid\_0's rmse: 1.60686
1.6282822950726055
trafficSource\_adwordsClickInfo.isVideoAd   82
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61445
[200]	valid\_0's rmse: 1.60634
[300]	valid\_0's rmse: 1.60416
Early stopping, best iteration is:
[273]	valid\_0's rmse: 1.60407
1.626092561676407
trafficSource\_adwordsClickInfo.isVideoAd   83
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61508
[200]	valid\_0's rmse: 1.60676
[300]	valid\_0's rmse: 1.60585
Early stopping, best iteration is:
[292]	valid\_0's rmse: 1.60566
1.6273712472328923
trafficSource\_adwordsClickInfo.isVideoAd   84
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61534
[200]	valid\_0's rmse: 1.607
[300]	valid\_0's rmse: 1.60534
[400]	valid\_0's rmse: 1.60668
Early stopping, best iteration is:
[309]	valid\_0's rmse: 1.60516
1.6268358622651167
trafficSource\_adwordsClickInfo.isVideoAd   85
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61541
[200]	valid\_0's rmse: 1.6077
[300]	valid\_0's rmse: 1.60588
[400]	valid\_0's rmse: 1.60649
Early stopping, best iteration is:
[307]	valid\_0's rmse: 1.60567
1.628333615834079
trafficSource\_adwordsClickInfo.isVideoAd   86
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60782
[300]	valid\_0's rmse: 1.60651
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60629
1.627918709784926
trafficSource\_adwordsClickInfo.isVideoAd   87
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61555
[200]	valid\_0's rmse: 1.60857
[300]	valid\_0's rmse: 1.6069
[400]	valid\_0's rmse: 1.60739
Early stopping, best iteration is:
[322]	valid\_0's rmse: 1.60668
1.6283625482120003
trafficSource\_adwordsClickInfo.isVideoAd   88
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61609
[200]	valid\_0's rmse: 1.60768
[300]	valid\_0's rmse: 1.60634
[400]	valid\_0's rmse: 1.60823
Early stopping, best iteration is:
[301]	valid\_0's rmse: 1.60634
1.627610010562457
trafficSource\_adwordsClickInfo.isVideoAd   89
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61572
[200]	valid\_0's rmse: 1.60851
[300]	valid\_0's rmse: 1.60785
[400]	valid\_0's rmse: 1.60843
Early stopping, best iteration is:
[332]	valid\_0's rmse: 1.60742
1.6287218484469923
trafficSource\_adwordsClickInfo.isVideoAd   90
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61445
[200]	valid\_0's rmse: 1.60645
[300]	valid\_0's rmse: 1.60459
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.6045
1.6267508228900307
trafficSource\_adwordsClickInfo.isVideoAd   91
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61449
[200]	valid\_0's rmse: 1.60845
[300]	valid\_0's rmse: 1.60621
Early stopping, best iteration is:
[296]	valid\_0's rmse: 1.60604
1.627345273407452
trafficSource\_adwordsClickInfo.isVideoAd   92
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61582
[200]	valid\_0's rmse: 1.60899
[300]	valid\_0's rmse: 1.60714
Early stopping, best iteration is:
[299]	valid\_0's rmse: 1.60712
1.628923945609692
trafficSource\_adwordsClickInfo.isVideoAd   93
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61474
[200]	valid\_0's rmse: 1.60744
[300]	valid\_0's rmse: 1.60457
Early stopping, best iteration is:
[297]	valid\_0's rmse: 1.60449
1.6264599654505714
trafficSource\_adwordsClickInfo.isVideoAd   94
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61442
[200]	valid\_0's rmse: 1.60744
[300]	valid\_0's rmse: 1.6049
[400]	valid\_0's rmse: 1.60658
Early stopping, best iteration is:
[321]	valid\_0's rmse: 1.60458
1.6269799408305965
trafficSource\_adwordsClickInfo.isVideoAd   95
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61497
[200]	valid\_0's rmse: 1.60736
[300]	valid\_0's rmse: 1.60538
Early stopping, best iteration is:
[291]	valid\_0's rmse: 1.605
1.6272804568762846
trafficSource\_adwordsClickInfo.isVideoAd   96
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61407
[200]	valid\_0's rmse: 1.6084
[300]	valid\_0's rmse: 1.60779
[400]	valid\_0's rmse: 1.60895
Early stopping, best iteration is:
[309]	valid\_0's rmse: 1.60751
1.6290378332597188
trafficSource\_adwordsClickInfo.isVideoAd   97
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61582
[200]	valid\_0's rmse: 1.60903
[300]	valid\_0's rmse: 1.60641
[400]	valid\_0's rmse: 1.60747
Early stopping, best iteration is:
[311]	valid\_0's rmse: 1.60625
1.6274851466241187
trafficSource\_adwordsClickInfo.isVideoAd   98
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61581
[200]	valid\_0's rmse: 1.60837
[300]	valid\_0's rmse: 1.60755
[400]	valid\_0's rmse: 1.60705
[500]	valid\_0's rmse: 1.60733
Early stopping, best iteration is:
[422]	valid\_0's rmse: 1.6066
1.6270337740428542
trafficSource\_adwordsClickInfo.isVideoAd   99
Training until validation scores don't improve for 100 rounds.
[100]	valid\_0's rmse: 1.61587
[200]	valid\_0's rmse: 1.60813
[300]	valid\_0's rmse: 1.60736
Early stopping, best iteration is:
[273]	valid\_0's rmse: 1.60702
1.6290624675323095

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pval for visitId, totals\PYZus{}newVisits, geoNetwork\PYZus{}continent, trafficSource\PYZus{}adwordsClickInfo.isVideoAd}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{pval3} \PY{o}{=} \PY{n}{p\PYZus{}val}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{pval3}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
pval for visitId, totals\_newVisits, geoNetwork\_continent, trafficSource\_adwordsClickInfo.isVideoAd
[0.0, 0.76, 0.48, 0.85]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{tmp\PYZus{}sum} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{i} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mf}{1.60683} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ans}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n}{tmp\PYZus{}sum}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{ans}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}IGNORE}
        \PY{k}{for} \PY{n}{column\PYZus{}perm} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}pageviews}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}hits}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{visitNumber}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{geoNetwork\PYZus{}country}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}pageviews}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
                \PY{n+nb}{print}\PY{p}{(}\PY{n}{column\PYZus{}perm}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{i}\PY{p}{)}
                \PY{n}{train\PYZus{}permute} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
                \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{column\PYZus{}perm}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{permutation}\PY{p}{(}\PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{column\PYZus{}perm}\PY{p}{]}\PY{p}{)}
                \PY{n}{x}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}
                \PY{n}{x1} \PY{o}{=} \PY{l+m+mi}{3} \PY{o}{*} \PY{n+nb}{int}\PY{p}{(}\PY{n}{x} \PY{o}{/} \PY{l+m+mi}{4}\PY{p}{)}
        
                \PY{n}{dev\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{x1}\PY{p}{]}
                \PY{n}{val\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}permute}\PY{p}{[}\PY{n}{x1}\PY{p}{:}\PY{n}{x}\PY{p}{]}
        
                \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}df}
                \PY{n}{val\PYZus{}X} \PY{o}{=} \PY{n}{val\PYZus{}df}
        
                \PY{n}{dev\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
                \PY{n}{val\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}X}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
        
                \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                \PY{n}{val\PYZus{}X} \PY{o}{=} \PY{n}{val\PYZus{}X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{totals\PYZus{}transactionRevenue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fullVisitorId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visitStartTime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        
                \PY{n}{model}\PY{p}{,} \PY{n}{pred\PYZus{}val} \PY{o}{=} \PY{n}{run\PYZus{}lgb\PYZus{}perm}\PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{p}{,} \PY{n}{dev\PYZus{}y}\PY{p}{,} \PY{n}{val\PYZus{}X}\PY{p}{,} \PY{n}{val\PYZus{}y}\PY{p}{)}
                
                \PY{c+c1}{\PYZsh{}new\PYZus{}test1.csv}
                \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
                \PY{n}{pred\PYZus{}val}\PY{p}{[}\PY{n}{pred\PYZus{}val}\PY{o}{\PYZlt{}}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
                \PY{n}{val\PYZus{}pred\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{\PYZcb{}}\PY{p}{)}
                \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
                \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{expm1}\PY{p}{(}\PY{n}{pred\PYZus{}val}\PY{p}{)}
                \PY{c+c1}{\PYZsh{}print(np.sqrt(metrics.mean\PYZus{}squared\PYZus{}error(np.log1p(val\PYZus{}pred\PYZus{}df[\PYZdq{}transactionRevenue\PYZdq{}].values), np.log1p(val\PYZus{}pred\PYZus{}df[\PYZdq{}PredictedRevenue\PYZdq{}].values))))}
                \PY{n}{val\PYZus{}pred\PYZus{}df} \PY{o}{=} \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{seaborn}\PY{p}{;} 
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{neighbors}\PY{p}{,} \PY{n}{datasets}
        
        \PY{k+kn}{import} \PY{n+nn}{pylab} \PY{k}{as} \PY{n+nn}{pl}
        
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{decomposition} \PY{k}{import} \PY{n}{PCA}
        \PY{n}{pca} \PY{o}{=} \PY{n}{PCA}\PY{p}{(}\PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
        \PY{n}{pca}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{p}{)}
        \PY{n}{dev\PYZus{}X\PYZus{}reduced} \PY{o}{=} \PY{n}{pca}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Reduced dataset shape:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{dev\PYZus{}X\PYZus{}reduced}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        
        \PY{n}{pca}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{val\PYZus{}X}\PY{p}{)}
        \PY{n}{val\PYZus{}X\PYZus{}reduced} \PY{o}{=} \PY{n}{pca}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Reduced dataset shape:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{val\PYZus{}X\PYZus{}reduced}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        
        \PY{n}{pca}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{test\PYZus{}X}\PY{p}{)}
        \PY{n}{test\PYZus{}X\PYZus{}reduced} \PY{o}{=} \PY{n}{pca}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Reduced dataset shape:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{test\PYZus{}X\PYZus{}reduced}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        
        
        \PY{n}{dev\PYZus{}X} \PY{o}{=} \PY{n}{dev\PYZus{}X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{p}{]}
        
        \PY{n}{cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kn}{import} \PY{n+nn}{xgboost} \PY{k}{as} \PY{n+nn}{xgb}
        
        \PY{n}{dtrain} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{DMatrix}\PY{p}{(}\PY{n}{dev\PYZus{}X}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{dev\PYZus{}y}\PY{p}{)}
        \PY{n}{dtest} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{DMatrix}\PY{p}{(}\PY{n}{val\PYZus{}X}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}set parameters for xgboost}
        \PY{n}{params} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{7}\PY{p}{,}
                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{eta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,}
                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{silent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,}
                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{objective}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{eval\PYZus{}metric}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rmse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mf}{0.1}
                 \PY{p}{\PYZcb{}}
        \PY{n}{num\PYZus{}rounds} \PY{o}{=} \PY{l+m+mi}{100}
        
        \PY{n}{xb} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{train}\PY{p}{(}\PY{n}{params}\PY{p}{,} \PY{n}{dtrain}\PY{p}{,} \PY{n}{num\PYZus{}rounds}\PY{p}{)}
        
        \PY{n}{y\PYZus{}pred\PYZus{}xgb} \PY{o}{=} \PY{n}{xb}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{dtest}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{rmse} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{val\PYZus{}y}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}xgb}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RMSE: }\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{rmse}\PY{p}{)}\PY{p}{)}
        
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Mean squared error: }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{\PYZdq{}}
              \PY{o}{\PYZpc{}} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{val\PYZus{}y}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}xgb}\PY{p}{)}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} Explained variance score: 1 is perfect prediction}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Variance score: }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{val\PYZus{}y}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}xgb}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
        \PY{n}{y\PYZus{}pred\PYZus{}xgb}\PY{p}{[}\PY{n}{y\PYZus{}pred\PYZus{}xgb}\PY{o}{\PYZlt{}}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
        \PY{n}{val\PYZus{}pred\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{\PYZcb{}}\PY{p}{)}
        \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{val\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{totals\PYZus{}transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
        \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{expm1}\PY{p}{(}\PY{n}{y\PYZus{}pred\PYZus{}xgb}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}print(np.sqrt(metrics.mean\PYZus{}squared\PYZus{}error(np.log1p(val\PYZus{}pred\PYZus{}df[\PYZdq{}transactionRevenue\PYZdq{}].values), np.log1p(val\PYZus{}pred\PYZus{}df[\PYZdq{}PredictedRevenue\PYZdq{}].values))))}
        \PY{n}{val\PYZus{}pred\PYZus{}df} \PY{o}{=} \PY{n}{val\PYZus{}pred\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transactionRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{val\PYZus{}pred\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{dtest\PYZus{}actual} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{DMatrix}\PY{p}{(}\PY{n}{test\PYZus{}X}\PY{p}{)}
        \PY{n}{actual\PYZus{}testdata\PYZus{}pred\PYZus{}xgb\PYZus{}params} \PY{o}{=} \PY{n}{xb}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{dtest\PYZus{}actual}\PY{p}{)}
        
        \PY{n}{sub\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{test\PYZus{}id}\PY{p}{\PYZcb{}}\PY{p}{)}
        \PY{n}{actual\PYZus{}testdata\PYZus{}pred\PYZus{}xgb\PYZus{}params}\PY{p}{[}\PY{n}{actual\PYZus{}testdata\PYZus{}pred\PYZus{}xgb\PYZus{}params}\PY{o}{\PYZlt{}}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
        \PY{n}{sub\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedLogRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{expm1}\PY{p}{(}\PY{n}{actual\PYZus{}testdata\PYZus{}pred\PYZus{}xgb\PYZus{}params}\PY{p}{)}
        \PY{n}{sub\PYZus{}df} \PY{o}{=} \PY{n}{sub\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedLogRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
        \PY{n}{sub\PYZus{}df}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fullVisitorId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedLogRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
        \PY{n}{sub\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedLogRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log1p}\PY{p}{(}\PY{n}{sub\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PredictedLogRevenue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
        \PY{n}{sub\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{new\PYZus{}test1\PYZus{}xgb.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{dtest\PYZus{}actual} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{DMatrix}\PY{p}{(}\PY{n}{test\PYZus{}X}\PY{p}{)}
        \PY{n}{actual\PYZus{}testdata\PYZus{}pred\PYZus{}xgb\PYZus{}params} \PY{o}{=} \PY{n}{xb}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{dtest\PYZus{}actual}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}EXPORTING PREDICTIONS TO CSV}
        
        \PY{c+c1}{\PYZsh{} key = pd.DataFrame(test[test.columns[0:1]])}
        
        \PY{c+c1}{\PYZsh{} key[\PYZsq{}fare\PYZus{}amount\PYZsq{}] = actual\PYZus{}testdata\PYZus{}pred\PYZus{}xgb\PYZus{}params}
        \PY{c+c1}{\PYZsh{} key.to\PYZus{}csv(\PYZsq{}test\PYZus{}predictions\PYZus{}xgb\PYZus{}params.csv\PYZsq{})}
\end{Verbatim}



    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
